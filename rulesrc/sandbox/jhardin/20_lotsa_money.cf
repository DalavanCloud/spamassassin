
ifplugin Mail::SpamAssassin::Plugin::ReplaceTags
  replace_tag  CURRENCY   [\(\[]?(?:GBP|=[Aa][34]|\xa3|\xa4|EUR|[Ee]uros?|US[D\$]{1,2}|\$)[\]\)]?

  body     __LOTSA_MONEY_01   /<CURRENCY>\s?\d[\d.,\sO]{5,20}[\dO]/
  body     __LOTSA_MONEY_02   /\d[\d.,\sO]{5,20}[\dO]\s?<CURRENCY>/
  body     __LOTSA_MONEY_03   /<CURRENCY>\s?\d[\d.,\sO]{1,4}[\dO]\s?(?:[Mm]\b|[Mm][Ii][Ll][Ll]|[Hh][Uu][Nn][Dd][Rr][Ee][Dd]|[Tt][Hh][Oo][Uu][Ss][Aa][Nn][Dd])/
  body     __LOTSA_MONEY_04   /(?:mill(?:e|ion)|hundred[^\.]{1,20}thousand)[^\.]{1,50}(?:(?:U\.?S\.?\s)?dollars|U\.?K\.?\spounds|(?:U\.?K\.?\s)?pounds\ssterling|euros?|francs?)/i
  replace_rules   __LOTSA_MONEY_01 __LOTSA_MONEY_02 __LOTSA_MONEY_03

  meta     LOTS_OF_MONEY    (__LOTSA_MONEY_01 || __LOTSA_MONEY_02 || __LOTSA_MONEY_03 || __LOTSA_MONEY_04)
  describe LOTS_OF_MONEY    Huge... sums of money
  score    LOTS_OF_MONEY    0.01

  # now combine with other stuff in metas to weed out FPs
  meta     MONEY_FREEMAIL   LOTS_OF_MONEY && (FREEMAIL_FROM || FREEMAIL_REPLYTO)
  describe MONEY_FREEMAIL   Lots of money from someone using free email?

  meta     MONEY_FROM_MISSP LOTS_OF_MONEY && FROM_MISSPACED
  describe MONEY_FROM_MISSP Lots of money and misspaced From

  meta     MONEY_FORM       LOTS_OF_MONEY && (FILL_THIS_FORM_LONG || FILL_THIS_FORM_ML)
  describe MONEY_FORM       Lots of money if you fill out a form

  # The ADVANCE_FEE rules should probably be updated with LOTS_OF_MONEY
  meta     MONEY_FEE        LOTS_OF_MONEY && (ADVANCE_FEE_2 || ADVANCE_FEE_3 || ADVANCE_FEE_4)
  describe MONEY_FEE        Lots of money if you first pay a fee

  body     LOTTO_WINNINGS   /claim your (?:win+ings|money|prize)/i
  describe LOTTO_WINNINGS   Claim your winnings
  score    LOTTO_WINNINGS   0.25

  body     LOTTO_WIN_01     /\bwin+ing\s(?:prize|number|notification|draw|check|cheque|details|information)/i
  describe LOTTO_WIN_01     Winning *
  score    LOTTO_WIN_01     0.20

  body     LOTTO_AGENT      /\b(?:claim(?:s|ing)?|fiduciary)\s?(?:agent|manager|officer)/i
  describe LOTTO_AGENT      Claims Agent
  score    LOTTO_AGENT      0.50

  body     LOTTO_DEPT       /\b(?:claim(?:s|ing)?|fiduciary)\s?(?:department|unit|group)/i
  describe LOTTO_DEPT       Claims Department
  score    LOTTO_DEPT       0.20

  header   LOTTO_AGENT_FM   From =~ /(?:claim(?:s|ing)?|fiduciary|dispatch)[\s_]?(?:agent|manager|officer)/i
  describe LOTTO_AGENT_FM   Claims Agent
  score    LOTTO_AGENT_FM   0.50

  header   LOTTO_AGENT_RPLY Reply-To =~ /(?:claim(?:s|ing)?|fiduciary|dispatch)[\s_]?(?:agent|manager|officer)/i
  describe LOTTO_AGENT_RPLY Claims Agent
  score    LOTTO_AGENT_RPLY 0.50

  body     LOTTO_ADMITS     /\b(?:online|ballot|(?:inter)?national|internet)\slottery/i
  describe LOTTO_ADMITS     Admits to being a lottery
  score    LOTTO_ADMITS     0.20

  meta     MONEY_LOTTERY    LOTS_OF_MONEY && (LOTTO_WINNINGS || LOTTO_WIN_01 || LOTTO_AGENT || LOTTO_DEPT || LOTTO_AGENT_FM || LOTTO_AGENT_RPLY || LOTTO_ADMITS || DEAR_WINNER)
  describe MONEY_LOTTERY    Lots of money from a lottery

endif


