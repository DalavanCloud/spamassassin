## khop-sc-neighbors.cf	v 200912820
## Khopesh's syndication of SpamCop's top offenders and top offending networks.
## 
## Spamassassin rules written by Adam Katz <antispamATkhopiscom>
## http://khopesh.com/Anti-spam
## khopesh on irc://irc.freenode.net/#spamassassin
## 
## sa-update --channel khop-bl.sa.khopesh.com --gpgkey F4AD9292
## 
## These rules are Copyright 2001-2009 by Adam Katz <antispamATkhopiscom>
## Licensed under the Creative Commons Non-Commercial Share-alike License 2.0.
## The code that generated this output is GNU Affero General Public License v3.
## Source data (copyright Cisco subsidiary SpamCop.net) taken from links below.
## The author is receptive to relicensing requests for this and its generator.


# http://spamcop.net/w3m?action=map;net=0;sort=spamcnt
header   KHOP_SC_CIDR8  Received =~ /(?-xism:\b(?:1(?:22|87)|200|89)(?:\.[012]?[0-9]{1,2}){3}\b)/
describe KHOP_SC_CIDR8  Relay listed in SpamCop top 8 IP/8 CIDRs
score    KHOP_SC_CIDR8  0.2 0.1 0.3 0.2

header   KHOP_SC_TOP_CIDR8  Received =~ /(?-xism:\b(?:1(?:23|89|90)|201)(?:\.[012]?[0-9]{1,2}){3}\b)/
describe KHOP_SC_TOP_CIDR8  Relay listed in SpamCop top 4 IP/8 CIDRs
score    KHOP_SC_TOP_CIDR8  0.5 0.4 0.8 0.6
# http://ruleqa.spamassassin.org/week/KHOP_SC_TOP_CIDR8/detail
# 0.00000ms 22.7242%s 0.5009%h 0.978s/o 0.76rank 1.00score
#counts  KHOP_SC_TOP_CIDR8  229488s/280h of 1065604 corpus (1009702s/55902h) 05/25/09
#counts  KHOP_SC_TOP_CIDR8  457506s/457h of 2102483 corpus (2015322s/87161h) 05/25/09
#counts  KHOP_SC_TOP_CIDR8  22495s/2h of 101483 corpus (99912s/1571h bb-jm) 05/25/09
#counts  KHOP_SC_TOP_CIDR8  205146s/170h of 928863 corpus (899498s/29365h dos) 05/25/09
#counts  KHOP_SC_TOP_CIDR8  1807s/108h of 35258 corpus (10292s/24966h jm) 05/25/09
# notable overlap: 84% of hits also hit RCVD_IN_PBL (0.905)


# http://www.spamcop.net/w3m?action=map;net=bmaxcnt;mask=16777215;sort=spamcnt
header   KHOP_SC_CIDR16  Received =~ /(?-xism:\b(?:1(?:22\.168|90\.20|87\.4)|222\.253|92\.47)(?:\.[012]?[0-9]{1,2}){2}\b)/
describe KHOP_SC_CIDR16  Relay listed in SpamCop top 12 IP/16 CIDRs
score    KHOP_SC_CIDR16  0.6 0.5 0.9 0.75

header   KHOP_SC_TOP_CIDR16  Received =~ /(?-xism:\b(?:1(?:23\.2[367]|89\.111|13\.22)|222\.254)(?:\.[012]?[0-9]{1,2}){2}\b)/
describe KHOP_SC_TOP_CIDR16  Relay listed in SpamCop top 6 IP/16 CIDRs
score    KHOP_SC_TOP_CIDR16  0.9 0.8 1.3 1.2
# http://ruleqa.spamassassin.org/week/KHOP_SC_TOP_CIDR16/detail
# 0.00000ms 0.6947%s 0.0000%h 1.000s/o 0.85rank 1.0score
#counts  KHOP_SC_TOP_CIDR16  7015s/0h of 1065604 corpus (1009702s/55902h) 05/25/09
#counts  KHOP_SC_TOP_CIDR16  14059s/0h of 2102483 corpus (2015322s/87161h) 05/25/09
#counts  KHOP_SC_TOP_CIDR16  845s/0h of 101483 corpus (99912s/1571h bb-jm) 05/25/09
#counts  KHOP_SC_TOP_CIDR16  6137s/0h of 928863 corpus (899498s/29365h dos) 05/25/09
#counts  KHOP_SC_TOP_CIDR16  33s/0h of 35258 corpus (10292s/24966h jm) 05/25/09
# notable overlap: 91% of hits also hit RCVD_IN_PBL (0.905)
# notable overlap: 85% of hits also hit RAZOR2_CHECK (0.5)
# notable overlap: 84% of hits also hit RAZOR2_CF_RANGE_51_100 (0.5)


# http://spamcop.net/w3m?action=map;net=cmaxcnt;mask=65535;sort=spamcnt
header   KHOP_SC_CIDR24  Received =~ /(?-xism:\b(?:(?:2(?:20\.231\.12|02\.75\.3)|98\.126\.17)7|121\.(?:54\.32|1\.37)|58\.18\.168)\.[012]?[0-9]{1,2}\b)/
describe KHOP_SC_CIDR24  Relay listed in SpamCop top 12 IP/24 CIDRs
score    KHOP_SC_CIDR24  0.9 0.8 1.3 1.2
# http://ruleqa.spamassassin.org/week/KHOP_SC_CIDR24/detail
# 0.00000ms 0.0239%s 0.0000%h 1.000s/o 0.57rank 1.00score
#counts  KHOP_SC_CIDR24  241s/0h of 1065604 corpus (1009702s/55902h) 05/25/09
#counts  KHOP_SC_CIDR24  486s/0h of 2102483 corpus (2015322s/87161h) 05/25/09
#counts  KHOP_SC_CIDR24  1s/0h of 101483 corpus (99912s/1571h bb-jm) 05/25/09
#counts  KHOP_SC_CIDR24  240s/0h of 928863 corpus (899498s/29365h dos) 05/25/09
#counts  KHOP_SC_CIDR24  0s/0h of 35258 corpus (10292s/24966h jm) 05/25/09

header   KHOP_SC_TOP_CIDR24  Received =~ /(?-xism:\b(?:(?:111\.224\.25|0\.0\.)0|203\.82\.9[12]|68\.168\.138|72\.21\.6)\.[012]?[0-9]{1,2}\b)/
describe KHOP_SC_TOP_CIDR24  Relay listed in SpamCop top 6 IP/24 CIDRs
score    KHOP_SC_TOP_CIDR24  1.7 1.5 1.9 1.8


# http://www.spamcop.net/w3m?action=hoshame
header   KHOP_SC_TOP200  Received =~ /(?-xism:\b(?:2(?:0(?:0\.(?:2(?:1\.18\.189|6\.148\.62|7\.138\.74)|141\.87\.135|58\.242\.202|80\.140\.61|95\.162\.53|6\.193\.89)|1\.(?:1(?:(?:16\.198\.1|34\.153\.2)14|61\.22\.77)|2(?:51\.250\.3|7\.7\.28)|45\.106\.130)|8\.(?:8(?:9\.219\.1(?:34|53)|4\.169\.157)|105\.118\.64)|2\.(?:75\.37\.(?:2(?:27|43)|125)|181\.234\.218)|9\.(?:77\.205\.171|94\.196\.170)|3\.82\.91\.10[14]|6\.169\.30\.117)|1(?:1\.(?:1(?:9(?:1\.174\.141|8\.225\.206)|7(?:1\.255\.237|5\.239\.2)|19\.98\.147)|2(?:39\.16(?:2\.41|3\.13)|02\.2\.97))|0\.(?:21(?:2\.248\.22|9\.173\.6)2|99\.183\.253|110\.49\.39)|3\.(?:1(?:86\.57\.129|40\.0\.221)|227\.219\.58)|2\.1(?:50\.22\.143|74\.187\.47)|7\.1(?:99\.231\.249|6\.69\.8)|8\.248\.44\.196|9\.254\.35\.45)|2(?:0\.(?:2(?:2(?:7\.(?:170\.197|35\.234)|5\.91\.194)|31\.127\.(?:13|9)|41\.246\.97)|95\.232\.26)|1\.(?:1(?:3(?:5\.132\.14|9\.0\.97)|43\.48\.107)|214\.164\.240)|2\.(?:2(?:37\.78\.177|52\.223\.2)|184\.100\.19))|4\.1(?:(?:56\.108\.18|43\.68\.2)8|99\.205\.252))|1(?:1(?:6\.(?:(?:193\.163\.13|34\.107\.16)8|(?:74\.69\.21|50\.249\.)2)|3\.(?:16(?:1\.(?:17\.21|74\.15)0|0\.112\.8)|255\.7\.234)|1\.224\.250\.(?:13[1234]|6[56]|70)|9\.(?:63\.132\.180|93\.11\.126)|7\.(?:25\.129\.200|74\.62\.49)|4\.(?:45\.57\.160|141\.5\.3)|0\.45\.146\.169|8\.175\.6\.138)|2(?:4\.(?:1(?:0(?:7\.59\.186|5\.51\.74)|24\.52\.162)|217\.19(?:8\.233|9\.142)|0\.18\.130)|1\.1(?:\.37\.14[567]|43\.193\.179|0\.127\.158)|2\.(?:252\.23(?:1\.1|4\.7)4|52\.99\.181)|5\.(?:46\.73\.179|20\.67\.66)|\.172\.13\.157)|9(?:5\.(?:1(?:(?:58\.5\.12|61\.9\.)2|89\.45\.11)|225\.46\.236)|0\.(?:24\.150\.185|41\.219\.177|6\.172\.98|81\.54\.33)|3\.108\.38\.2(?:2[89]|31)|4\.44\.128\.244)|(?:38\.210\.136\.19|63\.180\.38\.22)9|8(?:6\.24\.(?:1[89]|23)|8\.50\.76)\.3|4(?:8\.243\.142\.2|0\.111\.153\.)4|73\.29\.104\.166|52\.26\.20\.72)|9(?:1\.1(?:21\.(?:1(?:4(?:0\.101|\.198)|05\.(?:187|224)|36\.218)|23\.205|83\.216)|93\.199\.4)|4\.(?:2(?:3\.(?:12\.122|25\.113)|53\.6\.137)|77\.48\.5)|8\.(?:1(?:16\.37\.60|26\.177\.8)|247\.166\.120)|(?:5\.154\.240|2\.63\.15)\.98|6\.242\.132\.190|9\.170\.209\.126|3\.122\.135\.4)|6(?:6\.(?:153\.50\.162|235\.160\.11|46\.179\.10|98\.69\.145)|1\.1(?:00\.1(?:2\.193|4\.234)|58\.163\.112|2\.31\.51)|5\.(?:(?:167\.95\.18|48\.9\.24)2|32\.195\.145)|7\.2(?:25\.17(?:7\.110|9\.86)|41\.7\.159)|8\.(?:168\.138\.5[13489]|62\.107\.104)|9\.251\.193\.218|0\.213\.48\.250)|8(?:0\.(?:2(?:35\.105\.140|5\.174\.116)|179\.155\.30|93\.125\.186)|9\.(?:1(?:65\.244\.2|89\.170\.)21|25\.159\.238)|3\.1(?:42\.111\.228|6\.167\.14)|4\.(?:22\.140\.186|17\.11\.114)|1\.112\.190\.195|7\.117\.253\.240|8\.171\.112\.196)|7(?:2\.(?:52\.(?:134\.118|239\.50)|21\.6\.22)|(?:1\.188\.158\.16|5\.64\.138\.5)7|4\.(?:208\.167\.189|7\.71\.220)|7\.(?:48\.106\.146|70\.54\.81)|6\.179\.99\.39)|5(?:8\.(?:1(?:8\.168\.16[236]|20\.227\.149)|2(?:48\.4\.67|6\.2\.212))|9\.160\.177\.27))\b)/
describe KHOP_SC_TOP200  Relay listed in SpamCop top 200 spammer IPs
score    KHOP_SC_TOP200  3.4 3.2 3.7 3.5
# http://ruleqa.spamassassin.org/week/KHOP_SC_TOP200/detail
# 0.00000ms 0.1230%s 0.0000%h 1.000s/o 0.69rank 1.00score
#counts  KHOP_SC_TOP200  1250s/0h of 1072123 corpus (1015898s/56225h) 05/25/09
#counts  KHOP_SC_TOP200  4s/0h of 101470 corpus (99923s/1547h bb-jm) 05/25/09
#counts  KHOP_SC_TOP200  1245s/0h of 935409 corpus (905697s/29712h dos) 05/25/09
#counts  KHOP_SC_TOP200  1s/0h of 35244 corpus (10278s/24966h jm) 05/25/09
# assumed overlap: 98+% of hits also hit RCVD_IN_BL_SPAMCOP_NET (1.960)

#header   KHOP_SC_TOP100  Received =~ /(?-xism:\b(?:2(?:1(?:1\.(?:1(?:9(?:1\.174\.141|8\.225\.206)|75\.239\.2)|202\.2\.97)|3\.1(?:86\.57\.129|40\.0\.221)|0\.219\.173\.62|2\.150\.22\.143|8\.248\.44\.196|7\.16\.69\.8)|0(?:0\.(?:2(?:1\.18\.189|7\.138\.74)|141\.87\.135|80\.140\.61|6\.193\.89)|2\.(?:181\.234\.218|75\.37\.125)|1\.116\.198\.114|8\.89\.219\.153)|2(?:1\.1(?:3(?:5\.132\.14|9\.0\.97)|43\.48\.107)|0\.(?:241\.246\.97|95\.232\.26)|2\.2(?:37\.78\.177|52\.223\.2))|4\.199\.205\.252)|1(?:1(?:(?:6\.193\.163|8\.175\.6)\.138|4\.(?:45\.57\.160|141\.5\.3)|1\.224\.250\.(?:13[12]|66)|0\.45\.146\.169)|2(?:1\.1(?:\.37\.14[567]|0\.127\.158)|4\.217\.19(?:8\.233|9\.142)|2\.52\.99\.181|5\.46\.73\.179)|9(?:0\.(?:24\.150\.185|81\.54\.33)|5\.1(?:89\.45\.11|61\.9\.2)|3\.108\.38\.228|4\.44\.128\.244))|9(?:1\.121\.(?:1(?:(?:36\.21|4\.19)8|05\.(?:187|224))|23\.205)|6\.242\.132\.190|5\.154\.240\.98|3\.122\.135\.4|4\.23\.12\.122)|6(?:6\.(?:235\.160\.11|46\.179\.10)|1\.100\.1(?:2\.193|4\.234)|7\.225\.17(?:7\.110|9\.86)|8\.168\.138\.5[89])|8(?:0\.(?:2(?:35\.105\.140|5\.174\.116)|179\.155\.30|93\.125\.186)|4\.17\.11\.114)|5(?:8\.(?:1(?:8\.168\.16[26]|20\.227\.149)|248\.4\.67)|9\.160\.177\.27)|7(?:(?:1\.188\.158\.16|5\.64\.138\.5)7|4\.208\.167\.189|7\.70\.54\.81))\b)/
#describe KHOP_SC_TOP100  Relay listed in SpamCop top 100 spammer IPs
#score    KHOP_SC_TOP100  1.4 1.3 1.8 1.7
# http://ruleqa.spamassassin.org/week/KHOP_SC_TOP100/detail
# 0.00000ms 0.2880%s 0.0000%h 1.000s/o 0.76rank 1.00score
#counts  KHOP_SC_TOP100  2908s/0h of 1065604 corpus (1009702s/55902h) 05/25/09
#counts  KHOP_SC_TOP100  5897s/0h of 2102483 corpus (2015322s/87161h) 05/25/09
#counts  KHOP_SC_TOP100  6s/0h of 101483 corpus (99912s/1571h bb-jm) 05/25/09
#counts  KHOP_SC_TOP100  2901s/0h of 928863 corpus (899498s/29365h dos) 05/25/09
#counts  KHOP_SC_TOP100  1s/0h of 35258 corpus (10292s/24966h jm) 05/25/09
# notable overlap: 99% of hits also hit RCVD_IN_BL_SPAMCOP_NET (1.960) (duh)
# notable overlap: 98% of hits also hit RCVD_IN_XBL (3.033)
# notable overlap: 80% of hits also hit RCVD_IN_SORBS_WEB (0.619)

#header   KHOP_SC_TOP20  Received =~ /(?-xism:\b(?:2(?:0(?:9\.94\.196\.170|1\.161\.22\.77|3\.82\.91\.101)|13\.227\.219\.58)|1(?:1(?:1\.224\.250\.133|7\.25\.129\.200)|38\.210\.136\.199)|6(?:1\.158\.163\.112|8\.168\.138\.53)|72\.52\.239\.50)\b)/
#describe KHOP_SC_TOP20  Relay listed in SpamCop top 20 spammer IPs
#score    KHOP_SC_TOP20  1.9 1.7 2.2 2.0
# assumed overlap: 99+% of hits also hit RCVD_IN_BL_SPAMCOP_NET (1.960)

#header   KHOP_SC_TOP10  Received =~ /(?-xism:\b(?:6(?:8\.168\.138\.5[14]|0\.213\.48\.250)|2(?:03\.82\.91\.104|19\.254\.35\.45)|111\.224\.250\.(?:65|70)|84\.22\.140\.186|98\.126\.177\.8|72\.21\.6\.22)\b)/
#describe KHOP_SC_TOP10  Relay listed in SpamCop top 10 spammer IPs
#score    KHOP_SC_TOP10  2.2 2.0 2.6 2.4
# assumed overlap: 99+% of hits also hit RCVD_IN_BL_SPAMCOP_NET (1.960)


# Bump these up to compensate for expected but absent overlap
if (! plugin(Mail::SpamAssassin::Plugin::DNSEval) )
  score  KHOP_SC_CIDR8		(0.1)
  score  KHOP_SC_TOP_CIDR8	(0.2)	# RCVD_IN_PBL
  score  KHOP_SC_CIDR16 	(0.8)	# RCVD_IN_PBL
  score  KHOP_SC_TOP_CIDR16	(0.9)	# RCVD_IN_PBL
  score  KHOP_SC_CIDR24 	(0.9)	# RCVD_IN_PBL
  score  KHOP_SC_TOP_CIDR24	(1.5)	# RCVD_IN_PBL ++
  score  KHOP_SC_TOP200 	 4.6	# RCVD_IN_BL_SPAMCOP_NET + RCVD_IN_XBL++
  #score KHOP_SC_TOP100 	 4.7 	# RCVD_IN_BL_SPAMCOP_NET ++
  #score KHOP_SC_TOP20  	 4.8 	# RCVD_IN_BL_SPAMCOP_NET + RCVD_IN_XBL++
  #score KHOP_SC_TOP10  	 4.9 	# RCVD_IN_BL_SPAMCOP_NET + RCVD_IN_XBL++
endif

