
##
## Please add loadplugin to init.pre (so it's loadeded before cf files!):

loadplugin Mail::SpamAssassin::Plugin::FreeMail FreeMail.pm

ifplugin Mail::SpamAssassin::Plugin::FreeMail

body     __freemail_safe_fwd  /---\s?(?:(?:Forwarded|Original) message|Alkuper.inen viesti)/i
header   __freemail_safe_ml1  exists:List-Id
header   __freemail_safe_ml2  exists:Mailing-List
header   __freemail_safe_ml3  exists:X-Mailing-List
header   __freemail_safe_rls  X-Spam-Relays-External =~ /^[^\]]+ rdns=\S+\.(?:tfbnw\.net|ebay\.com|tieto\.com) /
meta     __freemail_safe      __freemail_safe_fwd || __freemail_safe_ml1 || __freemail_safe_ml2 || __freemail_safe_ml3 || __freemail_safe_rls

header   __freemail_replyto  eval:check_freemail_replyto('replyto')
meta     FREEMAIL_REPLYTO  __freemail_replyto && !__freemail_safe
describe FREEMAIL_REPLYTO  Reply-To/From or Reply-To/body contain different freemails

header   __freemail_reply  eval:check_freemail_replyto('reply')
meta     FREEMAIL_REPLY  __freemail_reply && !__freemail_replyto && !__freemail_safe
describe FREEMAIL_REPLY  From and body contain different freemails

header   FREEMAIL_FROM  eval:check_freemail_from()
describe FREEMAIL_FROM  Sender email is freemail

header   FREEMAIL_FROM_END_DIGIT  eval:check_freemail_from('\d@')
describe FREEMAIL_FROM_END_DIGIT  Freemail username ends in digit

header   FREEMAIL_SUBJECT  eval:check_freemail_header('Subject')
describe FREEMAIL_SUBJECT  Subject contains freemail

# Idea from John Hardin
header   __freemail_hdr_replyto  eval:check_freemail_header('Reply-To')
meta     FREEMAIL_FORGED_REPLYTO  __freemail_hdr_replyto && !FREEMAIL_FROM && !__freemail_safe
describe FREEMAIL_FORGED_REPLYTO  Freemail in Reply-To, but not From

endif

