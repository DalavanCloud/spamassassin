#!/usr/bin/perl

my $lastbucket = 0;
my $nextbucket = 0;
my $PERIOD = (24 * 60 * 60 * 7);

while (<>) {
  my $found = 0;
  /SARE_SUBJ/ and $found = 1;
  s/^.*\btime=//; s/,.*$//;
  
  my $t = $_;
  if ($lastbucket == 0) {
    $lastbucket = $t;
    $nextbucket = $t + $PERIOD;    # plus 2 hrs
  }
  if ($t < $nextbucket) {
    if ($found) {
      $seen_y++;
    } else {
      $seen_n++;
    }
  }
  else {
    while ($t >= $nextbucket) {
      completeline();
      $lastbucket = $nextbucket;
      $nextbucket += $PERIOD;
    }
  }
}

sub completeline {
  print "$lastbucket $seen_y $seen_n\n";
  $seen_y = 0;
  $seen_n = 0;
}

print STDERR '

plot "times" using 0:1, "times" using 0:2

';
