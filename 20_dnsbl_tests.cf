# SpamAssassin rules file: DNS blacklist tests
#
# Please don't modify this file as your changes will be overwritten with
# the next update. Use @@LOCAL_RULES_DIR@@/local.cf instead.
# See 'perldoc Mail::SpamAssassin::Conf' for details.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of either the Artistic License or the GNU General
# Public License as published by the Free Software Foundation; either
# version 1 of the License, or (at your option) any later version.
#
# See the file "License" in the top level of the SpamAssassin source
# distribution for more details.
#
###########################################################################

require_version @@VERSION@@

# See the Mail::SpamAssassin::Conf manual page for details of how to use
# check_rbl().

# ---------------------------------------------------------------------------
# Multizone / Multi meaning BLs first.
# 
# Note that currently TXT queries cannot be used for these, since the
# DNSBLs do not return the A type (127.0.0.x) as part of the TXT reply.
# Well, at least Osirusoft and NJABL don't, it seems, as of Apr 7 2003.

# Osirusoft, like MAPS RBL+ is a multi-meaning BL, so it is treated separately
header RCVD_IN_OSIRU	rbleval:check_rbl('osirusoft', 'relays.osirusoft.com.')
describe RCVD_IN_OSIRU	Received via a relay in relays.osirusoft.com
tflags RCVD_IN_OSIRU    net

# the X prefixes were originally needed to ensure that these rules were
# run last, but ordering is not necessary now.
header RCVD_IN_OSIRU_OR	rbleval:check_rbl_sub('osirusoft', '127.0.0.2')
describe RCVD_IN_OSIRU_OR	DNSBL: sender is Confirmed Open Relay
tflags RCVD_IN_OSIRU_OR	net

header RCVD_IN_OSIRU_DUL		rbleval:check_rbl('osirusoft-notfirsthop', 'relays.osirusoft.com.', '127.0.0.3')
describe RCVD_IN_OSIRU_DUL		DNSBL: sender ip address in in a dialup block
tflags RCVD_IN_OSIRU_DUL		net

header RCVD_IN_OSIRU_SPAM_SRC		rbleval:check_rbl_sub('osirusoft', '127.0.0.4')
describe RCVD_IN_OSIRU_SPAM_SRC	DNSBL: sender is Confirmed Spam Source
tflags RCVD_IN_OSIRU_SPAM_SRC         net

header RCVD_IN_OSIRU_SPAMWARE	rbleval:check_rbl_sub('osirusoft', '127.0.0.6')
describe RCVD_IN_OSIRU_SPAMWARE	DNSBL: sender is a Spamware site or vendor
tflags RCVD_IN_OSIRU_SPAMWARE    net

# ---------------------------------------------------------------------------

header RCVD_IN_NJABL		rbleval:check_rbl('njabl', 'dnsbl.njabl.org.')
describe RCVD_IN_NJABL		Received via a relay in dnsbl.njabl.org
tflags RCVD_IN_NJABL		net

header RCVD_IN_NJABL_RELAY	rbleval:check_rbl_sub('njabl', '127.0.0.2')
describe RCVD_IN_NJABL_RELAY	NJABL: sender is confirmed open relay
tflags RCVD_IN_NJABL_RELAY	net

header RCVD_IN_NJABL_DIALUP	rbleval:check_rbl('njabl-notfirsthop', 'dnsbl.njabl.org.', '127.0.0.3')
describe RCVD_IN_NJABL_DIALUP	NJABL: sender is dialup that did non-local SMTP
tflags RCVD_IN_NJABL_DIALUP	net

header RCVD_IN_NJABL_SPAM	rbleval:check_rbl_sub('njabl', '127.0.0.4')
describe RCVD_IN_NJABL_SPAM	NJABL: sender is confirmed spam source
tflags RCVD_IN_NJABL_SPAM	net

header RCVD_IN_NJABL_MULTI	rbleval:check_rbl_sub('njabl', '127.0.0.5')
describe RCVD_IN_NJABL_MULTI	NJABL: sent through multi-stage open relay
tflags RCVD_IN_NJABL_MULTI	net 

header RCVD_IN_NJABL_CGI	rbleval:check_rbl_sub('njabl', '127.0.0.8')
describe RCVD_IN_NJABL_CGI	NJABL: sender is an open formmail
tflags RCVD_IN_NJABL_CGI	net

header RCVD_IN_NJABL_PROXY	rbleval:check_rbl_sub('njabl', '127.0.0.9')
describe RCVD_IN_NJABL_PROXY	NJABL: sender is an open proxy
tflags RCVD_IN_NJABL_PROXY	net

# ---------------------------------------------------------------------------

# SORBS
# transfers: both axfr and ixfr available
# url: http://www.dnsbl.sorbs.net/
# pay-to-use: no
# delist: $50 fee for RCVD_IN_SORBS_SPAM, others have free retest on request
header RCVD_IN_SORBS		rbleval:check_rbl('sorbs', 'dnsbl.sorbs.net.')
describe RCVD_IN_SORBS		SORBS: sender is listed in SORBS
tflags RCVD_IN_SORBS		net

header RCVD_IN_SORBS_HTTP	rbleval:check_rbl_sub('sorbs', '127.0.0.2')
describe RCVD_IN_SORBS_HTTP	SORBS: sender is open HTTP proxy server
tflags RCVD_IN_SORBS_HTTP	net

header RCVD_IN_SORBS_MISC	rbleval:check_rbl_sub('sorbs', '127.0.0.3')
describe RCVD_IN_SORBS_MISC	SORBS: sender is open proxy server
tflags RCVD_IN_SORBS_MISC	net

header RCVD_IN_SORBS_SMTP	rbleval:check_rbl_sub('sorbs', '127.0.0.4')
describe RCVD_IN_SORBS_SMTP	SORBS: sender is open SMTP relay
tflags RCVD_IN_SORBS_SMTP	net

header RCVD_IN_SORBS_SOCKS	rbleval:check_rbl_sub('sorbs', '127.0.0.5')
describe RCVD_IN_SORBS_SOCKS	SORBS: sender is open SOCKS proxy server
tflags RCVD_IN_SORBS_SOCKS	net

header RCVD_IN_SORBS_SPAM	rbleval:check_rbl_sub('sorbs', '127.0.0.6')
describe RCVD_IN_SORBS_SPAM	SORBS: sender is a spam source
tflags RCVD_IN_SORBS_SPAM	net

header RCVD_IN_SORBS_WEB	rbleval:check_rbl_sub('sorbs', '127.0.0.7')
describe RCVD_IN_SORBS_WEB	SORBS: sender is a abuseable web server
tflags RCVD_IN_SORBS_WEB	net

header RCVD_IN_SORBS_BLOCK	rbleval:check_rbl_sub('sorbs', '127.0.0.8')
describe RCVD_IN_SORBS_BLOCK	SORBS: sender demands to never be tested
tflags RCVD_IN_SORBS_BLOCK	net

header RCVD_IN_SORBS_ZOMBIE	rbleval:check_rbl_sub('sorbs', '127.0.0.9')
describe RCVD_IN_SORBS_ZOMBIE	SORBS: sender is on a hijacked network
tflags RCVD_IN_SORBS_ZOMBIE	net

# ---------------------------------------------------------------------------
# Now, single zone BLs follow:

# SBL is the Spamhaus Block List: http://www.spamhaus.org/sbl/
header RCVD_IN_SBL		rbleval:check_rbl_txt('sbl', 'sbl.spamhaus.org.')
describe RCVD_IN_SBL		Received via a relay in Spamhaus Block List
tflags RCVD_IN_SBL              net

# http://www.blitzed.org/opm/ - a recommended open-proxies list
# OPM supports TXT queries, but A queries are needed for sub-tests
header RCVD_IN_OPM		rbleval:check_rbl('opm', 'opm.blitzed.org.')
describe RCVD_IN_OPM		Received via a relay in opm.blitzed.org
tflags RCVD_IN_OPM              net

# DSBL catches open relays, badly-installed CGI scripts and open SOCKS and
# HTTP proxies.  list.dsbl.org lists servers tested by "trusted" users,
# multihop.dsbl.org lists servers which open SMTP servers relay through,
# unconfirmed.dsbl.org lists servers tested by "untrusted" users.
# See http://dsbl.org/ for full details.
# transfers: yes - rsync and http, see http://dsbl.org/usage
# pay-to-use: no
# delist: automated/distributed
header RCVD_IN_DSBL            rbleval:check_rbl_txt('dsbl', 'list.dsbl.org.')
describe RCVD_IN_DSBL          Received via a relay in list.dsbl.org
tflags RCVD_IN_DSBL            net

# Other miscellaneous RBLs are listed here:
header RCVD_IN_RFCI		rbleval:check_rbl_txt('rfci', 'ipwhois.rfc-ignorant.org.')
describe RCVD_IN_RFCI		Received via a relay in ipwhois.rfc-ignorant.org
tflags RCVD_IN_RFCI             net

header HABEAS_VIOLATOR		rbleval:check_rbl_swe('hil', 'hil.habeas.com.')
describe HABEAS_VIOLATOR	Has Habeas warrant mark and on Infringer List
tflags HABEAS_VIOLATOR		net

# bondedsender.org provides an RBL-style whitelist for trusted relays
header RCVD_IN_BONDEDSENDER	rbleval:check_rbl('bondedsender', 'query.bondedsender.org.')
describe RCVD_IN_BONDEDSENDER	See http://www.bondedsender.org/referred.html
tflags RCVD_IN_BONDEDSENDER	net nice

# ---------------------------------------------------------------------------

# NOTE: semi-commercial test, see README file for details
header RCVD_IN_BL_SPAMCOP_NET	rbleval:check_rbl_txt('spamcop', 'bl.spamcop.net.')
describe RCVD_IN_BL_SPAMCOP_NET	Received via a relay in bl.spamcop.net
tflags RCVD_IN_BL_SPAMCOP_NET   net

# ---------------------------------------------------------------------------

# NOTE: commercial tests, see README file for details
header RCVD_IN_MAPS_RBL		rbleval:check_rbl('rbl', 'blackholes.mail-abuse.org.')
describe RCVD_IN_MAPS_RBL	Relay in RBL, see http://www.mail-abuse.org/rbl/
tflags RCVD_IN_MAPS_RBL		net

header RCVD_IN_MAPS_RSS		rbleval:check_rbl('rss', 'relays.mail-abuse.org.')
describe RCVD_IN_MAPS_RSS	Relay in RSS, see http://www.mail-abuse.org/rss/
tflags RCVD_IN_MAPS_RSS		net

header RCVD_IN_MAPS_DUL		rbleval:check_rbl('dialup-notfirsthop', 'dialups.mail-abuse.org.')
describe RCVD_IN_MAPS_DUL	Relay in DUL, see http://www.mail-abuse.org/dul/
tflags RCVD_IN_MAPS_DUL		net

header RCVD_IN_MAPS_NML		rbleval:check_rbl('nml', 'nonconfirm.mail-abuse.org.')
describe RCVD_IN_MAPS_NML	Relay in NML, see http://www.mail-abuse.org/nml/
tflags RCVD_IN_MAPS_NML		net

