# SpamAssassin rules file: rules under test, $Rev$
#
# This file is a placeholder for rules "under probation", i.e. checked into
# SVN for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# <@LICENSE>
# Copyright 2004 Apache Software Foundation
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
########################################################################

body T_HTML_IFRAME_SRC	eval:check_iframe_src()
describe T_HTML_IFRAME_SRC	Message has HTML IFRAME tag with SRC URI

# These phrases seem to occur a lot in phishing...
body T_PH_SEC		/\byour .{0,40}account .{0,40}security/i
describe T_PH_SEC	Message has a phrase standard for phishing mails
body T_PH_REC		/\byour .{0,40}account .{0,40}record/i
describe T_PH_REC	Message has a phrase standard for phishing mails

# tvd- works well for me in testing, let's see how well it works for others
#  0.331   0.3763   0.0000    1.000   0.50    0.01  T_EB_PHISH
#  0.292   0.3326   0.0000    1.000   0.25    0.01  T_PP_PHISH
header __FROM_PAYPAL	From:addr =~ /\@paypal\.com$/i
header __FROM_EBAY	From:addr =~ /\@ebay\.com$/i
# score was set to 0 for 3.1, so upping a little for meta...
score NORMAL_HTTP_TO_IP 0.001 0.001 0.160 0.175
meta T_PP_PHISH	__FROM_PAYPAL && NORMAL_HTTP_TO_IP
meta T_EB_PHISH	__FROM_EBAY && NORMAL_HTTP_TO_IP

header T_FROM_FORMAT eval:check_from_format()

urirhsbl  T_URIBL_SC2_SURBL  sc2.surbl.org.   A  
body      T_URIBL_SC2_SURBL  eval:check_uridnsbl('T_URIBL_SC2_SURBL')  
describe  T_URIBL_SC2_SURBL  Has URI in SC2 at http://www.surbl.org/lists.html  
tflags    T_URIBL_SC2_SURBL  net  

urirhsbl  T_URIBL_XS_SURBL   xs.surbl.org.    A  
body      T_URIBL_XS_SURBL   eval:check_uridnsbl('T_URIBL_XS_SURBL')  
describe  T_URIBL_XS_SURBL   Has URI in XS - Testing  
tflags    T_URIBL_XS_SURBL   net  

# From discussion on users@ list
body T_URI_HTML_ONLY		eval:check_html_uri_only()
describe T_URI_HTML_ONLY	URIs only found in HTML part of multipart/alternative message

# tvd:
#  1.575   1.8696   0.0000    1.000   1.00    0.01  T_SUBJ_ACC_NUM3
#  1.532   1.8192   0.0000    1.000   0.67    0.01  T_SUBJ_ACC_NUM
#  1.532   1.8192   0.0000    1.000   0.67    0.01  T_SUBJ_ACC_NUM2
header	T_SUBJ_ACC_NUM		Subject =~ /\b(?i:invoice|account).{1,4}\d+[A-Z]+/
header	T_SUBJ_ACC_NUM2		Subject =~ /\b(?i:invoice|account).{1,4}\d+[A-Z]+\s*$/
header	T_SUBJ_ACC_NUM3		Subject =~ /\b[a-zA-Z]+ \W{1,4}\d+[A-Z]+\s*$/
describe T_SUBJ_ACC_NUM		Subject has spammy looking monetary reference
describe T_SUBJ_ACC_NUM2	Subject has spammy looking monetary reference
describe T_SUBJ_ACC_NUM3	Subject has spammy looking monetary reference

ifplugin Mail::SpamAssassin::Plugin::ReplaceTags
body T_FUZZY_REPLICA	/<inter W1><post P2>(?!replica)<R><E><P><L><I><C><A>/i
replace_rules T_FUZZY_REPLICA

body T_FUZZY_SPRM	/<inter W1><post P2><S><P><U><R><M>/i
replace_rules T_FUZZY_SPRM
endif

body T_BODY_RX /\brx\W{0,2}(?:drug|med)/i
body T_DEAR_WINNER /\bdear.{1,20}winner/i

meta T_SUBJECT_NEEDS_ENCODING    (!__SUBJECT_ENCODED_B64 && !__SUBJECT_ENCODED_QP) && __SUBJECT_NEEDS_MIME

body T_SPACED_PHONE /(?:\d\s){2}\d\s?[.-]\s?(?:\d\s){2}\d\s?[.-]\s?(?:\d\s){3}\d/

header __SUBJ_RE_NUM	Subject =~ /^\s*Re\[\d+\]:/i
meta T_SUBJ_RE_NUM	!__THEBAT_MUA && __SUBJ_RE_NUM
describe T_SUBJ_RE_NUM	Subject is faking 'The Bat!' responses

# tvd
# 1.345   1.5187   0.0000    1.000   1.00    0.01  T_SUBJ_LEN_SHORT
# 0.224   0.2525   0.0000    1.000   0.50    0.01  T_SUBJ_LEN_LONG
header T_SUBJ_LEN_SHORT eval:subject_length('0','4')
header T_SUBJ_LEN_LONG eval:subject_length('149','999')
