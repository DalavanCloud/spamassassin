# SpamAssassin rules file: rules under test, $Rev$
#
# This file is a placeholder for rules "under probation", i.e. checked into
# SVN for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# <@LICENSE>
# Copyright 2004 Apache Software Foundation
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
########################################################################

# I'm curious, may help explain more ALL_TRUSTED fps
# TVD: fyi, most (all?) of my hits for this are from mailing lists which tack
# on a report attachment which then get sent out.  ewww.
body T_SA_MARKED_UP     /Spam detection software, running on the system /

########################################################################

# Should choose either IADB or IADB2 and go with it.  I'm in favor of IADB and
# ranking the individual pieces separately.  IADB2 basically aggregates the
# results into a simple score, which is fine but I think we'd get better data
# out of the individual pieces.
# 2004/12/07, TVD

# IADB support ...
header __RCVD_IN_IADB		eval:check_rbl('iadb-firsttrusted', 'iadb.isipp.com.')
tflags __RCVD_IN_IADB		net nice

header T_RCVD_IN_IADB		eval:check_rbl_sub('iadb-firsttrusted', '^127.0.0.[12]$')
describe T_RCVD_IN_IADB		Sender is listed in ISIPP IADB
tflags T_RCVD_IN_IADB		net nice

header T_RCVD_IN_IADB_VOUCHED	eval:check_rbl_sub('iadb-firsttrusted', '^127.0.1.255$')
describe T_RCVD_IN_IADB_VOUCHED	ISIPP IADB lists as vouched-for sender
tflags T_RCVD_IN_IADB_VOUCHED	net nice

header T_RCVD_IN_IADB_EDDB	eval:check_rbl_sub('iadb-firsttrusted', '^127.0.2.1$')
describe T_RCVD_IN_IADB_EDDB	ISIPP IADB lists sender as EDDB participant
tflags T_RCVD_IN_IADB_EDDB	net nice

header T_RCVD_IN_IADB_EPIA	eval:check_rbl_sub('iadb-firsttrusted', '^127.0.2.2$')
describe T_RCVD_IN_IADB_EPIA	ISIPP IADB lists sender as EPIA participant
tflags T_RCVD_IN_IADB_EPIA	net nice

header T_RCVD_IN_IADB_SPF	eval:check_rbl_sub('iadb-firsttrusted', '^127.2.255.1$')
describe T_RCVD_IN_IADB_SPF	ISIPP IADB lists sender as SPF publisher
tflags T_RCVD_IN_IADB_SPF	net nice

header T_RCVD_IN_IADB_CID	eval:check_rbl_sub('iadb-firsttrusted', '^127.2.255.2$')
describe T_RCVD_IN_IADB_CID	ISIPP IADB lists sender as CID publisher
tflags T_RCVD_IN_IADB_CID	net nice

header T_RCVD_IN_IADB_HABEAS	eval:check_rbl_sub('iadb-firsttrusted', '^127.2.255.101$')
describe T_RCVD_IN_IADB_HABEAS	ISIPP IADB lists sender as Habeas participant
tflags T_RCVD_IN_IADB_HABEAS	net nice

header T_RCVD_IN_IADB_BSP	eval:check_rbl_sub('iadb-firsttrusted', '^127.2.255.102$')
describe T_RCVD_IN_IADB_BSP	ISIPP IADB lists sender as BSP participant
tflags T_RCVD_IN_IADB_BSP	net nice

header T_RCVD_IN_IADB_LVL0	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.0$')
describe T_RCVD_IN_IADB_LVL0	ISIPP IADB reports no mailing controls
tflags T_RCVD_IN_IADB_LVL0	net nice

header T_RCVD_IN_IADB_LVL1	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.1$')
describe T_RCVD_IN_IADB_LVL1	ISIPP IADB reports address scraper/opt-out only
tflags T_RCVD_IN_IADB_LVL1	net nice

header T_RCVD_IN_IADB_LVL2	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.2$')
describe T_RCVD_IN_IADB_LVL2	ISIPP IADB reports unverified opt-in
tflags T_RCVD_IN_IADB_LVL2	net nice

header T_RCVD_IN_IADB_LVL3	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.3$')
describe T_RCVD_IN_IADB_LVL3	ISIPP IADB reports unverified opt-in w/ opt-out
tflags T_RCVD_IN_IADB_LVL3	net nice

header T_RCVD_IN_IADB_LVL4	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.4$')
describe T_RCVD_IN_IADB_LVL4	ISIPP IADB reports relationship opt-in
tflags T_RCVD_IN_IADB_LVL4	net nice

header T_RCVD_IN_IADB_LVL5	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.5$')
describe T_RCVD_IN_IADB_LVL5	ISIPP IADB reports < 50% opt-in
tflags T_RCVD_IN_IADB_LVL5	net nice

header T_RCVD_IN_IADB_LVL6	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.6$')
describe T_RCVD_IN_IADB_LVL6	ISIPP IADB reports > 50% opt-in
tflags T_RCVD_IN_IADB_LVL6	net nice

header T_RCVD_IN_IADB_LVL7	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.7$')
describe T_RCVD_IN_IADB_LVL7	ISIPP IADB reports mails are all opt-in
tflags T_RCVD_IN_IADB_LVL7	net nice

header T_RCVD_IN_IADB_LVL8	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.8$')
describe T_RCVD_IN_IADB_LVL8	ISIPP IADB reports mails are <50% verified opt-in
tflags T_RCVD_IN_IADB_LVL8	net nice

header T_RCVD_IN_IADB_LVL9	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.9$')
describe T_RCVD_IN_IADB_LVL9	ISIPP IADB reports mails are >50% verified opt-in
tflags T_RCVD_IN_IADB_LVL9	net nice

header T_RCVD_IN_IADB_LVL10	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.10$')
describe T_RCVD_IN_IADB_LVL10	ISIPP IADB reports mails are 100% verified opt-in
tflags T_RCVD_IN_IADB_LVL10	net nice

header T_RCVD_IN_IADB_LVL100	eval:check_rbl_sub('iadb-firsttrusted', '^127.3.100.100$')
describe T_RCVD_IN_IADB_LVL100	ISIPP IADB reports verified opt-in mailing lists
tflags T_RCVD_IN_IADB_LVL100	net nice

########################################################################

# IADB2 support ...
header __RCVD_IN_IADB2	eval:check_rbl('iadb2-firsttrusted', 'iadb2.isipp.com.')
tflags __RCVD_IN_IADB2	net nice

# 0-9
header T_RCVD_IN_IADB2_00	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.\d$')
describe T_RCVD_IN_IADB2_00	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_00	net nice

# 10-19
header T_RCVD_IN_IADB2_10	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.1\d$')
describe T_RCVD_IN_IADB2_10	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_10	net nice

# 20-29
header T_RCVD_IN_IADB2_20	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.2\d$')
describe T_RCVD_IN_IADB2_20	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_20	net nice

# 30-39
header T_RCVD_IN_IADB2_30	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.3\d$')
describe T_RCVD_IN_IADB2_30	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_30	net nice

# 40-49
header T_RCVD_IN_IADB2_40	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.4\d$')
describe T_RCVD_IN_IADB2_40	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_40	net nice

# 50-59
header T_RCVD_IN_IADB2_50	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.5\d$')
describe T_RCVD_IN_IADB2_50	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_50	net nice

# 60-69
header T_RCVD_IN_IADB2_60	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.6\d$')
describe T_RCVD_IN_IADB2_60	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_60	net nice

# 70-79
header T_RCVD_IN_IADB2_70	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.7\d$')
describe T_RCVD_IN_IADB2_70	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_70	net nice

# 80-89
header T_RCVD_IN_IADB2_80	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.8\d$')
describe T_RCVD_IN_IADB2_80	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_80	net nice

# 90-99
header T_RCVD_IN_IADB2_90	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.9\d$')
describe T_RCVD_IN_IADB2_90	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_90	net nice

# 100 and higher
header T_RCVD_IN_IADB2_100	eval:check_rbl_sub('iadb2-firsttrusted', '^127\.0\.0\.\d{3}$')
describe T_RCVD_IN_IADB2_100	Sender is listed in ISIPP IADB2
tflags T_RCVD_IN_IADB2_100	net nice

########################################################################

# Updated test rules for fraud, uses existing rules and updated rules
body __T_FRAUD_92	/youre? country/i
body __T_FRAUD_110	/the total sum/i
body __T_FRAUD_2	/\bass?ylum\b/i
body __T_FRAUD_102	/foreign (?:offshore )?(?:bank|account)/i
body __T_FRAUD_144	/\bnext of kin\b/i
body __T_FRAUD_235	/(?:international|luckyday|overseas stake|promo|world) lott(?:o|ery)/i
body __T_FRAUD_258	/computer ballot system/i
body __T_FRAUD_113	/win cash/i
body __T_FRAUD_44	/(?:may i first|to) introduce my ?self/i
body __T_FRAUD_81	/as the beneficiary/i
body __T_FRAUD_58	/\bcongo\b/i
body __T_FRAUD_259	/drawn	?from.{0,10}\d{2,3},?\d{3}/i
body __T_FRAUD_149	/as a minister/i
body __T_FRAUD_236	/lott(?:o|ery) (?:co,?ordinator|international)/i
body __T_FRAUD_249	/bequest/i
body __T_FRAUD_125	/(?:white|black|zimbabwean) farmers?/i
body __T_FRAUD_252	/modalit(?:y|ies)/i
body __T_FRAUD_132	/(?:who was a|as a|an? honest|you being a|to any) foreigner/i
body __T_FRAUD_227	/(?:negotiate|reasonable|acc?or?ding|certain|agg?ree).{1,20}percentage/i
body __T_FRAUD_100	/(?:claim|concerning) (?:the|this) money/i
body __T_FRAUD_26	/charity organization/i
body __T_FRAUD_88	/remains unclaimed/i
body __T_FRAUD_16	/land dispute/i
body __T_FRAUD_240	/award notification/i
body __T_FRAUD_157	/god gives .{1,10}second chance/i
body __T_FRAUD_46	/i am contacting you/i
body __T_FRAUD_133	/foreign (?:business partner|customer)/i
body __T_FRAUD_228	/percentage.{1,10}(?:indicat|previous|involved)/i
body __T_FRAUD_120	/letter of authority/i
body __T_FRAUD_114	/you are.{0,8}winner/i
body __T_FRAUD_142	/my late (?:husband|wife|brother|uncle|aunt|father|mother) (?:is|[hw]a[ds])\b/i
body __T_FRAUD_94	/(?:huge|substantial) amount of m[o0]ney/i
body __T_FRAUD_146	/the (?:wife|heir) (?:to|of)\b/i
body __T_FRAUD_96	/(?:will share the money|your share.{1,10}(?:shall|sum|total|money|funds))/i
body __T_FRAUD_41	/prize award dept/i
body __T_FRAUD_216	/reliable person/i
body __T_FRAUD_137	/fiduciary agent/i
body __T_FRAUD_82	/compliments? of the season/i
body __T_FRAUD_251	/magnanimity/i
body __T_FRAUD_19	/political crisis/i
body __T_FRAUD_254	/\bnumbered time\b/i
body __T_FRAUD_241	/urgent and(?: very)? (?:profitable|confidential) business propos(?:al|ition)/i
body __T_FRAUD_35	/international court of justice/i
body __T_FRAUD_217	/secrecy and confidentiality/i
body __T_FRAUD_221	/(?:the importance of|utmost) secrecy/i
body __T_FRAUD_124	/vital documents/i
body __T_FRAUD_18	/over-invoice/i
body __T_FRAUD_42	/(?:finance|holding|securit(?:ies|y)) (?:company|firm|storage house)/i
body __T_FRAUD_31	/embassy/i
body __T_FRAUD_115	/your share shall be\b/i
body __T_FRAUD_3	/assassinate/i
body __T_FRAUD_220	/\bto assure you\b/i
meta T_NIGERIAN_BODY_1	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 1
meta T_NIGERIAN_BODY_2	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 2
meta T_NIGERIAN_BODY_3	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 3
meta T_NIGERIAN_BODY_4	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 4

########################################################################

# header T_FORGED_IN_WHITELIST      eval:check_forged_in_whitelist()
# describe T_FORGED_IN_WHITELIST    Forged From: is in user's white-list
# tflags T_FORGED_IN_WHITELIST      userconf
# 
# header T_FORGED_DEF_WHITELIST     eval:check_forged_in_default_whitelist()
# describe T_FORGED_DEF_WHITELIST   Forged From: is in default white-list
# tflags T_FORGED_DEF_WHITELIST     userconf

# testing for Jeff, do not use!!!
ifplugin Mail::SpamAssassin::Plugin::URIDNSBL
urirhsbl T_URIBL_MP fraud.rhs.mailpolice.com.   A
body     T_URIBL_MP eval:check_uridnsbl('URIBL_MP')
describe T_URIBL_MP URI's domain appears in MailPolice fraud list
tflags   T_URIBL_MP net
endif	# Mail::SpamAssassin::Plugin::URIDNSBL

##########################################################################
# bug 2843

header   T_LEADINGPREP       From =~ /^(?:A|About|All|An|And|Any|As|At|Be|Best|Bulk|Cash|Earn|Easy|Fast|Find|For|Free|From|Get|Hi|Home|In|Instant|Is|It|Its|Limited|Lose|Love|Make|Need|New|No|Save|Sex|She|Special|Stock|Stop|Take|Test|There|This|To|Try|Want|We|What|Where|Why|You|Your)[_ ]/i
describe T_LEADINGPREP       From begins with preposition or similar word

header   T_BLANKNAME    From =~ /"" \</i
describe T_BLANKNAME    Sender has blanked out name

header    T_COPYDVD           Subject =~ /(?:c[o0]py dvd|dvd.{1,15}c[o0]py|dvd magic)/i
describe  T_COPYDVD           Subject mentions copying DVDs

header    T_GETPAID      Subject =~ /[g6][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?t p[\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[d\xD0]/i
describe  T_GETPAID      Subject mentions getting paid for something

header    T_MAKEMONEY            Subject =~ /(?:(?:save|make)[ -].{0,15}money[ -](?:in|on)|(?:free|grant|saving|with our|(?:claim|keep) your) money|money machine)/i
describe  T_MAKEMONEY            Subject mentions money in phrase that implies spam

header    T_WORTHCASH        Subject =~ /\b(?:Worth|Win|take|extra|earn|dollars|Short|need|claim|free|get|opinions?|surveys?)\b.{0,15}(?:fast)?(?:C[a\@]sh|M[0o]ney)\b/i
describe  T_WORTHCASH        Subject mentions something is worth cash

header    T_IMPROVE   Subject =~ /improve your/i
describe  T_IMPROVE   Subject suggests you improve something 

header    T_SUBJBOOST         Subject =~ /[b8\xDF][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[s5\$\xA7][\W_]?t/i
describe  T_SUBJBOOST         boost in Subject

header    T_FOREVER       Subject =~ /\bf[\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[r\xAE][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[vu][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[r\xAE]\b/i
describe  T_FOREVER       Forever in Subject

header    T_SUBJPROVEN        Subject =~ /\bp[\W_]?[r\xAE][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[vu][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[n\xD1\xF1]\b/i
describe  T_SUBJPROVEN        Proven in Subject

header    T_SUBJDEBT         Subject =~ /[d\xD0][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[b8\xDF][\W_]?t/i
describe  T_SUBJDEBT         Subject mentions debt

header    T_INVESTORS         Subject =~ /investors/i
describe  T_INVESTORS         Subject mentions investors

header    T_PAYING            Subject =~ /Paying/i
describe  T_PAYING            Subject mentions Paying for something
                                          
header    T_SUBJDRUGS       Subject =~ /[vu][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?[g6][\W_]?[r\xAE][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5]/i
describe  T_SUBJDRUGS       Subject mentions known spam subject

header    T_MEDICATION   Subject =~ /(?:\/\\\/\\|\/V\\|rn|[m])[\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[d\xD0][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[c\xC7\xE7\xA2\xA9][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?t[\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[n\xD1\xF1]/i
describe  T_MEDICATION   Subject mentions medication

header    T_MEDS          Subject =~ /m(e|3)ds/i  
describe  T_MEDS          Meds in subject

header    T_YOUNGER       Subject =~ /\b[y\xA5\xDD\xFD][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[uv\*\xB5\xD9-\xDC\xF9-\xFC][\W_]?[n\xD1\xF1][\W_]?[g6][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[r\xAE]\b/i
describe  T_YOUNGER       Younger in Subject

header    T_CONSONANTS        Subject =~ /\b[bcghjklmnpqrstvwxz]{6,20}\b/
describe  T_CONSONANTS        Subject contains consecutive consonants in "word"

header    T_SPAMWORDS      Subject =~ /(?!tion)t[\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[n\xD1\xF1]/i
describe  T_SPAMWORDS      masked spam word(s) in subject
                                          
header    T_SPAMWORDS2      Subject =~ /(?!\bcheap(er)?)\b[c\xC7\xE7\xA2\xA9][\W_]?h[\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?p([e3\*\xC8-\xCB\xE8-\xEB][\W_]?[r\xAE])?/i
describe  T_SPAMWORDS2      masked spam word(s) in subject

header    T_SPAMWORDS3      Subject =~ /(?!\bFor\b)\bf[\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[r\xAE]\b/i
describe  T_SPAMWORDS3      masked spam word(s) in subject

header    T_PENIS          Subject =~ /\bpenis\b/i
describe  T_PENIS          masked spam word(s) in subject
 
header    T_SPAMWORDS4      Subject =~ /(?!\bpenis\b)\bp[\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[n\xD1\xF1][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[s5\$\xA7]\b/i
describe  T_SPAMWORDS4      masked spam word(s) in subject

header    T_RNDSPM3   Subject =~ /\b[abehikmpqrsvwxyz]a[bjkquvz]\b/i
describe  T_RNDSPM3   Subject contains random-text spamsign

header    T_RNDSPM5   Subject =~ / [fghjklnqrtz]{3} /i
describe  T_RNDSPM5   Subject contains random-text spamsign

header    T_RNDSPM6   Subject =~ /\b[eiou][bfghjklnpqrtwz]{3}\b/i
describe  T_RNDSPM6   Subject contains random-text spamsign

header    T_RNDSPM7   Subject =~ /\b[bcdfghjklnpqrvwz]{5}\b/i
describe  T_RNDSPM7   Subject contains random-text spamsign

header    T_RNDSPM9      Subject =~ /\b[bcdfghjklmnpqrstvwxz]{7}\b/i
describe  T_RNDSPM9      Subject contains random-text spamsign
                                         
header    T_LONGSUBJ       Subject =~ /.{170,}/
describe  T_LONGSUBJ       Subject is excessively long -- more than 169 chars

header   T_TELESPRLY            Received =~ /dsl\.telesp\.net\.br/
describe T_TELESPRLY            Spam passed through known spam relay domain
	
header   T_INDYLIB       X-Library=~ /Indy 10.00.14-B/
describe T_INDYLIB       Uses spam-only version of Indy library

##########################################################################

# bug 3570
# anti-phishing rules, will probably have a low hit-rate
#
#  0.057   0.0698   0.0000    1.000   0.55    0.01  T_FORGED_EBAY
#  0.047   0.0573   0.0000    1.000   0.54    0.01  T_FORGED_CITI
#  0.034   0.0412   0.0000    1.000   0.52    0.01  T_FORGED_SUNTRUST
#  0.016   0.0191   0.0000    1.000   0.49    0.01  T_FORGED_ABOUT
#  0.009   0.0112   0.0000    1.000   0.48    0.01  T_FORGED_PAYPAL

header   __RCVD_PAYPAL		Received =~ /\.paypal\.com\b/i
header   __FROM_PAYPAL		From =~ /[\@\.]paypal\.com\b/i
uri      __URI_PAYPAL		m{^https?://.{0,32}\bpaypal\.com\b}i
meta     T_FORGED_PAYPAL	(__FROM_PAYPAL && __URI_PAYPAL && !__RCVD_PAYPAL)
describe T_FORGED_PAYPAL	Message appears to be forged, (paypal.com)

header   __RCVD_EBAY		Received =~ /(?:email)?[^\s@]ebay\.com\b/i
header   __FROM_EBAY		From =~ /\@(?:email)?ebay\.com\b/i
uri      __URI_EBAY		m{^https?://.{0,32}\bebay\.com\b}i
meta     T_FORGED_EBAY		(__FROM_EBAY && __URI_EBAY && !__RCVD_EBAY)
describe T_FORGED_EBAY		Message appears to be forged, (ebay.com)

header   __RCVD_CITIBNK		Received =~ /\b(?:citi(?:bank|cards|corp|bankcards)|acxiom|c2it)\.com\b/i
header   __FROM_CITIBNK		From =~ /\bciti(?:bank)?\.com\b/i
uri      __URI_CITIBNK		m{^https?://.{0,32}\bciti(?:bank)?\.com\b}i
meta     T_FORGED_CITI		(__FROM_CITIBNK && __URI_CITIBNK && !__RCVD_CITIBNK)
describe T_FORGED_CITI		Message appears to be forged, (citibank.com)

header   __RCVD_SUNTRUST	Received =~ /\.suntrust\.com\b/i
header   __FROM_SUNTRUST	From =~ /[\@\.]suntrust\.com\b/i
uri      __URI_SUNTRUST		m{^https?://.{0,32}\bsuntrust\.com\b}i
meta     T_FORGED_SUNTRUST	(__FROM_SUNTRUST && __URI_SUNTRUST && !__RCVD_SUNTRUST)
describe T_FORGED_SUNTRUST	Message appears to be forged, (suntrust.com)

header   __RCVD_ABOUT_COM	Received =~ /\babout\.com\b/i
header   __FROM_ABOUT_COM	From =~ /\babout\.com\b/i
uri      __URI_ABOUT_COM	m{^https?://.{0,32}\babout\.com\b}i
meta     T_FORGED_ABOUT		(!__RCVD_ABOUT_COM && __FROM_ABOUT_COM && !__URI_ABOUT_COM)
describe T_FORGED_ABOUT		Message appears to be forged, (about.com)

##########################################################################

# http://bugzilla.spamassassin.org/show_bug.cgi?id=3645
header    T_SARE_SUB_DOLLARS    Subject =~ /^\s*(?:\w+ )?(?:\w+: )?\$\d+\s*$/
describe  T_SARE_SUB_DOLLARS    Subject is dollar sign and numerics only

# http://bugzilla.spamassassin.org/show_bug.cgi?id=2016
rawbody T_INTERRUPTUS           /(?:[a-zA-Z0-9]<[\/ ]{0,2}?(?!br)(?!p)(?!sup)(?!li)(?!b)(?!i)(?!option)(?!a (?:href|name))(?:\b|!--)[^>]{0,64}?>[a-zA-Z0-9].{0,64}){3}/i
describe T_INTERRUPTUS          Hypertextus Interruptus - HTML-obfuscated text

##########################################################################

# bug 2397 - CLA requested
body T_DISGUISE_PORN_MUNDANE	/\b(?:h[0*]t|y[0*][uv]ng|b[0*]ys?|g[1*]r[1l]s?|g[1l]rls?|w[1*]ves|w[1*]fe|s3xy?|p[0*]rn[o0*]?)\b/i
describe T_DISGUISE_PORN_MUNDANE	Attempts to disguise mundane words used in porn

##########################################################################
