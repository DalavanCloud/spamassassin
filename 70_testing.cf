# SpamAssassin rules file: CVS rules under test, $Rev$
#
# This file is a placeholder for rules "under probation", ie. checked into
# CVS for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# <@LICENSE>
# Copyright 2004 Apache Software Foundation
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
###########################################################################

# http://bugzilla.spamassassin.org/show_bug.cgi?id=2088
header T_RATWARE_MIME_844412	Content-Type =~ /boundary="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}"/

# http://bugzilla.spamassassin.org/show_bug.cgi?id=2087
header T_RATWARE_OE_DM	X-Mailer =~ /^Microsoft Outlook Express [\d\.]+ DM$/

# a referral ID
uri T_REF_ID			/[\?\&]RefID/

# http://bugzilla.spamassassin.org/show_bug.cgi?id=2089
header T_DATE_EXTRA_SPACE	Date =~ /^..., .\d ... \d\d\d\d \d\d:\d\d:\d\d  [\+\-]\d\d\d\d$/

# another one for bug 2089, may be more useful:
full __END_HASHBUSTER_1		/\n\[[a-z0-9]+\]\n\s*\Z/
meta T_RATWARE_2089		(NO_REAL_NAME && __END_HASHBUSTER_1)

# this is really badly faked.  Also the spammer who uses "25250101"
# for the build is a total hippie.
header T_RATWARE_GECKO_BUILD	User-Agent =~ /Gecko\/(?!200\d\d\d\d\d)\d/

# another good way to catch mozilla fakery
header __UA_GECKO		User-Agent =~ /Gecko\//
header __EXISTS_ACCEPT_LANG	exists:X-Accept-Language
meta T_RATWARE_GECKO_NO_LANG	(__UA_GECKO && !__EXISTS_ACCEPT_LANG)

# reminder: develop these after 2.60
full T_SPRINTF_5X	/[^-][A-F1-9][A-F0-9]{5,7}-[A-F1-9][A-F0-9]{5,7}-[A-F1-9][A-F0-9]{5,7}-[A-F1-9][A-F0-9]{5,7}-[A-F1-9][A-F0-9]{5,7}[^-]/

# (time_t/4444)
header T_TIME_OVER_4444	ALL =~ /\D23[67][0-9][0-9][0-9]\D/

# replacements for PORN_4; split out sub-patterns as some are more FP-prone
# than others.
uri T_PORN_URL_XXX         /^https?:\/\/[\w\.-]*xxx[\w-]*\./
uri T_PORN_URL_SEX         /^https?:\/\/[\w\.-]*(?<!es|ba)(?<!dle|sus)sex[\w-]*\./
uri T_PORN_URL_ANAL        /^https?:\/\/[\w\.-]*anal(?!og|y[sz])[\w-]*\./
uri T_PORN_URL_SLUT        /^https?:\/\/[\w\.-]*slut[\w-]*\./
uri T_PORN_URL_CUM         /^https?:\/\/[\w\.-]*(?<!cir)(?<!\bdo)cum(?!ul|be?r|b?en)[\w-]*\./
uri T_PORN_URL_LUST        /^https?:\/\/[\w\.-]*lust(?!(?<=illust)(?:rat|rious)|(?<=clust)er)[\w-]*\./
uri T_PORN_URL_PANT        /^https?:\/\/[\w\.-]*pant(?:y|ies)[\w-]*\./
uri T_PORN_URL_SUCK        /^https?:\/\/[\w\.-]*suck[\w-]*\./
uri T_PORN_URL_TEEN        /^https?:\/\/[\w\.-]*(?<!thir|four|eigh|nine)(?<!fif|six)(?<!seven)teen[\w-]*\./
uri T_PORN_URL_MISC        /^https?:\/\/[\w\.-]*(pussy|nympho|porn|hard-?core|taboo|whore|voyeur|lesbian|gurlpages|naughty|lolita|schoolgirl|kooloffer|erotic)[\w-]*\./

header T_KOREAN_UCE_SUBJECT	Subject:raw =~ /\?B\?KLGksO0p/

header T_DATE_DOUBLE_DASH	Date =~ /:\d\d --\d\d\d\d$/

header __RCVD_IN_SORBS_RHSBL	eval:check_rbl_from_host('sorbsrhs', 'rhsbl.sorbs.net.')
tflags __RCVD_IN_SORBS_RHSBL	net

header T_RCVD_IN_SORBS_BADCONF	eval:check_rbl_sub('sorbsrhs', '127.0.0.11')
describe T_RCVD_IN_SORBS_BADCONF	SORBS: sender uses invalid DNS A or MX records
tflags T_RCVD_IN_SORBS_BADCONF	net

header T_RCVD_IN_SORBS_NOMAIL	eval:check_rbl_sub('sorbsrhs', '127.0.0.12')
describe T_RCVD_IN_SORBS_NOMAIL	SORBS: sender is not expected to send mail
tflags T_RCVD_IN_SORBS_NOMAIL	net

# test XBL with -notfirsthop
header T_RCVD_IN_XBL_NFH	eval:check_rbl_sub('sblxbl-notfirsthop', '(?i)/xbl')
describe T_RCVD_IN_XBL_NFH	Received via a relay in Spamhaus XBL
tflags T_RCVD_IN_XBL_NFH	net

# SPF support.  "pass" is nice, "fail" is bad, "softfail" is bad, but
# not as bad as "fail".
header T_SPF_PASS	eval:check_for_spf_pass()
tflags T_SPF_PASS	net nice
score T_SPF_PASS	-0.1
header T_SPF_FAIL	eval:check_for_spf_fail()
tflags T_SPF_FAIL	net
score T_SPF_FAIL	0.2
header T_SPF_SOFTFAIL	eval:check_for_spf_softfail()
tflags T_SPF_SOFTFAIL	net
score T_SPF_SOFTFAIL	0.1

header T_SPF_HELO_PASS	eval:check_for_spf_helo_pass()
tflags T_SPF_HELO_PASS	net nice
score T_SPF_HELO_PASS	-0.1
header T_SPF_HELO_FAIL	eval:check_for_spf_helo_fail()
tflags T_SPF_HELO_FAIL	net
score T_SPF_HELO_FAIL	0.2
header T_SPF_HELO_SOFTFAIL	eval:check_for_spf_helo_softfail()
tflags T_SPF_HELO_SOFTFAIL	net
score T_SPF_HELO_SOFTFAIL	0.1

# Not good, esp. considering how *slow* it runs..
# 17.640   4.1041  29.0741    0.124   0.69   -0.10  T_ALL_RELAYS_NEAR_MXES
# However, combined with SBL it might work out useful...
#header T_ALL_RELAYS_NEAR_MXES	eval:check_for_all_relays_near_mxes()
#tflags T_ALL_RELAYS_NEAR_MXES	net nice
#score T_ALL_RELAYS_NEAR_MXES	-0.1
#describe T_ALL_RELAYS_NEAR_MXES	All relays are near to their MXes

# try out new versions of username in subject ...
# "user@domain.com" in the subject, case insensitive
header T_USERNAME_IN_SUBJECT1     eval:check_for_to_in_subject('1')
describe T_USERNAME_IN_SUBJECT1   Full To: address listed in Subject:
header T_USERNAME_IN_SUBJECT2     eval:check_for_to_in_subject('2')
describe T_USERNAME_IN_SUBJECT2   To: username listed in Subject: (ucfirst)
header T_USERNAME_IN_SUBJECT3     eval:check_for_to_in_subject('3')
describe T_USERNAME_IN_SUBJECT3   Full To: address listed at front of Subject:

# This is hitting nothing.  Maybe it's gone again...
header T_RCVD_IN_PDL	 	rbleval:check_rbl_txt('pdl-notfirsthop', 'dialups.visi.com.')
describe T_RCVD_IN_PDL		Received via a relay in PDL, http://www.pan-am.ca/pdl/
tflags T_RCVD_IN_PDL		net

rawbody T_RNDMX			/<rndmx\b/
describe T_RNDMX		Contains 'rndmx' hashbuster code

########################################################################
# This ratware always uses a +0000 TZ in the Date header, and has a multiplicity
# of From: header formats. ("From" header samples from Steven Champeon
# <schampeo.hesketh.com> via the spamtools.lists.abuse.net and SPAM-L lists).
#
# Note that this ratware is also quite buggy -- it regularly sends out spam
# mails with no subject line or body text!
#
# "First Last" <firstlast_[a-z][a-z]@somedomain>	1
# "First Last" <firstlast[a-z][a-z]@somedomain>		1
# "First Last" <first.last[a-z][a-z]@somedomain>	1
# "First Last" <first_last[a-z][a-z]@somedomain>	1
# "First Last" <first_last_[a-z][a-z]@somedomain>	1
# "First Last" <flast_[a-z][a-z]@somedomain>		2
# "First Last" <flast[a-z][a-z]@somedomain>		2
# "First Last" <f.last_[a-z][a-z]@somedomain>		2
# "First Last" <f.last[a-z][a-z]@somedomain>		2
# "First Last" <f_last[a-z][a-z]@somedomain>		2
# "First Last" <last[a-z][a-z]@somedomain>		3
# "First M. Last" <firstlast_[a-z][a-z]@somedomain>	4
# "First M. Last" <firstlast[a-z][a-z]@somedomain>	4
# "First M. Last" <first.m.last[a-z][a-z]@somedomain>	5
# "First M. Last" <firstmlast[a-z][a-z]@somedomain>	5
# "First M. Last" <firstmlast_[a-z][a-z]@somedomain>	5
# "First M. Last" <fmlast_[a-z][a-z]@somedomain>	6
# "First M. Last" <mlast[a-z][a-z]@somedomain>		7
# "First M. Last" <m.last[a-z][a-z]@somedomain>		7
header __T_0_TZ_1	    From =~ /^\"(\w)(\w+) (\w+)\" <\1\2[\._]?\3_?[a-z][a-z]\@/i
header __T_0_TZ_2	    From =~ /^\"(\w)(\w+) (\w+)\" <\1[\._]?\3_?[a-z][a-z]\@/i
header __T_0_TZ_3	    From =~ /^\"(\w)(\w+) (\w+)\" <\3_?[a-z][a-z]\@/i
header __T_0_TZ_4	    From =~ /^\"(\w)(\w+) (\w)\. (\w+)\" <\1\2[\._]?\4_?[a-z][a-z]\@/i
header __T_0_TZ_5	    From =~ /^\"(\w)(\w+) (\w)\. (\w+)\" <\1\2[\._]?\3[\._]?\4_?[a-z][a-z]\@/i
header __T_0_TZ_6	    From =~ /^\"(\w)(\w+) (\w)\. (\w+)\" <\1\3\4_?[a-z][a-z]\@/i
header __T_0_TZ_7	    From =~ /^\"(\w)(\w+) (\w)\. (\w+)\" <\3[\._]?\4_?[a-z][a-z]\@/i

header __T_RATWARE_0_TZ_DATE		Date =~ / \+0000$/

meta T_RATWARE_0_TZ_1	(__T_RATWARE_0_TZ_DATE && __CTYPE_HTML && __T_0_TZ_1)
meta T_RATWARE_0_TZ_2	(__T_RATWARE_0_TZ_DATE && __CTYPE_HTML && __T_0_TZ_2)
meta T_RATWARE_0_TZ_3	(__T_RATWARE_0_TZ_DATE && __CTYPE_HTML && __T_0_TZ_3)
meta T_RATWARE_0_TZ_4	(__T_RATWARE_0_TZ_DATE && __CTYPE_HTML && __T_0_TZ_4)
meta T_RATWARE_0_TZ_5	(__T_RATWARE_0_TZ_DATE && __CTYPE_HTML && __T_0_TZ_5)
meta T_RATWARE_0_TZ_6	(__T_RATWARE_0_TZ_DATE && __CTYPE_HTML && __T_0_TZ_6)
meta T_RATWARE_0_TZ_7	(__T_RATWARE_0_TZ_DATE && __CTYPE_HTML && __T_0_TZ_7)

########################################################################
# rules to detect certain generally unnecessary encodings in HTML

rawbody T_ENTITY_WHITESPACE_R	/\&\#(?:10|32)\;/
body T_ENTITY_WHITESPACE_B	/\&\#(?:10|32)\;/
meta T_ENTITY_WHITESPACE_M	(T_ENTITY_WHITESPACE_R || T_ENTITY_WHITESPACE_B)

rawbody T_ENTITY_ALPHANUM_R	/\&\#(?:4[89]|5[0-7]|6[5-9][78]\d|9[0789]|1[01]\d|12[012])\;/
body T_ENTITY_ALPHANUM_B	/\&\#(?:4[89]|5[0-7]|6[5-9][78]\d|9[0789]|1[01]\d|12[012])\;/
meta T_ENTITY_ALPHANUM_M	(T_ENTITY_ALPHANUM_R || T_ENTITY_ALPHANUM_B)

rawbody T_ENTITY_OTHER1_R	/\&\#(?:46|47)\;/
body T_ENTITY_OTHER1_B		/\&\#(?:46|47)\;/
meta T_ENTITY_OTHER1_M		(T_ENTITY_OTHER1_R || T_ENTITY_OTHER1_B)

rawbody T_ENTITY_OTHER2_R	/\&\#(?:33|39|40|46|47)\;/
body T_ENTITY_OTHER2_B		/\&\#(?:33|39|40|46|47)\;/
meta T_ENTITY_OTHER2_M		(T_ENTITY_OTHER2_R || T_ENTITY_OTHER2_B)

########################################################################
# HTML title rules

# title not in head and/or in body
body T_HTML_TITLE_MISPLACED_1	eval:html_test('t_title_misplaced_1')
body T_HTML_TITLE_MISPLACED_2	eval:html_test('t_title_misplaced_2')
body T_HTML_TITLE_MISPLACED_3	eval:html_test('t_title_misplaced_3')
body T_HTML_TITLE_MISPLACED_4	eval:html_test('t_title_misplaced_4')
meta T_HTML_TITLE_MISPLACED_M1	(T_HTML_TITLE_MISPLACED_1 && T_HTML_TITLE_MISPLACED_2)
meta T_HTML_TITLE_MISPLACED_M2	(T_HTML_TITLE_MISPLACED_1 || T_HTML_TITLE_MISPLACED_2)

# this won't work well until we parse HTML documents separately
body T_HTML_TITLE_EXTRA		eval:html_test('t_title_extra')

# possible replacement rules
body T_HTML_TITLE_EMPTY		eval:html_title('!~ /\S/s')
body T_HTML_TITLE_UNTITLED_1	eval:html_title('=~ /untitled/i')
body T_HTML_TITLE_UNTITLED_2	eval:html_title('=~ /new page \d+/i')
body T_HTML_TITLE_UNTITLED_3	eval:html_title('=~ /untitled|new page \d+/i')

# according to the postmaster at qualcomm, no mail is sent from eudora.com, but it's heavily joe-jobbed ...
header T_FROM_EUDORA            From:addr =~ /\@eudora\.com/i

# similar concept for Delphi.com.  Was an ISP, now a car company!
# I think their username format is "First.Last"; requiring 2 digits
# will be pretty safe.  (lower rule as a baseline to see if we miss much)
header T_FROM_DELPHI		From:addr =~ /\d[^\@]+\d[^\@]+\@delphi\.com/i
header T_FROM_DELPHI_BASIC	From:addr =~ /\@delphi\.com/i

body T_RANDO_MIZE		/\$RAN[DOMI]*\s+[DOMI]*ZE/

# yet another open Yahoo! redirector
uri T_YAHOO_REDIR		/^http:\/\/srd\.yahoo\.com\//i

header T_HASHCASH_20		eval:check_hashcash_value('20', '21')
header T_HASHCASH_21		eval:check_hashcash_value('21', '22')
header T_HASHCASH_22		eval:check_hashcash_value('22', '23')
header T_HASHCASH_23		eval:check_hashcash_value('23', '24')
header T_HASHCASH_24		eval:check_hashcash_value('24', '25')
header T_HASHCASH_25		eval:check_hashcash_value('25', '26')
header T_HASHCASH_26		eval:check_hashcash_value('26', '9999')
tflags T_HASHCASH_20		nice
tflags T_HASHCASH_21		nice
tflags T_HASHCASH_22		nice
tflags T_HASHCASH_23		nice
tflags T_HASHCASH_24		nice
tflags T_HASHCASH_25		nice
tflags T_HASHCASH_26		nice
score T_HASHCASH_20		-0.5
score T_HASHCASH_21		-0.7
score T_HASHCASH_22		-1.0
score T_HASHCASH_23		-2.0
score T_HASHCASH_24		-3.0
score T_HASHCASH_25		-4.0
score T_HASHCASH_26		-5.0

header T_HASHCASH_2SPEND	eval:check_hashcash_double_spend()
describe T_HASHCASH_2SPEND	HashCash token already spent in another mail
score T_HASHCASH_2SPEND		0.1

# Altavista.com's Greg Connor gconnor at nekodojo.org says 'they never send
# mail'; <2423209050.1071572609@[172.23.65.45]>, Tue, 16 Dec 2003 11:03:29
# -0800, on the spf-discuss at v2.listbox.com mailing list.  Let's see
# what this results in!
#
header T_FAKE_FROM_ALTAVISTA	From:addr =~ /\@altavista\.com$/i
header T_FAKE_TO_ALTAVISTA	To:addr =~ /\@altavista\.com$/i
header T_FAKE_REPTO_ALTAVISTA	Reply-To:addr =~ /\@altavista\.com$/i
header T_FAKE_ERRSTO_ALTAVISTA	Errors-To:addr =~ /\@altavista\.com$/i
header T_FAKE_ENVFROM_ALTAVISTA	EnvelopeFrom =~ /\@altavista\.com$/i

header T_FAKE_OUTBLAZE_RCVD	Received =~ /\.mr\.outblaze\.com/
header T_FAKE_OUTBLAZE_MID_1	Message-Id =~ /\.mr\.outblaze\.com/
header T_FAKE_OUTBLAZE_MID_2	MESSAGEID =~ /\.mr\.outblaze\.com/

header T_ALL_TRUSTED		eval:check_all_trusted()
describe T_ALL_TRUSTED		Did not pass through any untrusted hosts
tflags T_ALL_TRUSTED		nice

# both aspects of same spammer tool
header T_NETIP_RCVD		Received =~ /netIP with HTTP\;/
header T_NETIP_BOUND		Content-Type =~ /boundary="--ALT--[A-Z]{4}\d/

# several variants of same rule idea
header T_XORIGIP_INVALID	X-Originating-IP =~ /[^\[\]\s\.\d]/
header T_XORIGIP_BAD		X-Originating-IP !~ /\[?(?:\d{1,3}\.){3}\d{1,3}\]?/ [if-unset: 0.0.0.0] 
header T_XORIGIP_WRONG		X-Originating-IP !~ /^\[?(?:\d{1,3}\.){3}\d{1,3}\]?$/ [if-unset: 0.0.0.0] 

# some tests to catch long lines of random dictionary words
# this could be slow, being a rawbody rule, but if it works well maybe
# we should consider a way to spot these kinds of auto-generated
# text patterns efficiently...
rawbody T_BAYESBUSTER_LINE_12	/^([a-z]{3,} ){12,}<[Bb][Rr]>$/
rawbody T_BAYESBUSTER_LINE_15	/^([a-z]{3,} ){15,}<[Bb][Rr]>$/
rawbody T_BAYESBUSTER_LINE_15I	/^([a-z]{3,} ){15,}<br>$/i

# reported by Kurtis Rader, bug 2890
uri T_MSN_REDIR		/^http:\/\/shopping\.msn\.com\/trackurl\.aspx\?/i
describe T_MSN_REDIR	Has MSN Redirect URI

# Catches e.g. 'Re: EFDNOX, a thousand dollars', 'Re: ZJXQAOBK, dont know
# anything', 'Re: ODLI, came the noise' but misses 'Re: MNCYU, thought: of
# testing'.  Has to avoid FPs like 'Re: SIGSEGV, where are you?', 'Re: EXMH,
# Metamail and RH8.0'.
#
header T_RE_UC_3WORDS	Subject =~ /^[rR][eE]: [A-Z]{3,12},(?:\s[A-Z][a-z]+){3}$/
describe T_RE_UC_3WORDS	Has Subject in form "Re: UPPERCASE, word word word"

# Spammers are now attempting to use tiny font sizes to hide hashbusters
body T_HTML_FONT_TINY		eval:html_test('t_tiny_font')
describe T_HTML_FONT_TINY	HTML has a tiny font

# more portable replacement for RCVD_NUMERIC_HELO that doesn't rely on
# Received headers using "helo=" prefix
header T_RCVD_NUMERIC_HELO	X-Spam-Relays-Untrusted =~ / helo=\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3} /
describe T_RCVD_NUMERIC_HELO	Received: contains an IP address used for HELO
# same but not for first line
header T_RCVD_NUMERIC_HELO_NOTFIRST	X-Spam-Relays-Untrusted =~ / helo=\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3} .+\[/
describe T_RCVD_NUMERIC_HELO_NOTFIRST	Received: contains an IP address used for HELO (not first line)

# If the Message-Id claims to be added by one ISP, there should be a Received
# header which mentions that ISP.
header __MSGID_HAS_HOTMAIL	MESSAGEID =~ /hotmail\.com/
header __RCVD_HAS_HOTMAIL	Received =~ /(?:hotmail|msn)\.com/
meta T_MID_RCVD_DIFF_HOTMAIL	(__MSGID_HAS_HOTMAIL && !__RCVD_HAS_HOTMAIL)
describe T_MID_RCVD_DIFF_HOTMAIL Message-Id does not match Received (hotmail.com)

header __MSGID_HAS_AOL	MESSAGEID =~ /aol\.com/
header __RCVD_HAS_AOL	Received =~ /aol\.com/
meta T_MID_RCVD_DIFF_AOL	(__MSGID_HAS_AOL && !__RCVD_HAS_AOL)
describe T_MID_RCVD_DIFF_AOL	Message-Id does not match Received (aol.com)

uri	T_URI_UNPRINTABLE	/%0/
describe T_URI_UNPRINTABLE	URI contains unprintable characters

# 0 nonspam hits, hundreds of spam hits.  Serious problems there
uri T_TERRA_ES		/terra\.es\//i
describe T_TERRA_ES	Contains images or links to pages hosted at 'terra.es'

# bug 2957
uri T_INFO_TLD			/^(?:https?:\/\/|mailto:)[^\/]+\.info(?:\/|$)/i
describe T_INFO_TLD		Contains a URL in the INFO top-level domain    

header T_RCVD_IN_BOGUSMX	rbleval:check_rbl_from_host('rfci-bmx', 'bogusmx.rfc-ignorant.org.')
describe T_RCVD_IN_BOGUSMX	Received via a relay in BogusMX, http://www.rfc-ignorant.org/
tflags T_RCVD_IN_BOGUSMX	net

# bug 2071
body            T_GEVALIACOFFEE           /\bGevalia (?:Coffee|Kaffe)\b/i
describe        T_GEVALIACOFFEE           Selling Gevalia Coffee

# bug 2970: Bob Menschel's "longwords" rules
body     T_RM_BPT_LONGWORDS_68A /\b(?:[a-z]{6,}\s+){8}/
describe T_RM_BPT_LONGWORDS_68A Long string of long words
body     T_RM_BPT_LONGWORDS_69A /\b(?:[a-z]{6,}\s+){9}/
describe T_RM_BPT_LONGWORDS_69A Long string of long words
body     T_RM_BPT_LONGWORDS_78A /\b(?:[a-z]{7,}\s+){8}/
describe T_RM_BPT_LONGWORDS_78A Long string of long words
body     T_RM_BPT_LONGWORDS_59A /\b(?:[a-z]{5,}\s+){9}/
describe T_RM_BPT_LONGWORDS_59A Long string of long words
body     T_RM_BPT_LONGWORDS_79A /\b(?:[a-z]{7,}\s+){9}/
describe T_RM_BPT_LONGWORDS_79A Long string of long words
body     T_RM_BPT_LONGWORDS_96A /\b(?:[a-z]{9,}\s+){6}/
describe T_RM_BPT_LONGWORDS_96A Long string of long words
body     T_RM_BPT_LONGWORDS_88A /\b(?:[a-z]{8,}\s+){8}/
describe T_RM_BPT_LONGWORDS_88A Long string of long words
body     T_RM_BPT_LONGWORDS_89A /\b(?:[a-z]{8,}\s+){9}/
describe T_RM_BPT_LONGWORDS_89A Long string of long words
body     T_RM_BPT_LONGWORDS_97 /\b(?:\w{9,}\s+){7}/
describe T_RM_BPT_LONGWORDS_97 Long string of long words
body     T_RM_BPT_LONGWORDS_98 /\b(?:\w{9,}\s+){8}/
describe T_RM_BPT_LONGWORDS_98 Long string of long words
body     T_RM_BPT_LONGWORDS_99 /\b(?:\w{9,}\s+){9}/
describe T_RM_BPT_LONGWORDS_99 Long string of long words

# "www" hidden as "%77%77%77", "ww%77", etc.
# note: *not* anchored to start of string, to catch use of redirectors
uri	 T_HTTP_77	/http:\/\/.{0,2}\%77/
describe T_HTTP_77	Contains a URL-encoded hostname (HTTP77)

# Interesting new feature; spamware HELO'ing, from a dialup IP addr,
# using that IP's rDNS entry.  We can catch this easily.
#
# Note the '^[^\]]+ ' stanza: this ensures that we only match spamware
# connecting to a trusted relay; if a mail came from a dynamic addr but
# was relayed through their smarthost, that's fine.

# dhcp024-210-034-053.columbus.rr.com [24.210.34.53]
# c-66-176-16-108.se.client2.attbi.com [66.176.16.108]
# c-67-168-174-61.client.comcast.net [67.168.174.61]
# NNN-NNN-NNN-NNN.fibertel.com.ar
# NN.NN.NNN.NNN.ap.yournet.ne.jp
# NN.NNN.NN-NN.rev.gaoland.net
# (require an alpha first, as legit HELO'ing-as-IP-address is hit otherwise)
header T_HELO_DYNAMIC_IPADDR X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=[a-z]\S*\d+\D\d+\D\d+\D\d+\D[^\.]*\.\S+\.\S+/i
header T_HELO_DYNAMIC_IPADDR2 X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\d+\D\d+\D\d+\D\d+\D[^\.]*\.\S+\.\S+/i
# dhcp024-210-034-053.columbus.rr.com [24.210.34.53]
header T_HELO_DYNAMIC_RR   X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\S*(?:docsis|cable|dsl|dhcp|cpe)\S*\d+\D+\d+/i
# fia83-8.dsl.hccnet.nl [62.251.8.83]
# fia160-115-100.dsl.hccnet.nl [80.100.115.160]
header T_HELO_DYNAMIC_HCC   X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\S*\d+\D+\d+\S*\.(?:docsis|cable|dsl|adsl|dhcp|cpe)\./i
# f88114.upc-f.chello.nl [80.56.88.114]
header T_HELO_DYNAMIC_CHELLO X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\S+upc-f\.chello\.nl/i
# h0002a5d76857.ne.client2.attbi.com [65.96.12.59]
header T_HELO_DYNAMIC_ATTBI  X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\S+\d+\S+\.client2\.attbi\.com/i
# pcp04024417pcs.toresd01.pa.comcast.net [68.86.206.126]
# bgp542174bgs.ewndsr01.nj.comcast.net[68.38.144.91]
header T_HELO_DYNAMIC_COMCAST X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=(?:pcp|bgp)\S+(?:pcs|bgs)\.comcast\.net/i
# CPE0004e2372711-CM000a73666706.cpe.net.cable.rogers.com
# CPE00e0184f0eba-CM014490118324.cpe.net.cable.rogers.com [24.43.109.140]
header T_HELO_DYNAMIC_ROGERS X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=CPE\d+\S+\.rogers\.com/i
# ca-morpark-cuda1-zone7-b-159.vnnyca.adelphia.net[67.23.129.159]
# tn-greenvillecuda1cable7a-36.atlaga.adelphia.net [68.171.113.36]
# ky-richmond2a-123.rhmdky.adelphia.net [68.71.36.123]
# ny-lackawannacadent4-chtwga3a-b-117.buf.adelphia.net [68.71.205.117]
# fl-edel-u2-c3c-233.pbc.adelphia.net [68.64.89.233]
header T_HELO_DYNAMIC_ADELPHIA X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=[a-z]{2}-\S+-\d{1,3}\.[a-z]{3,8}\.adelphia\.net/i
# pD9E4F89F.dip.t-dialin.net [217.228.248.159]
header T_HELO_DYNAMIC_DIALIN X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=[a-z][A-F0-9]+\.dip\./
# 0xd5aaf40b.dhcp.kabelnettet.dk
# 0x50a46949.virnxx11.adsl-dhcp.tele.dk
header T_HELO_DYNAMIC_HEXIP X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=0x[a-f0-9]{8}\./
# 118.Red-80-35-201.pooles.rima-tde.net
header T_HELO_DYNAMIC_SPLIT_IP X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\d+\.\S+\d+\D\d+\D\d+\D/
# YahooBB219173000034.bbtec.net [219.173.0.34]
header T_HELO_DYNAMIC_YAHOOBB X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=YahooBB/i
# ool-18be1aaf.dyn.optonline.net [24.190.26.175]
header T_HELO_OPTONLINE X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=\S+\.dyn\.optonline\.net/

# TODO:
# port-212-202-77-203.reverse.qsc.de [212.202.77.203]
# Computer-udp135632uds.union01.nj.comcast.net [68.39.99.32]
# lns-vlq-11-62-147-186-141.adsl.proxad.net [62.147.186.141]
# pD9E62653.dip.t-dialin.net [217.230.38.83]
# g1u3v7.cpe.net.cable.rogers.com [24.230.206.35]
# h00096b2fb5ff.ne.client2.attbi.com [24.34.132.193]
# c-67-164-133-216.client.comcast.net [67.164.133.216]
# d53-64-35-171.nap.wideopenwest.com [64.53.171.35]
# CM-vina5-168-207.cm.vtr.net [200.104.168.207]
# h234n2fls32o895.telia.com [217.208.73.234]
# vaise-1-82-67-44-166.fbx.proxad.net [82.67.44.166]
# cpe-069-132-010-017.carolina.rr.com [69.132.10.17]
# 200-171-228-6.customer.telesp.net.br [200.171.228.6]
# wiley-170-10231.roadrunner.nf.net [205.251.210.249]
# modemcable090.28-201-24.mc.videotron.ca [24.201.28.90]
# CM-anto1-98-153.cm.vtr.net [200.104.98.153]
# 80-218-47-160.dclient.hispeed.ch [80.218.47.160]
# adsl-64-170-53-19.dsl.lsan03.pacbell.net [64.170.53.19]
# catv-506237d8.miskcatv.broadband.hu [80.98.55.216]
# dsl-200-95-109-107.prod-infinitum.com.mx [200.95.109.107]
# user-0can22v.cable.mindspring.com [24.171.136.95]
# fgwcq@74.67-201-80.adsl.skynet.be [80.201.67.74]
# lnngmi06edg01-xdata2-a3.lnngmi.tds.net [134.215.229.67]
# cdm-68-226-239-16.laft.cox-internet.com [68.226.239.16]
# adsl-68-248-121-117.dsl.applwi.ameritech.net [68.248.121.117]
# pool-151-203-32-68.bos.east.verizon.net [151.203.32.68]
# 12-218-225-223.client.mchsi.com [12.218.225.223]


# bug 2992: Proposed new rules, Martin Radford
header T_RCVD_DOUBLE_IP		Received =~ /from \[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\] by \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3} with HTTP;/
describe T_RCVD_DOUBLE_IP	Bulk email fingerprint (double IP) found

header T_MIME_BOUND_DIGITS15	Content-Type =~ /boundary=\"\d{15,}\"/
describe T_MIME_BOUND_DIGITS15	MIME boundary contains all digits

header T_MSGID_SPAM_2_A		Message-Id =~ /<[A-Z]{7}-000[0-9]{10}\@[a-z]*>/
describe T_MSGID_SPAM_2_A	Message-ID has known spammer pattern
header T_MSGID_SPAM_2_B		MESSAGEID =~ /<[A-Z]{7}-000[0-9]{10}\@[a-z]*>/
describe T_MSGID_SPAM_2_B	Message-ID has known spammer pattern

# another Message-Id format (pick one as MSGID_SPAM_3)
header T_MSGID_SPAM_3_5		Message-Id =~ /<[a-z]{5,}\@(\S+\.)+\S+>/
describe T_MSGID_SPAM_3_5	Message-ID has known spammer pattern
header T_MSGID_SPAM_3_6		Message-Id =~ /<[a-z]{6,}\@(\S+\.)+\S+>/
describe T_MSGID_SPAM_3_6	Message-ID has known spammer pattern
header T_MSGID_SPAM_3_7		Message-Id =~ /<[a-z]{7,}\@(\S+\.)+\S+>/
describe T_MSGID_SPAM_3_7	Message-ID has known spammer pattern

# evil spam tool
# Message-ID generator algorithm:
# letter: 1/2 (pick a-z) | 1/2 (pick 0-9)
# 10-29 letters: 1/8 (pick $) | 1/8 (pick -) | 3/8 (pick a-z) | 3/8 (pick 0-9)
# letter: 1/2 (pick a-z) | 1/2 (pick 0-9)
# @
# letter: 2/3 (pick a-z) | 1/3 (pick 0-9)
# 3-12 letters: 1/8 (pick .) | 7/12 (pick a-z) | 7/24 (pick 0-9)
# letter: 2/3 (pick a-z) | 1/3 (pick 0-9)
header __MSGID_ESPAM		Message-ID =~ /<[a-z\d][a-z\d\$-]{10,29}[a-z\d]\@[a-z\d][a-z\d.]{3,12}[a-z\d]>/
header __MSGID_IDIOM_0		Message-ID =~ /\b[a-f\d]{8}/
header __MSGID_IDIOM_1		Message-ID =~ /\b[a-f\d]{8}\b/
header __MSGID_IDIOM_2		Message-ID =~ /\b[a-f\d]{12}\b/
header __MSGID_IDIOM_3		Message-ID =~ /\d{8}/
header __MSGID_IDIOM_4		Message-ID =~ /\d{10}/
header __MSGID_IDIOM_5		Message-ID =~ /\b\d{8}/
meta T_MSGID_EVIL_1	(__MSGID_ESPAM && !__MSGID_IDIOM_0)
meta T_MSGID_EVIL_2	(__MSGID_ESPAM && !__MSGID_IDIOM_1)
meta T_MSGID_EVIL_3	(__MSGID_ESPAM && !__MSGID_IDIOM_2)
meta T_MSGID_EVIL_4	(__MSGID_ESPAM && !__MSGID_IDIOM_0 && !__MSGID_IDIOM_3)
meta T_MSGID_EVIL_5	(__MSGID_ESPAM && !__MSGID_IDIOM_0 && !__MSGID_IDIOM_4)
meta T_MSGID_EVIL_6	(__MSGID_ESPAM && !__MSGID_IDIOM_0 && !__MSGID_IDIOM_5)
meta T_MSGID_EVIL_7	(__MSGID_ESPAM && !__MSGID_IDIOM_1 && !__MSGID_IDIOM_3)
meta T_MSGID_EVIL_8	(__MSGID_ESPAM && !__MSGID_IDIOM_1 && !__MSGID_IDIOM_4)
meta T_MSGID_EVIL_9	(__MSGID_ESPAM && !__MSGID_IDIOM_1 && !__MSGID_IDIOM_5)
meta T_MSGID_EVIL_10	(__MSGID_ESPAM && !__MSGID_IDIOM_2 && !__MSGID_IDIOM_3)
meta T_MSGID_EVIL_11	(__MSGID_ESPAM && !__MSGID_IDIOM_2 && !__MSGID_IDIOM_4)
meta T_MSGID_EVIL_12	(__MSGID_ESPAM && !__MSGID_IDIOM_2 && !__MSGID_IDIOM_5)

# some simple subject rules to catch a persistent spammer
header T_SUBJ_XANAX		Subject =~ /x.{0,2}a.{0,2}n.{0,2}a.{0,2}x/i
header T_SUBJ_VALIUM		Subject =~ /v.{0,2}a.{0,2}l.{0,2}i.{0,2}u.{0,2}m/i
header T_SUBJ_VIAGRA		Subject =~ /v.{0,2}i.{0,2}a.{0,2}g.{0,2}r.{0,2}a/i
header T_SUBJ_VICODIN		Subject =~ /v.{0,2}i.{0,2}c.{0,6}d.{0,2}i.{0,2}n/i
header T_SUBJ_SOMA		Subject =~ /s.{0,2}o.{0,2}m.{0,2}a/i
header T_SUBJ_PHENTER		Subject =~ /p.{0,2}h.{0,6}t.{0,2}e.{0,2}r.{0,2}m/i

# No legit mailer claims that their mailserver has no name.
# However, one build of the T_MSGID_EVIL_SPAM_1 ratware does.
header T_RCVD_BY_IP	Received =~ /from \S+ \[\S+\] by [0-9\.]+ with ESMTP id/

# this ratware forges dates in 2002!  Also a T_MSGID_EVIL_SPAM_1
# variant
header T_RCVD_ESMTP_IN_TIMEWARP	Received =~ /with ESMTP id <\d+-\d+>; \S\S\S, *\d+ \S\S\S 2002 \d\d:\d\d:\d\d [-+]/

# partial messages; currently-theoretical attack
header T_FRAGMENTED_MESSAGE	Content-Type =~ /message\/partial/i

# affiliateid, aff_id, aff_sub_id etc.
uri T_URI_AFFILIATE		/aff\w+id=/i

body T_DEEP_DISC_MEDS		/\bdeep discount med(?:s|ications)\b/i

# Al Iverson reports: "forged, now no longer in use"
header T_REGSOFT        Received =~ /hd\.regsoft\.net/i

# same ratware; forges dates as 'with SMTP; Jan, 17 2004 22:05:48 -0300'
header T_DATE_COMMA     Received =~ /\bwith \S+\; [A-Z][a-z][a-z],\s+\d\d\s+\d\d\d\d\s/

########################################################################
# slew of HTML order rules
#
# these were originally autogenerated some months ago by dumping HTML
# tag orders for spam and ham, but the dumps were not separated by
# message, so some good rules may have been missed

body T_RANGE_100_110	eval:html_order('range', '100', '110')
body T_RANGE_110_120	eval:html_order('range', '110', '120')
body T_RANGE_120_130	eval:html_order('range', '120', '130')
body T_RANGE_130_140	eval:html_order('range', '130', '140')
body T_RANGE_140_150	eval:html_order('range', '140', '150')
body T_RANGE_150_160	eval:html_order('range', '150', '160')
body T_RANGE_160_170	eval:html_order('range', '160', '170')
body T_RANGE_170_180	eval:html_order('range', '170', '180')
body T_RANGE_180_190	eval:html_order('range', '180', '190')
body T_RANGE_190_200	eval:html_order('range', '190', '200')
body T_RANGE_200_210	eval:html_order('range', '200', '210')
body T_RANGE_210_220	eval:html_order('range', '210', '220')
body T_RANGE_220_230	eval:html_order('range', '220', '230')
body T_RANGE_230_240	eval:html_order('range', '230', '240')
body T_RANGE_240_250	eval:html_order('range', '240', '250')
body T_RANGE_250_260	eval:html_order('range', '250', '260')
body T_RANGE_260_270	eval:html_order('range', '260', '270')
body T_RANGE_270_280	eval:html_order('range', '270', '280')
body T_RANGE_280_290	eval:html_order('range', '280', '290')
body T_RANGE_290_300	eval:html_order('range', '290', '300')

body T_ANY_0A_BR	eval:html_order('any', 'br', '/a')
body T_ANY_0BODY_0HTML	eval:html_order('any', '/html', '/body')
body T_ANY_0CENTER_0FONT	eval:html_order('any', '/center', '/font')
body T_ANY_0CENTER_0FONT	eval:html_order('any', '/font', '/center')
body T_ANY_0CENTER_0P	eval:html_order('any', '/center', '/p')
body T_ANY_0CENTER_BR	eval:html_order('any', 'br', '/center')
body T_ANY_0CENTER_IMG	eval:html_order('any', '/center', 'img')
body T_ANY_0CENTER_IMG	eval:html_order('any', 'img', '/center')
body T_ANY_0DIV_IMG	eval:html_order('any', '/div', 'img')
body T_ANY_0DIV_IMG	eval:html_order('any', 'img', '/div')
body T_ANY_0FONT_0CENTER	eval:html_order('any', '/center', '/font')
body T_ANY_0FONT_0CENTER	eval:html_order('any', '/font', '/center')
body T_ANY_0HTML_0BODY	eval:html_order('any', '/body', '/html')
body T_ANY_0HTML_0BODY	eval:html_order('any', '/html', '/body')
body T_ANY_0P_0CENTER	eval:html_order('any', '/center', '/p')
body T_ANY_0P_0P	eval:html_order('any', '/p', '/p')
body T_ANY_0TABLE_0CENTER	eval:html_order('any', '/center', '/table')
body T_ANY_0TABLE_0CENTER	eval:html_order('any', '/table', '/center')
body T_ANY_BODY_A	eval:html_order('any', 'a', 'body')
body T_ANY_BODY_A	eval:html_order('any', 'body', 'a')
body T_ANY_BR_0A	eval:html_order('any', '/a', 'br')
body T_ANY_BR_0A	eval:html_order('any', 'br', '/a')
body T_ANY_BR_0CENTER	eval:html_order('any', '/center', 'br')
body T_ANY_BR_0CENTER	eval:html_order('any', 'br', '/center')
body T_ANY_BR_A	eval:html_order('any', 'a', 'br')
body T_ANY_B_A	eval:html_order('any', 'a', 'b')
body T_ANY_B_CENTER	eval:html_order('any', 'b', 'center')
body T_ANY_B_CENTER	eval:html_order('any', 'center', 'b')
body T_ANY_CENTER_A	eval:html_order('any', 'a', 'center')
body T_ANY_CENTER_A	eval:html_order('any', 'center', 'a')
body T_ANY_CENTER_B	eval:html_order('any', 'b', 'center')
body T_ANY_CENTER_B	eval:html_order('any', 'center', 'b')
body T_ANY_CENTER_DIV	eval:html_order('any', 'center', 'div')
body T_ANY_CENTER_DIV	eval:html_order('any', 'div', 'center')
body T_ANY_CENTER_FONT	eval:html_order('any', 'center', 'font')
body T_ANY_CENTER_FONT	eval:html_order('any', 'font', 'center')
body T_ANY_DIV_CENTER	eval:html_order('any', 'center', 'div')
body T_ANY_DIV_CENTER	eval:html_order('any', 'div', 'center')
body T_ANY_FONT_CENTER	eval:html_order('any', 'center', 'font')
body T_ANY_FONT_CENTER	eval:html_order('any', 'font', 'center')
body T_ANY_HTML_CENTER	eval:html_order('any', 'center', 'html')
body T_ANY_HTML_CENTER	eval:html_order('any', 'html', 'center')
body T_ANY_IMG_0CENTER	eval:html_order('any', '/center', 'img')
body T_ANY_IMG_0CENTER	eval:html_order('any', 'img', '/center')
body T_ANY_IMG_0DIV	eval:html_order('any', '/div', 'img')
body T_ANY_IMG_0DIV	eval:html_order('any', 'img', '/div')
body T_ANY_P_B	eval:html_order('any', 'b', 'p')
body T_ANY_UNDEF_BODY	eval:html_order('any', 'body', 'undef')
body T_ANY_UNDEF_BODY	eval:html_order('any', 'undef', 'body')

body T_CLOSE_0A_0CENTER	eval:html_order('any', '/a', '/center')
body T_CLOSE_0A_0CENTER	eval:html_order('close', '/center', '/a')
body T_CLOSE_0BODY_0HTML	eval:html_order('close', '/html', '/body')
body T_CLOSE_0CENTER_0A	eval:html_order('any', '/center', '/a')
body T_CLOSE_0CENTER_0A	eval:html_order('close', '/a', '/center')
body T_CLOSE_0CENTER_0FONT	eval:html_order('any', '/center', '/font')
body T_CLOSE_0CENTER_0FONT	eval:html_order('close', '/font', '/center')
body T_CLOSE_0CENTER_0P	eval:html_order('any', '/center', '/p')
body T_CLOSE_0CENTER_0P	eval:html_order('close', '/center', '/p')
body T_CLOSE_0CENTER_0P	eval:html_order('close', '/p', '/center')
body T_CLOSE_0FONT_0CENTER	eval:html_order('any', '/font', '/center')
body T_CLOSE_0FONT_0CENTER	eval:html_order('close', '/center', '/font')
body T_CLOSE_0P_0CENTER	eval:html_order('close', '/center', '/p')

body T_IGNORE_A_BODY	eval:html_order('ignore', 'body', 'a')
body T_IGNORE_A_CENTER	eval:html_order('ignore', 'a', 'center')
body T_IGNORE_A_CENTER	eval:html_order('ignore', 'center', 'a')
body T_IGNORE_A_P	eval:html_order('ignore', 'p', 'a')
body T_IGNORE_BODY_A	eval:html_order('ignore', 'a', 'body')
body T_IGNORE_BODY_A	eval:html_order('ignore', 'body', 'a')
body T_IGNORE_BODY_CENTER	eval:html_order('ignore', 'center', 'body')
body T_IGNORE_BODY_HTML	eval:html_order('ignore', 'html', 'body')
body T_IGNORE_B_CENTER	eval:html_order('ignore', 'b', 'center')
body T_IGNORE_B_CENTER	eval:html_order('ignore', 'center', 'b')
body T_IGNORE_CENTER_A	eval:html_order('ignore', 'a', 'center')
body T_IGNORE_CENTER_A	eval:html_order('ignore', 'center', 'a')
body T_IGNORE_CENTER_B	eval:html_order('ignore', 'b', 'center')
body T_IGNORE_CENTER_B	eval:html_order('ignore', 'center', 'b')
body T_IGNORE_CENTER_BODY	eval:html_order('ignore', 'body', 'center')
body T_IGNORE_CENTER_BR	eval:html_order('ignore', 'br', 'center')
body T_IGNORE_CENTER_DIV	eval:html_order('ignore', 'center', 'div')
body T_IGNORE_CENTER_DIV	eval:html_order('ignore', 'div', 'center')
body T_IGNORE_CENTER_FONT	eval:html_order('ignore', 'center', 'font')
body T_IGNORE_CENTER_FONT	eval:html_order('ignore', 'font', 'center')
body T_IGNORE_CENTER_HTML	eval:html_order('ignore', 'center', 'html')
body T_IGNORE_CENTER_HTML	eval:html_order('ignore', 'html', 'center')
body T_IGNORE_CENTER_IMG	eval:html_order('ignore', 'center', 'img')
body T_IGNORE_CENTER_IMG	eval:html_order('ignore', 'img', 'center')
body T_IGNORE_CENTER_P	eval:html_order('ignore', 'p', 'center')
body T_IGNORE_CENTER_TABLE	eval:html_order('ignore', 'center', 'table')
body T_IGNORE_CENTER_TABLE	eval:html_order('ignore', 'table', 'center')
body T_IGNORE_DIV_CENTER	eval:html_order('ignore', 'center', 'div')
body T_IGNORE_DIV_CENTER	eval:html_order('ignore', 'div', 'center')
body T_IGNORE_DIV_IMG	eval:html_order('ignore', 'div', 'img')
body T_IGNORE_DIV_IMG	eval:html_order('ignore', 'img', 'div')
body T_IGNORE_FONT_CENTER	eval:html_order('ignore', 'center', 'font')
body T_IGNORE_FONT_CENTER	eval:html_order('ignore', 'font', 'center')
body T_IGNORE_FONT_TABLE	eval:html_order('ignore', 'table', 'font')
body T_IGNORE_HTML_CENTER	eval:html_order('ignore', 'center', 'html')
body T_IGNORE_HTML_CENTER	eval:html_order('ignore', 'html', 'center')
body T_IGNORE_IMG_CENTER	eval:html_order('ignore', 'center', 'img')
body T_IGNORE_IMG_CENTER	eval:html_order('ignore', 'img', 'center')
body T_IGNORE_IMG_DIV	eval:html_order('ignore', 'div', 'img')
body T_IGNORE_IMG_DIV	eval:html_order('ignore', 'img', 'div')
body T_IGNORE_P_CENTER	eval:html_order('ignore', 'center', 'p')
body T_IGNORE_TABLE_CENTER	eval:html_order('ignore', 'center', 'table')
body T_IGNORE_TABLE_CENTER	eval:html_order('ignore', 'table', 'center')
body T_IGNORE_TABLE_FONT	eval:html_order('ignore', 'font', 'table')
body T_IGNORE_TABLE_FONT	eval:html_order('ignore', 'table', 'font')
body T_IGNORE_TD_CENTER	eval:html_order('ignore', 'center', 'td')
body T_IGNORE_UNDEF_BODY	eval:html_order('ignore', 'body', 'undef')
body T_IGNORE_UNDEF_BODY	eval:html_order('ignore', 'undef', 'body')

body T_OPEN_A_CENTER	eval:html_order('open', 'center', 'a')
body T_OPEN_BODY_A	eval:html_order('any', 'body', 'a')
body T_OPEN_BODY_A	eval:html_order('open', 'a', 'body')
body T_OPEN_BODY_A	eval:html_order('open', 'body', 'a')
body T_OPEN_B_CENTER	eval:html_order('any', 'b', 'center')
body T_OPEN_B_CENTER	eval:html_order('open', 'center', 'b')
body T_OPEN_CENTER_BR	eval:html_order('open', 'br', 'center')
body T_OPEN_CENTER_DIV	eval:html_order('open', 'div', 'center')
body T_OPEN_CENTER_FONT	eval:html_order('any', 'center', 'font')
body T_OPEN_CENTER_FONT	eval:html_order('open', 'font', 'center')
body T_OPEN_CENTER_IMG	eval:html_order('any', 'center', 'img')
body T_OPEN_CENTER_IMG	eval:html_order('open', 'center', 'img')
body T_OPEN_CENTER_IMG	eval:html_order('open', 'img', 'center')
body T_OPEN_CENTER_P	eval:html_order('open', 'p', 'center')
body T_OPEN_HTML_CENTER	eval:html_order('any', 'html', 'center')
body T_OPEN_HTML_CENTER	eval:html_order('open', 'center', 'html')
body T_OPEN_HTML_CENTER	eval:html_order('open', 'html', 'center')
body T_OPEN_IMG_CENTER	eval:html_order('any', 'img', 'center')
body T_OPEN_IMG_CENTER	eval:html_order('open', 'center', 'img')
body T_OPEN_IMG_CENTER	eval:html_order('open', 'img', 'center')
body T_OPEN_IMG_DIV	eval:html_order('open', 'div', 'img')
body T_OPEN_IMG_FONT	eval:html_order('open', 'font', 'img')
body T_OPEN_INPUT_P	eval:html_order('any', 'input', 'p')
body T_OPEN_INPUT_P	eval:html_order('open', 'p', 'input')
body T_OPEN_P_CENTER	eval:html_order('any', 'p', 'center')
body T_OPEN_P_CENTER	eval:html_order('open', 'center', 'p')
body T_OPEN_P_INPUT	eval:html_order('open', 'input', 'p')
body T_OPEN_P_STRONG	eval:html_order('open', 'strong', 'p')
body T_OPEN_UNDEF_BODY	eval:html_order('open', 'body', 'undef')
body T_OPEN_UNDEF_BODY	eval:html_order('open', 'undef', 'body')

########################################################################

body T_HTML_LINK_UNCLICKABLE	eval:html_test('anchor_unclickable')
describe T_HTML_LINK_UNCLICKABLE	HTML link is not clickable
