# SpamAssassin rules file: rules under test, $Rev$
#
# This file is a placeholder for rules "under probation", ie. checked into
# SVN for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# <@LICENSE>
# Copyright 2004 Apache Software Foundation
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
########################################################################
# rules to detect certain generally unnecessary encodings in HTML

rawbody T_ENTITY_WHITESPACE_R	/\&\#(?:10|32)\;/
body T_ENTITY_WHITESPACE_B	/\&\#(?:10|32)\;/
meta T_ENTITY_WHITESPACE_M	(T_ENTITY_WHITESPACE_R || T_ENTITY_WHITESPACE_B)

rawbody T_ENTITY_ALPHANUM_R	/\&\#(?:4[89]|5[0-7]|6[5-9][78]\d|9[0789]|1[01]\d|12[012])\;/
body T_ENTITY_ALPHANUM_B	/\&\#(?:4[89]|5[0-7]|6[5-9][78]\d|9[0789]|1[01]\d|12[012])\;/
meta T_ENTITY_ALPHANUM_M	(T_ENTITY_ALPHANUM_R || T_ENTITY_ALPHANUM_B)

rawbody T_ENTITY_OTHER1_R	/\&\#(?:46|47)\;/
body T_ENTITY_OTHER1_B		/\&\#(?:46|47)\;/
meta T_ENTITY_OTHER1_M		(T_ENTITY_OTHER1_R || T_ENTITY_OTHER1_B)

rawbody T_ENTITY_OTHER2_R	/\&\#(?:33|39|40|46|47)\;/
body T_ENTITY_OTHER2_B		/\&\#(?:33|39|40|46|47)\;/
meta T_ENTITY_OTHER2_M		(T_ENTITY_OTHER2_R || T_ENTITY_OTHER2_B)

# similar concept for Delphi.com.  Was an ISP, now a car company!
# I think their username format is "First.Last"; requiring 2 digits
# will be pretty safe.  (lower rule as a baseline to see if we miss much)
header T_FROM_DELPHI		From:addr =~ /\d[^\@]+\d[^\@]+\@delphi\.com/i

# great Yahoo! forgery rule, but is it going to be stable?
# hmm.  good question :(
header __YAHOO_MSGID		Message-ID =~ /\@yahoo\.com>/i
header __YAHOO_BEGINNING	Message-ID =~ /<\S+(?:\.\S+|\.\S+\.\S+\.\S+)\@/
meta T_FORGED_YAHOO_MSGID	(__YAHOO_MSGID && !__YAHOO_BEGINNING)

header T_ALL_TRUSTED		eval:check_all_trusted()
describe T_ALL_TRUSTED		Did not pass through any untrusted hosts
tflags T_ALL_TRUSTED		nice

# reported by Kurtis Rader, bug 2890
uri T_MSN_REDIR		m{^https?://shopping\.msn\.com/trackurl\.aspx\?}i
describe T_MSN_REDIR	Has MSN Redirect URI

# reported by Kurtis Rader, bug 2901
# miniscule hits
uri T_AOL_REDIR_1	m{^https?://www\.aol\.com/ams/clickThruRedirect.adp\?}i
uri T_AOL_REDIR_2	m{^https?://www\.aol\.com/ams/}i
uri T_AOL_REDIR_3	m{^https?://www\.aol\.com/.*https?://}i
uri T_AOL_REDIR_4	m{^https?://www\.aol\.com/ams/.*https?://}i
#describe T_AOL_REDIR	Has AOL Redirect URI

# more portable replacement for RCVD_NUMERIC_HELO that doesn't rely on
# Received headers using "helo=" prefix
header T_RCVD_NUMERIC_HELO	X-Spam-Relays-Untrusted =~ / helo=\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3} /
describe T_RCVD_NUMERIC_HELO	Received: contains an IP address used for HELO
# same but not for first line
header T_RCVD_NUMERIC_HELO_NOTFIRST	X-Spam-Relays-Untrusted =~ / helo=\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3} .+\[/
describe T_RCVD_NUMERIC_HELO_NOTFIRST	Received: contains IP for HELO (not first line)

# If the Message-Id claims to be added by one ISP, there should be a Received
# header which mentions that ISP.
header __MSGID_HAS_HOTMAIL	MESSAGEID =~ /hotmail\.com/
header __RCVD_HAS_HOTMAIL	Received =~ /(?:hotmail|msn)\.com/
meta T_MID_RCVD_DIFF_HOTMAIL	(__MSGID_HAS_HOTMAIL && !__RCVD_HAS_HOTMAIL)
describe T_MID_RCVD_DIFF_HOTMAIL Message-Id does not match Received (hotmail.com)

header __MSGID_HAS_AOL	MESSAGEID =~ /aol\.com/
header __RCVD_HAS_AOL	Received =~ /aol\.com/
meta T_MID_RCVD_DIFF_AOL	(__MSGID_HAS_AOL && !__RCVD_HAS_AOL)
describe T_MID_RCVD_DIFF_AOL	Message-Id does not match Received (aol.com)

# 0.683   1.3791   0.0134    0.990   0.90    0.01  T_URI_UNPRINTABLE:quinlan
# 0.956   1.1479   0.5948    0.659   0.26    0.01  T_URI_UNPRINTABLE:rODbegbie
# 0.734   0.7756   0.0885    0.898   0.66    0.01  T_URI_UNPRINTABLE:theo
# FPs?  wierd
uri	T_URI_UNPRINTABLE	/%0/
describe T_URI_UNPRINTABLE	URI contains unprintable characters

# bug 2957
# really not sure if this is a good idea
uri T_INFO_TLD			/^(?:https?:\/\/|mailto:)[^\/]+\.info(?:\/|$)/i
describe T_INFO_TLD		Contains a URL in the INFO top-level domain    

header T_RCVD_IN_BOGUSMX	rbleval:check_rbl_from_host('rfci-bmx', 'bogusmx.rfc-ignorant.org.')
describe T_RCVD_IN_BOGUSMX	Received via a relay in BogusMX (rfc-ignorant.org)
tflags T_RCVD_IN_BOGUSMX	net

# bug 2071
body            T_GEVALIACOFFEE           /\bGevalia (?:Coffee|Kaffe)\b/i
describe        T_GEVALIACOFFEE           Selling Gevalia Coffee

# partial messages; currently-theoretical attack
# unsurprisingly this hits 0/0 right now.  But should we promote it anyway
# to protect against the possibility?
header T_FRAGMENTED_MESSAGE	Content-Type =~ /message\/partial/i

# some HTML rules to try
body T_HTML_FONT_SMALL_SIZE_1	eval:html_eval('min_size', '< 1')
body T_HTML_FONT_SMALL_SIZE_2	eval:html_eval('min_size', '< 0')
body T_HTML_FONT_SMALL_SIZE_3	eval:html_eval('min_size', '< -1')

# these look pretty good
body T_HTML_FONT_SIZE_BIG	eval:html_range('max_size', '4', '5')
body T_HTML_FONT_SIZE_LARGE	eval:html_range('max_size', '5', '6')
body T_HTML_FONT_SIZE_HUGE	eval:html_range('max_size', '6', 'inf')

########################################################################

# bug 1985
body T_BIZ_URGENT /urgent.{0,16}(?:assistance|business|buy|confidential|notice|proposal|reply|request|response)/i

# bug 2950
# both look promotable
# really?  low hit rates...
uri T_GOOGLE_IMAGES	m{^http://images\.google(\.\S+)?\.[a-z]{2,3}/imgres\?}i
uri T_GOOGLE_REDIR	m{^http://www\.google(\.\S+)?\.[a-z]{2,3}/url\?}i

# http://www.ahbl.org/using/spamassassin.txt :
# SpamAssassin local.cf for AHBL BlackList / BlockList
# "Old blackholes.2mbit.com resurrected as AHBL (dnsbl.ahbl.org)"
# URL: http://www.ahbl.org
# 0.000   0.0000   0.0000    0.500   0.11    0.00  __RCVD_IN_AHBL
header __RCVD_IN_AHBL eval:check_rbl('ahbl', 'dnsbl.ahbl.org.')
describe __RCVD_IN_AHBL AHBL: sender is in DNSbl dnsbl.ahbl.org
tflags __RCVD_IN_AHBL net

#  0.023   0.0315   0.0024    0.930   0.71    0.01  T_RCVD_IN_AHBL_UNKNOWN_1
header T_RCVD_IN_AHBL_UNKNOWN_1 eval:check_rbl_sub('ahbl', '127.0.0.1')
describe T_RCVD_IN_AHBL_UNKNOWN_1 AHBL: Unknown Category 1 (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_UNKNOWN_1 net

#  0.002   0.0029   0.0000    1.000   0.89    0.01  T_RCVD_IN_AHBL_SMTP
header T_RCVD_IN_AHBL_SMTP eval:check_rbl_sub('ahbl', '127.0.0.2')
describe T_RCVD_IN_AHBL_SMTP AHBL: Open SMTP relay (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_SMTP net

# 12.154  17.1401   0.0951    0.994   0.90    0.01  T_RCVD_IN_AHBL_PROXY
header T_RCVD_IN_AHBL_PROXY eval:check_rbl_sub('ahbl', '127.0.0.3')
describe T_RCVD_IN_AHBL_PROXY AHBL: Open Proxy server (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_PROXY net

# 3.956   5.5534   0.0927    0.984   0.85    0.01  T_RCVD_IN_AHBL_SPAM
# jm: -1
header T_RCVD_IN_AHBL_SPAM eval:check_rbl_sub('ahbl', '127.0.0.4')
describe T_RCVD_IN_AHBL_SPAM AHBL: Spam Source (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_SPAM net

# these are all 0 or not so good:
header T_RCVD_IN_AHBL_RTB eval:check_rbl_sub('ahbl', '127.0.0.5')
describe T_RCVD_IN_AHBL_RTB AHBL: Real-Time Blocked (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_RTB net

header T_RCVD_IN_AHBL_FORMMAIL eval:check_rbl_sub('ahbl', '127.0.0.6')
describe T_RCVD_IN_AHBL_FORMMAIL AHBL: Abuseable Form Mail (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_FORMMAIL net

header T_RCVD_IN_AHBL_SPAM_SUPPORT eval:check_rbl_sub('ahbl', '127.0.0.7')
describe T_RCVD_IN_AHBL_SPAM_SUPPORT AHBL: Spam Supporter (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_SPAM_SUPPORT net

header T_RCVD_IN_AHBL_I_SPAM_SUPPORT eval:check_rbl_sub('ahbl', '127.0.0.8')
describe T_RCVD_IN_AHBL_I_SPAM_SUPPORT AHBL: Indirect Spam supporter (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_I_SPAM_SUPPORT net

header T_RCVD_IN_AHBL_ENDUSER eval:check_rbl_sub('ahbl', '127.0.0.9')
describe T_RCVD_IN_AHBL_ENDUSER AHBL: End User listed (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_ENDUSER net

header T_RCVD_IN_AHBL_SOS eval:check_rbl_sub('AHBL-notfirsthop', '127.0.0.10')
describe T_RCVD_IN_AHBL_SOS AHBL: Shoot On Sight (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_SOS net

header T_RCVD_IN_AHBL_RFCI_PA eval:check_rbl_sub('ahbl', '127.0.0.11')
describe T_RCVD_IN_AHBL_RFCI_PA AHBL: No Postmaster/Abuse Address (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_RFCI_PA net

header T_RCVD_IN_AHBL_5XXI eval:check_rbl_sub('ahbl', '127.0.0.12')
describe T_RCVD_IN_AHBL_5XXI AHBL: Spurious 5xx error handling (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_5XXI net

header T_RCVD_IN_AHBL_RFCI_MISC eval:check_rbl_sub('ahbl', '127.0.0.13')
describe T_RCVD_IN_AHBL_RFCI_MISC AHBL: Other Non-RFC Compliant (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_RFCI_MISC net

header T_RCVD_IN_AHBL_CMPR_DDOS eval:check_rbl_sub('ahbl', '127.0.0.14')
describe T_RCVD_IN_AHBL_CMPR_DDOS AHBL: Compromised - DDoS (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_CMPR_DDOS net

header T_RCVD_IN_AHBL_CMPR_RELAY eval:check_rbl_sub('ahbl', '127.0.0.15')
describe T_RCVD_IN_AHBL_CMPR_RELAY AHBL: Compromised - Relay (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_CMPR_RELAY net

header T_RCVD_IN_AHBL_CMPR_SCAN eval:check_rbl_sub('ahbl', '127.0.0.16')
describe T_RCVD_IN_AHBL_CMPR_SCAN AHBL: Compromised - Autorooter/Scanner
tflags T_RCVD_IN_AHBL_CMPR_SCAN net

header T_RCVD_IN_AHBL_CMPR_WORM eval:check_rbl_sub('ahbl', '127.0.0.17')
describe T_RCVD_IN_AHBL_CMPR_WORM AHBL: Compromised - Worm or mass mailing virus
tflags T_RCVD_IN_AHBL_CMPR_WORM net

header T_RCVD_IN_AHBL_CMPR_VIRUS eval:check_rbl_sub('ahbl', '127.0.0.18')
describe T_RCVD_IN_AHBL_CMPR_VIRUS AHBL: Compromised - Other virus
tflags T_RCVD_IN_AHBL_CMPR_VIRUS net

header T_RCVD_IN_AHBL_OTHER eval:check_rbl_sub('ahbl', '127.0.0.127')
describe T_RCVD_IN_AHBL_OTHER AHBL: Other (dnsbl.ahbl.org)
tflags T_RCVD_IN_AHBL_OTHER net

# not so useful
# 0.873   0.1278   2.6753    0.046   0.78   -0.01  T_RCVD_IN_AHBL_EXEMPT_T
header T_RCVD_IN_AHBL_EXEMPT_T	eval:check_rbl('ahbl-ex-firsttrusted', 'exemptions.ahbl.org.')
describe T_RCVD_IN_AHBL_EXEMPT_T AHBL: Sender is in Exempt zone (trusted)
tflags T_RCVD_IN_AHBL_EXEMPT_T	net nice

# 0.489   0.0600   1.5267    0.038   0.79   -0.01  T_RCVD_IN_AHBL_EXEMPT_O
header T_RCVD_IN_AHBL_EXEMPT_O	eval:check_rbl('ahbl-ex-untrusted', 'exemptions.ahbl.org.')
describe T_RCVD_IN_AHBL_EXEMPT_O AHBL: Sender is in Exempt zone (other)
tflags T_RCVD_IN_AHBL_EXEMPT_O	net nice

# 5.877   8.1040   0.4899    0.943   0.76    0.01  T_RCVD_IN_AHBL_RHSBL
# jm: -1
header T_RCVD_IN_AHBL_RHSBL	eval:check_rbl_from_host('ahbl-rhs', 'rhsbl.ahbl.org.')
describe T_RCVD_IN_AHBL_RHSBL	AHBL: From sender in DNSbl dnsbl.ahbl.org
tflags T_RCVD_IN_AHBL_RHSBL	net

# Should catch Atriks, for one
uri T_LONG_HOSTNAME_25		/^https?:\/\/[a-z0-9]{25,29}\./i
uri T_LONG_HOSTNAME_30		/^https?:\/\/[a-z0-9]{30,40}\./i
uri T_LONG_HOSTNAME_40		/^https?:\/\/[a-z0-9]{40,}\./i

# bug 2220
meta T_DIGEST_MULTIPLE		RAZOR2_CHECK + DCC_CHECK + PYZOR_CHECK > 1
describe T_DIGEST_MULTIPLE	Message hits more than one network digest check
tflags T_DIGEST_MULTIPLE	net

# too easy
body T_VIA_GAP_GRA		/\bvia.gra\b/i

# backhair - idea from backhair set by Jennifer Wheeler and Adam Lopresto.
body T_BACKHAIR_1_1		eval:html_test('backhair_1_1')
body T_BACKHAIR_1_2		eval:html_test('backhair_1_2')
body T_BACKHAIR_1_3		eval:html_test('backhair_1_3')
body T_BACKHAIR_1_4		eval:html_test('backhair_1_4')
body T_BACKHAIR_1_5		eval:html_test('backhair_1_5')
body T_BACKHAIR_1_6		eval:html_test('backhair_1_6')
body T_BACKHAIR_1_7		eval:html_test('backhair_1_7')
body T_BACKHAIR_2_1		eval:html_test('backhair_2_1')
body T_BACKHAIR_2_2		eval:html_test('backhair_2_2')
body T_BACKHAIR_2_3		eval:html_test('backhair_2_3')
body T_BACKHAIR_2_4		eval:html_test('backhair_2_4')
body T_BACKHAIR_2_5		eval:html_test('backhair_2_5')
body T_BACKHAIR_2_6		eval:html_test('backhair_2_6')
body T_BACKHAIR_2_7		eval:html_test('backhair_2_7')
body T_BACKHAIR_3_1		eval:html_test('backhair_3_1')
body T_BACKHAIR_3_2		eval:html_test('backhair_3_2')
body T_BACKHAIR_3_3		eval:html_test('backhair_3_3')
body T_BACKHAIR_3_4		eval:html_test('backhair_3_4')
body T_BACKHAIR_3_5		eval:html_test('backhair_3_5')
body T_BACKHAIR_3_6		eval:html_test('backhair_3_6')
body T_BACKHAIR_3_7		eval:html_test('backhair_3_7')
body T_BACKHAIR_4_1		eval:html_test('backhair_4_1')
body T_BACKHAIR_4_2		eval:html_test('backhair_4_2')
body T_BACKHAIR_4_3		eval:html_test('backhair_4_3')
body T_BACKHAIR_4_4		eval:html_test('backhair_4_4')
body T_BACKHAIR_4_5		eval:html_test('backhair_4_5')
body T_BACKHAIR_4_6		eval:html_test('backhair_4_6')
body T_BACKHAIR_4_7		eval:html_test('backhair_4_7')
body T_BACKHAIR_5_1		eval:html_test('backhair_5_1')
body T_BACKHAIR_5_2		eval:html_test('backhair_5_2')
body T_BACKHAIR_5_3		eval:html_test('backhair_5_3')
body T_BACKHAIR_5_4		eval:html_test('backhair_5_4')
body T_BACKHAIR_5_5		eval:html_test('backhair_5_5')
body T_BACKHAIR_5_6		eval:html_test('backhair_5_6')
body T_BACKHAIR_5_7		eval:html_test('backhair_5_7')
body T_BACKHAIR_6_1		eval:html_test('backhair_6_1')
body T_BACKHAIR_6_2		eval:html_test('backhair_6_2')
body T_BACKHAIR_6_3		eval:html_test('backhair_6_3')
body T_BACKHAIR_6_4		eval:html_test('backhair_6_4')
body T_BACKHAIR_6_5		eval:html_test('backhair_6_5')
body T_BACKHAIR_6_6		eval:html_test('backhair_6_6')
body T_BACKHAIR_6_7		eval:html_test('backhair_6_7')
body T_BACKHAIR_7_1		eval:html_test('backhair_7_1')
body T_BACKHAIR_7_2		eval:html_test('backhair_7_2')
body T_BACKHAIR_7_3		eval:html_test('backhair_7_3')
body T_BACKHAIR_7_4		eval:html_test('backhair_7_4')
body T_BACKHAIR_7_5		eval:html_test('backhair_7_5')
body T_BACKHAIR_7_6		eval:html_test('backhair_7_6')
body T_BACKHAIR_7_7		eval:html_test('backhair_7_7')

# spams that are assembled from a Javascript array
# look for the XOR op
rawbody __JS_FROMCHARCODE	/String\.fromCharCode\s*\(\s*\S+\s*\[\s*\S+\s*\]\s*\^/
rawbody __JS_DOCWRITE   	/document\.write/
meta T_JS_FROMCHARCODE          (__JS_FROMCHARCODE && __JS_DOCWRITE)

# IADB
header __RCVD_IN_IADB		eval:check_rbl('iadb', 'iadb.isipp.com.')
tflags __RCVD_IN_IADB		net nice

header T_RCVD_IN_IADB_LIST	eval:check_rbl_sub('iadb', '127.0.0.1')
describe T_RCVD_IN_IADB_LIST	Sender is listed in ISIPP IADB
tflags T_RCVD_IN_IADB_LIST	net nice

# IADB trusted
header __RCVD_IN_IADB_T		eval:check_rbl('iadbt-firsttrusted', 'iadb.isipp.com.')
tflags __RCVD_IN_IADB_T		net nice

header T_RCVD_IN_IADB_LIST_T	eval:check_rbl_sub('iadbtr', '127.0.0.1')
describe T_RCVD_IN_IADB_LIST_T	Sender is listed in ISIPP IADB
tflags T_RCVD_IN_IADB_LIST_T	net nice

# Bug 2168
header T_BAD_MOZILLA_VERSION    User-Agent =~ /Mozilla\/5\.0\d\d/
describe T_BAD_MOZILLA_VERSION  User-Agent claims to be Mozilla, but is malformed

header T_RCVD_ILLEGAL_IP    Received =~ /[\s\(\[\:\=](?:(?:[01257]|22[3-9]|23[0-9]|24[0-9]|25[0-5])\.\d+\.\d+\.\d+|127\.[1-9]\.\d+\.\d+|127\.0\.[1-9]\.\d+|127\.0\.0\.(?:\d\d+|[2-9]))\b/
describe T_RCVD_ILLEGAL_IP  Received contains illegal IP address

header T_SUBJ_2_NUM_PARENS      Subject =~ /^\(\d+\).*\(\d+\)\s*$/
describe T_SUBJ_2_NUM_PARENS    Subject contains common spam sign (2 numbers)

# some SenderBase tests
header __SENDERBASE		eval:check_rbl_txt('senderbase', 'sa.senderbase.org.')

# S23 = domain daily magnitude
# S25 = date of first message from this domain
header T_SB_23_5_0_25_10 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 10*86400)')
header T_SB_23_5_0_25_20 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 20*86400)')
header T_SB_23_5_0_25_30 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 30*86400)')
header T_SB_23_5_0_25_40 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 40*86400)')
header T_SB_23_5_0_25_50 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 50*86400)')
header T_SB_23_5_0_25_60 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 60*86400)')
header T_SB_23_5_0_25_90 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 90*86400)')
header T_SB_23_5_0_25_120 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 120*86400)')
header T_SB_23_5_0_25_180 eval:check_rbl_sub('senderbase', 'S23 > 5.0 && (time - S25 < 180*86400)')
header T_SB_23_5_2_25_10 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 10*86400)')
header T_SB_23_5_2_25_20 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 20*86400)')
header T_SB_23_5_2_25_30 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 30*86400)')
header T_SB_23_5_2_25_40 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 40*86400)')
header T_SB_23_5_2_25_50 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 50*86400)')
header T_SB_23_5_2_25_60 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 60*86400)')
header T_SB_23_5_2_25_90 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 90*86400)')
header T_SB_23_5_2_25_120 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 120*86400)')
header T_SB_23_5_2_25_180 eval:check_rbl_sub('senderbase', 'S23 > 5.2 && (time - S25 < 180*86400)')
header T_SB_23_5_4_25_10 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 10*86400)')
header T_SB_23_5_4_25_20 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 20*86400)')
header T_SB_23_5_4_25_30 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 30*86400)')
header T_SB_23_5_4_25_40 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 40*86400)')
header T_SB_23_5_4_25_50 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 50*86400)')
header T_SB_23_5_4_25_60 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 60*86400)')
header T_SB_23_5_4_25_90 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 90*86400)')
header T_SB_23_5_4_25_120 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 120*86400)')
header T_SB_23_5_4_25_180 eval:check_rbl_sub('senderbase', 'S23 > 5.4 && (time - S25 < 180*86400)')
header T_SB_23_5_6_25_10 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 10*86400)')
header T_SB_23_5_6_25_20 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 20*86400)')
header T_SB_23_5_6_25_30 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 30*86400)')
header T_SB_23_5_6_25_40 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 40*86400)')
header T_SB_23_5_6_25_50 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 50*86400)')
header T_SB_23_5_6_25_60 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 60*86400)')
header T_SB_23_5_6_25_90 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 90*86400)')
header T_SB_23_5_6_25_120 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 120*86400)')
header T_SB_23_5_6_25_180 eval:check_rbl_sub('senderbase', 'S23 > 5.6 && (time - S25 < 180*86400)')
header T_SB_23_5_8_25_10 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 10*86400)')
header T_SB_23_5_8_25_20 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 20*86400)')
header T_SB_23_5_8_25_30 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 30*86400)')
header T_SB_23_5_8_25_40 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 40*86400)')
header T_SB_23_5_8_25_50 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 50*86400)')
header T_SB_23_5_8_25_60 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 60*86400)')
header T_SB_23_5_8_25_90 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 90*86400)')
header T_SB_23_5_8_25_120 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 120*86400)')
header T_SB_23_5_8_25_180 eval:check_rbl_sub('senderbase', 'S23 > 5.8 && (time - S25 < 180*86400)')
header T_SB_23_6_0_25_10 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 10*86400)')
header T_SB_23_6_0_25_20 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 20*86400)')
header T_SB_23_6_0_25_30 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 30*86400)')
header T_SB_23_6_0_25_40 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 40*86400)')
header T_SB_23_6_0_25_50 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 50*86400)')
header T_SB_23_6_0_25_60 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 60*86400)')
header T_SB_23_6_0_25_90 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 90*86400)')
header T_SB_23_6_0_25_120 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 120*86400)')
header T_SB_23_6_0_25_180 eval:check_rbl_sub('senderbase', 'S23 > 6.0 && (time - S25 < 180*86400)')
header T_SB_23_6_2_25_10 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 10*86400)')
header T_SB_23_6_2_25_20 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 20*86400)')
header T_SB_23_6_2_25_30 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 30*86400)')
header T_SB_23_6_2_25_40 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 40*86400)')
header T_SB_23_6_2_25_50 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 50*86400)')
header T_SB_23_6_2_25_60 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 60*86400)')
header T_SB_23_6_2_25_90 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 90*86400)')
header T_SB_23_6_2_25_120 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 120*86400)')
header T_SB_23_6_2_25_180 eval:check_rbl_sub('senderbase', 'S23 > 6.2 && (time - S25 < 180*86400)')
header T_SB_23_6_4_25_10 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 10*86400)')
header T_SB_23_6_4_25_20 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 20*86400)')
header T_SB_23_6_4_25_30 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 30*86400)')
header T_SB_23_6_4_25_40 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 40*86400)')
header T_SB_23_6_4_25_50 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 50*86400)')
header T_SB_23_6_4_25_60 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 60*86400)')
header T_SB_23_6_4_25_90 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 90*86400)')
header T_SB_23_6_4_25_120 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 120*86400)')
header T_SB_23_6_4_25_180 eval:check_rbl_sub('senderbase', 'S23 > 6.4 && (time - S25 < 180*86400)')
header T_SB_23_6_6_25_10 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 10*86400)')
header T_SB_23_6_6_25_20 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 20*86400)')
header T_SB_23_6_6_25_30 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 30*86400)')
header T_SB_23_6_6_25_40 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 40*86400)')
header T_SB_23_6_6_25_50 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 50*86400)')
header T_SB_23_6_6_25_60 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 60*86400)')
header T_SB_23_6_6_25_90 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 90*86400)')
header T_SB_23_6_6_25_120 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 120*86400)')
header T_SB_23_6_6_25_180 eval:check_rbl_sub('senderbase', 'S23 > 6.6 && (time - S25 < 180*86400)')
header T_SB_23_6_8_25_10 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 10*86400)')
header T_SB_23_6_8_25_20 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 20*86400)')
header T_SB_23_6_8_25_30 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 30*86400)')
header T_SB_23_6_8_25_40 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 40*86400)')
header T_SB_23_6_8_25_50 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 50*86400)')
header T_SB_23_6_8_25_60 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 60*86400)')
header T_SB_23_6_8_25_90 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 90*86400)')
header T_SB_23_6_8_25_120 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 120*86400)')
header T_SB_23_6_8_25_180 eval:check_rbl_sub('senderbase', 'S23 > 6.8 && (time - S25 < 180*86400)')
header T_SB_23_7_0_25_10 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 10*86400)')
header T_SB_23_7_0_25_20 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 20*86400)')
header T_SB_23_7_0_25_30 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 30*86400)')
header T_SB_23_7_0_25_40 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 40*86400)')
header T_SB_23_7_0_25_50 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 50*86400)')
header T_SB_23_7_0_25_60 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 60*86400)')
header T_SB_23_7_0_25_90 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 90*86400)')
header T_SB_23_7_0_25_120 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 120*86400)')
header T_SB_23_7_0_25_180 eval:check_rbl_sub('senderbase', 'S23 > 7.0 && (time - S25 < 180*86400)')
header T_SB_23_7_2_25_10 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 10*86400)')
header T_SB_23_7_2_25_20 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 20*86400)')
header T_SB_23_7_2_25_30 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 30*86400)')
header T_SB_23_7_2_25_40 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 40*86400)')
header T_SB_23_7_2_25_50 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 50*86400)')
header T_SB_23_7_2_25_60 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 60*86400)')
header T_SB_23_7_2_25_90 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 90*86400)')
header T_SB_23_7_2_25_120 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 120*86400)')
header T_SB_23_7_2_25_180 eval:check_rbl_sub('senderbase', 'S23 > 7.2 && (time - S25 < 180*86400)')
header T_SB_23_7_4_25_10 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 10*86400)')
header T_SB_23_7_4_25_20 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 20*86400)')
header T_SB_23_7_4_25_30 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 30*86400)')
header T_SB_23_7_4_25_40 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 40*86400)')
header T_SB_23_7_4_25_50 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 50*86400)')
header T_SB_23_7_4_25_60 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 60*86400)')
header T_SB_23_7_4_25_90 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 90*86400)')
header T_SB_23_7_4_25_120 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 120*86400)')
header T_SB_23_7_4_25_180 eval:check_rbl_sub('senderbase', 'S23 > 7.4 && (time - S25 < 180*86400)')
header T_SB_23_7_6_25_10 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 10*86400)')
header T_SB_23_7_6_25_20 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 20*86400)')
header T_SB_23_7_6_25_30 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 30*86400)')
header T_SB_23_7_6_25_40 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 40*86400)')
header T_SB_23_7_6_25_50 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 50*86400)')
header T_SB_23_7_6_25_60 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 60*86400)')
header T_SB_23_7_6_25_90 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 90*86400)')
header T_SB_23_7_6_25_120 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 120*86400)')
header T_SB_23_7_6_25_180 eval:check_rbl_sub('senderbase', 'S23 > 7.6 && (time - S25 < 180*86400)')

# test 
# jm: IMO, we should come up with a new way to test *just* the URIs in RHSBL
# style, it would be *much* more efficient than doing NS and A lookups, and
# would be harder for spammers to evade.
ifplugin Mail::SpamAssassin::Plugin::URIDNSBL

uridnsbl_timeout 2

uridnsbl T_URIBL_SC_SURBL	sc.surbl.org.	TXT
header T_URIBL_SC_SURBL		eval:check_uridnsbl('T_URIBL_SC_SURBL')
describe T_URIBL_SC_SURBL	Contains a URL listed in the SC SURBL blocklist
tflags T_URIBL_SC_SURBL		net

endif   # Mail::SpamAssassin::Plugin::URIDNSBL

# replacement FORGED_MUA_THEBAT_BOUN
# bug 2415
header __MAILMAN_21             X-Mailman-Version =~ /\d/
meta T_FORGED_MUA_THEBAT_BOUN   (__THEBAT_MUA && !__THEBAT_MUA_V2 && __CTYPE_HAS_BOUNDARY && !__BAT_BOUNDARY && !__MAILMAN_21)

# some test replacements for meta rule
meta T_LONGWORDS_1	(__LONGWORDS_D || (__LONGWORDS_A + __LONGWORDS_B + __LONGWORDS_C > 1))
meta T_LONGWORDS_2	(__LONGWORDS_D || (__LONGWORDS_A && __LONGWORDS_B && __LONGWORDS_C))
meta T_LONGWORDS_3	(__LONGWORDS_A + __LONGWORDS_B + __LONGWORDS_C + __LONGWORDS_D > 1)
meta T_LONGWORDS_4	(__LONGWORDS_D || __LONGWORDS_A)
meta T_LONGWORDS_5	(__LONGWORDS_D || __LONGWORDS_B)
meta T_LONGWORDS_6	(__LONGWORDS_D || __LONGWORDS_C)

# bug 3209
# tvd: 6.754   6.8409   0.0000    1.000   1.00    0.01  T_MISSING_SUBJECT
header	__HAS_SUBJECT		exists:Subject
meta	T_MISSING_SUBJECT	!__HAS_SUBJECT

# short raw HTML length
# these are used below
body T_HTML_LENGTH_32		eval:html_eval('length', '< 32')
body T_HTML_LENGTH_64		eval:html_eval('length', '< 64')
body T_HTML_LENGTH_128		eval:html_eval('length', '< 128')
body T_HTML_LENGTH_256		eval:html_eval('length', '< 256')
body T_HTML_LENGTH_384		eval:html_eval('length', '< 384')
body T_HTML_LENGTH_512		eval:html_eval('length', '< 512')
body T_HTML_LENGTH_1024		eval:html_eval('length', '< 1024')
# probe a bit more in the sweet spot between 128 and 256
body T_HTML_LENGTH_130		eval:html_eval('length', '< 130')
body T_HTML_LENGTH_140		eval:html_eval('length', '< 140')
body T_HTML_LENGTH_150		eval:html_eval('length', '< 150')
body T_HTML_LENGTH_160		eval:html_eval('length', '< 160')
body T_HTML_LENGTH_170		eval:html_eval('length', '< 170')
body T_HTML_LENGTH_180		eval:html_eval('length', '< 180')
body T_HTML_LENGTH_180		eval:html_eval('length', '< 180')
body T_HTML_LENGTH_190		eval:html_eval('length', '< 190')
body T_HTML_LENGTH_200		eval:html_eval('length', '< 200')
body T_HTML_LENGTH_210		eval:html_eval('length', '< 210')
body T_HTML_LENGTH_220		eval:html_eval('length', '< 220')
body T_HTML_LENGTH_230		eval:html_eval('length', '< 230')
body T_HTML_LENGTH_240		eval:html_eval('length', '< 240')
body T_HTML_LENGTH_250		eval:html_eval('length', '< 250')

# rules combining short length with some element that is not
# typical of short raw HTML

body __HTML_COMMENT1		eval:html_text('comment', '=~ /<!.*?>/')
meta T_HTML_SHORT_COMMENT1_32	T_HTML_LENGTH_32 && __HTML_COMMENT1
meta T_HTML_SHORT_COMMENT1_64	T_HTML_LENGTH_64 && __HTML_COMMENT1
meta T_HTML_SHORT_COMMENT1_128	T_HTML_LENGTH_128 && __HTML_COMMENT1
meta T_HTML_SHORT_COMMENT1_256	T_HTML_LENGTH_256 && __HTML_COMMENT1
meta T_HTML_SHORT_COMMENT1_384	T_HTML_LENGTH_384 && __HTML_COMMENT1
meta T_HTML_SHORT_COMMENT1_512	T_HTML_LENGTH_512 && __HTML_COMMENT1
meta T_HTML_SHORT_COMMENT1_1024	T_HTML_LENGTH_1024 && __HTML_COMMENT1

body __HTML_COMMENT2		eval:html_text('comment', '=~ /<!(?!doctype).*?>/i')
meta T_HTML_SHORT_COMMENT2_32	T_HTML_LENGTH_32 && __HTML_COMMENT2
meta T_HTML_SHORT_COMMENT2_64	T_HTML_LENGTH_64 && __HTML_COMMENT2
meta T_HTML_SHORT_COMMENT2_128	T_HTML_LENGTH_128 && __HTML_COMMENT2
meta T_HTML_SHORT_COMMENT2_256	T_HTML_LENGTH_256 && __HTML_COMMENT2
meta T_HTML_SHORT_COMMENT2_384	T_HTML_LENGTH_384 && __HTML_COMMENT2
meta T_HTML_SHORT_COMMENT2_512	T_HTML_LENGTH_512 && __HTML_COMMENT2
meta T_HTML_SHORT_COMMENT2_1024	T_HTML_LENGTH_1024 && __HTML_COMMENT2

body __TAG_EXISTS_IMG		eval:html_tag_exists('img')
meta T_HTML_SHORT_IMG_32	T_HTML_LENGTH_32 && __TAG_EXISTS_IMG
meta T_HTML_SHORT_IMG_64	T_HTML_LENGTH_64 && __TAG_EXISTS_IMG
meta T_HTML_SHORT_IMG_128	T_HTML_LENGTH_128 && __TAG_EXISTS_IMG
meta T_HTML_SHORT_IMG_256	T_HTML_LENGTH_256 && __TAG_EXISTS_IMG
meta T_HTML_SHORT_IMG_384	T_HTML_LENGTH_384 && __TAG_EXISTS_IMG
meta T_HTML_SHORT_IMG_512	T_HTML_LENGTH_512 && __TAG_EXISTS_IMG
meta T_HTML_SHORT_IMG_1024	T_HTML_LENGTH_1024 && __TAG_EXISTS_IMG

body __TAG_EXISTS_CENTER	eval:html_tag_exists('center')
meta T_HTML_SHORT_CENTER_32	T_HTML_LENGTH_32 && __TAG_EXISTS_CENTER
meta T_HTML_SHORT_CENTER_64	T_HTML_LENGTH_64 && __TAG_EXISTS_CENTER
meta T_HTML_SHORT_CENTER_128	T_HTML_LENGTH_128 && __TAG_EXISTS_CENTER
meta T_HTML_SHORT_CENTER_256	T_HTML_LENGTH_256 && __TAG_EXISTS_CENTER
meta T_HTML_SHORT_CENTER_384	T_HTML_LENGTH_384 && __TAG_EXISTS_CENTER
meta T_HTML_SHORT_CENTER_512	T_HTML_LENGTH_512 && __TAG_EXISTS_CENTER
meta T_HTML_SHORT_CENTER_1024	T_HTML_LENGTH_1024 && __TAG_EXISTS_CENTER

meta T_HTML_SHORT_BODY_32	T_HTML_LENGTH_32 && __TAG_EXISTS_BODY
meta T_HTML_SHORT_BODY_64	T_HTML_LENGTH_64 && __TAG_EXISTS_BODY
meta T_HTML_SHORT_BODY_128	T_HTML_LENGTH_128 && __TAG_EXISTS_BODY
meta T_HTML_SHORT_BODY_256	T_HTML_LENGTH_256 && __TAG_EXISTS_BODY
meta T_HTML_SHORT_BODY_384	T_HTML_LENGTH_384 && __TAG_EXISTS_BODY
meta T_HTML_SHORT_BODY_512	T_HTML_LENGTH_512 && __TAG_EXISTS_BODY
meta T_HTML_SHORT_BODY_1024	T_HTML_LENGTH_1024 && __TAG_EXISTS_BODY

meta T_HTML_SHORT_HTML_32	T_HTML_LENGTH_32 && __TAG_EXISTS_HTML
meta T_HTML_SHORT_HTML_64	T_HTML_LENGTH_64 && __TAG_EXISTS_HTML
meta T_HTML_SHORT_HTML_128	T_HTML_LENGTH_128 && __TAG_EXISTS_HTML
meta T_HTML_SHORT_HTML_256	T_HTML_LENGTH_256 && __TAG_EXISTS_HTML
meta T_HTML_SHORT_HTML_384	T_HTML_LENGTH_384 && __TAG_EXISTS_HTML
meta T_HTML_SHORT_HTML_512	T_HTML_LENGTH_512 && __TAG_EXISTS_HTML
meta T_HTML_SHORT_HTML_1024	T_HTML_LENGTH_1024 && __TAG_EXISTS_HTML

body __TAG_EXISTS_BR		eval:html_tag_exists('br')
meta T_HTML_SHORT_BR_32		T_HTML_LENGTH_32 && __TAG_EXISTS_BR
meta T_HTML_SHORT_BR_64		T_HTML_LENGTH_64 && __TAG_EXISTS_BR
meta T_HTML_SHORT_BR_128	T_HTML_LENGTH_128 && __TAG_EXISTS_BR
meta T_HTML_SHORT_BR_256	T_HTML_LENGTH_256 && __TAG_EXISTS_BR
meta T_HTML_SHORT_BR_384	T_HTML_LENGTH_384 && __TAG_EXISTS_BR
meta T_HTML_SHORT_BR_512	T_HTML_LENGTH_512 && __TAG_EXISTS_BR
meta T_HTML_SHORT_BR_1024	T_HTML_LENGTH_1024 && __TAG_EXISTS_BR

body __TAG_EXISTS_A		eval:html_tag_exists('a')
meta T_HTML_SHORT_A_32		T_HTML_LENGTH_32 && __TAG_EXISTS_A
meta T_HTML_SHORT_A_64		T_HTML_LENGTH_64 && __TAG_EXISTS_A
meta T_HTML_SHORT_A_128		T_HTML_LENGTH_128 && __TAG_EXISTS_A
meta T_HTML_SHORT_A_256		T_HTML_LENGTH_256 && __TAG_EXISTS_A
meta T_HTML_SHORT_A_384		T_HTML_LENGTH_384 && __TAG_EXISTS_A
meta T_HTML_SHORT_A_512		T_HTML_LENGTH_512 && __TAG_EXISTS_A
meta T_HTML_SHORT_A_1024	T_HTML_LENGTH_1024 && __TAG_EXISTS_A

# HTML with very few tags
body T_HTML_TAGS_2		eval:html_eval('tags', '< 2')
body T_HTML_TAGS_4		eval:html_eval('tags', '< 4')
body T_HTML_TAGS_8		eval:html_eval('tags', '< 8')
body T_HTML_TAGS_10		eval:html_eval('tags', '< 10')
body T_HTML_TAGS_12		eval:html_eval('tags', '< 12')
body T_HTML_TAGS_14		eval:html_eval('tags', '< 14')
body T_HTML_TAGS_16		eval:html_eval('tags', '< 16')
body T_HTML_TAGS_32		eval:html_eval('tags', '< 32')
body T_HTML_TAGS_64		eval:html_eval('tags', '< 64')

# possible replacements for HTML_IMAGE_ONLY
# these use raw HTML length rather than rendered word length
body T_HTML_IMAGE_ONLY2_02	eval:html_image_only2('0000','0200')
body T_HTML_IMAGE_ONLY2_04	eval:html_image_only2('0200','0400')
body T_HTML_IMAGE_ONLY2_06	eval:html_image_only2('0400','0600')
body T_HTML_IMAGE_ONLY2_08	eval:html_image_only2('0600','0800')
body T_HTML_IMAGE_ONLY2_10	eval:html_image_only2('0800','1000')
body T_HTML_IMAGE_ONLY2_12	eval:html_image_only2('1000','1200')

body T_HTML_IMAGE_ONLY3_02	eval:html_image_only3('0000','0200')
body T_HTML_IMAGE_ONLY3_04	eval:html_image_only3('0200','0400')
body T_HTML_IMAGE_ONLY3_06	eval:html_image_only3('0400','0600')
body T_HTML_IMAGE_ONLY3_08	eval:html_image_only3('0600','0800')
body T_HTML_IMAGE_ONLY3_10	eval:html_image_only3('0800','1000')
body T_HTML_IMAGE_ONLY3_12	eval:html_image_only3('1000','1200')
