### SpamAssassin rules file: rules under test, $Rev$
###
### This file is a placeholder for rules "under probation", i.e. checked into
### SVN for testing. It should not be distributed; if the rules have good
### stats after a mass-check or two, then fold them into the distributed
### rules files.
###
### I suggest adding a prefix to rules in this file, "T_" -- this
### helps identify probationary rules in test output.
###
### <@LICENSE>
### Copyright 2004 Apache Software Foundation
### 
### Licensed under the Apache License, Version 2.0 (the "License");
### you may not use this file except in compliance with the License.
### You may obtain a copy of the License at
### 
###     http://www.apache.org/licenses/LICENSE-2.0
### 
### Unless required by applicable law or agreed to in writing, software
### distributed under the License is distributed on an "AS IS" BASIS,
### WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
### See the License for the specific language governing permissions and
### limitations under the License.
### </@LICENSE>
###
##########################################################################
##
### partial messages; currently-theoretical attack
### unsurprisingly this hits 0/0 right now.  But should we promote it anyway
### to protect against the possibility?
##header T_FRAGMENTED_MESSAGE	Content-Type =~ /message\/partial/i
##
### I'm curious, may help explain more ALL_TRUSTED fps
##body T_SA_MARKED_UP     /Spam detection software, running on the system /
##
##########################################################################
##
### IADB
##header __RCVD_IN_IADB		eval:check_rbl('iadb', 'iadb.isipp.com.')
##tflags __RCVD_IN_IADB		net nice
##
##header T_RCVD_IN_IADB_LIST	eval:check_rbl_sub('iadb', '127.0.0.1')
##describe T_RCVD_IN_IADB_LIST	Sender is listed in ISIPP IADB
##tflags T_RCVD_IN_IADB_LIST	net nice
##
### IADB trusted
##header __RCVD_IN_IADB_T		eval:check_rbl('iadbt-firsttrusted', 'iadb.isipp.com.')
##tflags __RCVD_IN_IADB_T		net nice
##
##header T_RCVD_IN_IADB_LIST_T	eval:check_rbl_sub('iadbtr', '127.0.0.1')
##describe T_RCVD_IN_IADB_LIST_T	Sender is listed in ISIPP IADB
##tflags T_RCVD_IN_IADB_LIST_T	net nice
##
##########################################################################
##
### Updated test rules for fraud, uses existing rules and updated rules
##body __T_FRAUD_92	/youre? country/i
##body __T_FRAUD_110	/the total sum/i
##body __T_FRAUD_2	/\bass?ylum\b/i
##body __T_FRAUD_102	/foreign (?:offshore )?(?:bank|account)/i
##body __T_FRAUD_144	/\bnext of kin\b/i
##body __T_FRAUD_235	/(?:international|luckyday|overseas stake|promo|world) lott(?:o|ery)/i
##body __T_FRAUD_258	/computer ballot system/i
##body __T_FRAUD_113	/win cash/i
##body __T_FRAUD_44	/(?:may i first|to) introduce my ?self/i
##body __T_FRAUD_81	/as the beneficiary/i
##body __T_FRAUD_58	/\bcongo\b/i
##body __T_FRAUD_259	/drawn	?from.{0,10}\d{2,3},?\d{3}/i
##body __T_FRAUD_149	/as a minister/i
##body __T_FRAUD_236	/lott(?:o|ery) (?:co,?ordinator|international)/i
##body __T_FRAUD_249	/bequest/i
##body __T_FRAUD_125	/(?:white|black|zimbabwean) farmers?/i
##body __T_FRAUD_252	/modalit(?:y|ies)/i
##body __T_FRAUD_132	/(?:who was a|as a|an? honest|you being a|to any) foreigner/i
##body __T_FRAUD_227	/(?:negotiate|reasonable|acc?or?ding|certain|agg?ree).{1,20}percentage/i
##body __T_FRAUD_100	/(?:claim|concerning) (?:the|this) money/i
##body __T_FRAUD_26	/charity organization/i
##body __T_FRAUD_88	/remains unclaimed/i
##body __T_FRAUD_16	/land dispute/i
##body __T_FRAUD_240	/award notification/i
##body __T_FRAUD_157	/god gives .{1,10}second chance/i
##body __T_FRAUD_46	/i am contacting you/i
##body __T_FRAUD_133	/foreign (?:business partner|customer)/i
##body __T_FRAUD_228	/percentage.{1,10}(?:indicat|previous|involved)/i
##body __T_FRAUD_120	/letter of authority/i
##body __T_FRAUD_114	/you are.{0,8}winner/i
##body __T_FRAUD_142	/my late (?:husband|wife|brother|uncle|aunt|father|mother) (?:is|[hw]a[ds])\b/i
##body __T_FRAUD_94	/(?:huge|substantial) amount of m[o0]ney/i
##body __T_FRAUD_146	/the (?:wife|heir) (?:to|of)\b/i
##body __T_FRAUD_96	/(?:will share the money|your share.{1,10}(?:shall|sum|total|money|funds))/i
##body __T_FRAUD_41	/prize award dept/i
##body __T_FRAUD_216	/reliable person/i
##body __T_FRAUD_137	/fiduciary agent/i
##body __T_FRAUD_82	/compliments? of the season/i
##body __T_FRAUD_251	/magnanimity/i
##body __T_FRAUD_19	/political crisis/i
##body __T_FRAUD_254	/\bnumbered time\b/i
##body __T_FRAUD_241	/urgent and(?: very)? (?:profitable|confidential) business propos(?:al|ition)/i
##body __T_FRAUD_35	/international court of justice/i
##body __T_FRAUD_217	/secrecy and confidentiality/i
##body __T_FRAUD_221	/(?:the importance of|utmost) secrecy/i
##body __T_FRAUD_124	/vital documents/i
##body __T_FRAUD_18	/over-invoice/i
##body __T_FRAUD_42	/(?:finance|holding|securit(?:ies|y)) (?:company|firm|storage house)/i
##body __T_FRAUD_31	/embassy/i
##body __T_FRAUD_115	/your share shall be\b/i
##body __T_FRAUD_3	/assassinate/i
##body __T_FRAUD_220	/\bto assure you\b/i
##meta T_NIGERIAN_BODY_1	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 1
##meta T_NIGERIAN_BODY_2	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 2
##meta T_NIGERIAN_BODY_3	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 3
##meta T_NIGERIAN_BODY_4	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 4
##
##########################################################################
##
### McFadden Associates - SpamAssassin Recipe
### 1/20/2004 - http://bl.csma.biz/
##header T_RCVD_IN_CSMA_BL	eval:check_rbl('csma_bl', 'bl.csma.biz.')
##describe T_RCVD_IN_CSMA_BL	Received via a blocked site in bl.csma.biz
##tflags T_RCVD_IN_CSMA_BL	net
##
##header T_DNS_FROM_SECURITYSAGE	eval:check_rbl_envfrom('securitysage', 'blackhole.securitysage.com.')
##describe T_DNS_FROM_SECURITYSAGE	Envelope sender in blackholes.securitysage.com
##tflags T_DNS_FROM_SECURITYSAGE	net
##
##########################################################################
##
### header T_FORGED_IN_WHITELIST      eval:check_forged_in_whitelist()
### describe T_FORGED_IN_WHITELIST    Forged From: is in user's white-list
### tflags T_FORGED_IN_WHITELIST      userconf
### 
### header T_FORGED_DEF_WHITELIST     eval:check_forged_in_default_whitelist()
### describe T_FORGED_DEF_WHITELIST   Forged From: is in default white-list
### tflags T_FORGED_DEF_WHITELIST     userconf

# thanks to David Ritz for passing this on; ready for post-3.0.0
header T_UNCLOSED_BRACKET   ALL =~ /\[\d+\r?\n/s

# A particularly persistent .tw spammer sending broken messages; gets past
# my installation :( .  Happily, they always HELO with "0".
header T_HELO_0     X-Spam-Relays-Untrusted =~ / helo=0 /


# bug 2554, bug 2619
body T_HOT_NASTY          /\b(?=[dehklnswxy])(?:horny|nasty|hot|wild|young(?!\s+adult)|horniest|nastiest|hottest|wildest|youngest|naughty|dirtiest|slutty|kinky|lusty|extreme|xxx+)\b.{0,9}\b(?=[acfghilmpsvx])(?:virgins?\b|asian|cheerleader|sex|selection|fuck|fucking|anal\b|lesb(?:ian|o)|incest|chicks?|pics|movies|video|gay\b|porn|h[a\@]rdcore|schoolgirls|amateur|slut|adult\b|cum\b|xxx|sites?|hotties|shit)/i

# bug 2554
body T_BEST_PORN           /\b(?:best|biggest|largest|most|free|ultimate)\b.{0,9}\b(?:virgins?\b|anal\b|lesbians?|incest|porno?|h[a\@]rdcore|sluts?|xxx+)/i

# testing for Jeff, do not use!!!
ifplugin Mail::SpamAssassin::Plugin::URIDNSBL
urirhsbl T_URIBL_MP fraud.rhs.mailpolice.com.   A
body     T_URIBL_MP eval:check_uridnsbl('URIBL_MP')
describe T_URIBL_MP URI's domain appears in MailPolice fraud list
tflags   T_URIBL_MP net
endif	# Mail::SpamAssassin::Plugin::URIDNSBL

# bug 3680: empty anchor, some others
body T_HTML_LINK_PUSH_HERE	eval:html_text_match('anchor', '(?i)(?:push|go|cl[1l]ck)\s*(?:here|this)')
body T_HTML_LINK_OPT		eval:html_text_match('anchor', '(?i)opt.?(?:out|in)')
body T_HTML_LINK_OPT_OUT	eval:html_text_match('anchor', '(?i)opt.?out')

body T_HTML_EXTRA_CLOSE_0	eval:html_test('extra_close')
body T_HTML_EXTRA_CLOSE_1	eval:html_eval('extra_close', '> 1')
body T_HTML_EXTRA_CLOSE_2	eval:html_eval('extra_close', '> 2')
body T_HTML_EXTRA_CLOSE_4	eval:html_eval('extra_close', '> 4')
body T_HTML_EXTRA_CLOSE_8	eval:html_eval('extra_close', '> 8')
body T_HTML_EXTRA_CLOSE_16	eval:html_eval('extra_close', '> 16')

body T_HTML_EXTRA_CLOSE_A	eval:html_range('extra_close_ratio', '0.00', '0.01')
body T_HTML_EXTRA_CLOSE_B	eval:html_range('extra_close_ratio', '0.01', '0.02')
body T_HTML_EXTRA_CLOSE_C	eval:html_range('extra_close_ratio', '0.02', '0.04')
body T_HTML_EXTRA_CLOSE_D	eval:html_range('extra_close_ratio', '0.04', '0.08')
body T_HTML_EXTRA_CLOSE_E	eval:html_range('extra_close_ratio', '0.08', '0.16')
body T_HTML_EXTRA_CLOSE_F	eval:html_range('extra_close_ratio', '0.16', '0.32')

# bug 3529 - LONGWORDS false positives
# fast version, but probably less accurate
meta T_LONGWORDS_1	(__LONGWORDS_A || __LONGWORDS_D)
# maybe more accurate versions
meta T_LONGWORDS_2	(__LONGWORDS_B || __LONGWORDS_C || __LONGWORDS_D)
meta T_LONGWORDS_3	(__LONGWORDS_B + __LONGWORDS_C + __LONGWORDS_D > 1)
meta T_LONGWORDS_4	(__LONGWORDS_A + __LONGWORDS_B + __LONGWORDS_C + __LONGWORDS_D > 1)

header T_INVALID_DATE		Date !~ /^\s*(?:(?i:Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s+)?[0-3\s]?[0-9]\s+(?i:Jan|Feb|Ma[ry]|Apr|Ju[nl]|Aug|Sep|Oct|Nov|Dec)\s+(?:[12][901])?[0-9]{2}\s+[0-2]?[0-9](?:\:[0-5][0-9]){1,2}\s+(?:[AP]M\s+)?(?:[+-][0-9]{4}|UT|[A-Z]{2,3}T)(?:\s+\(.*\))?\s*$/ [if-unset: Wed, 31 Jul 2002 16:41:57 +0200]

##########################################################################
# bug 2843

header   T_LEADINGPREP       From =~ /^(?:A|About|All|An|And|Any|As|At|Be|Best|Bulk|Cash|Earn|Easy|Fast|Find|For|Free|From|Get|Hi|Home|In|Instant|Is|It|Its|Limited|Lose|Love|Make|Need|New|No|Save|Sex|She|Special|Stock|Stop|Take|Test|There|This|To|Try|Want|We|What|Where|Why|You|Your)[_ ]/i
describe T_LEADINGPREP       From begins with preposition or similar word

header   T_BLANKNAME    From =~ /"" \</i
describe T_BLANKNAME    Sender has blanked out name

header    T_COPYDVD           Subject =~ /(?:c[o0]py dvd|dvd.{1,15}c[o0]py|dvd magic)/i
describe  T_COPYDVD           Subject mentions copying DVDs

header    T_FREEPPV           Subject =~ /free ?p[a\@]y[ -]?per[ -]?view/i
describe  T_FREEPPV           Subject mentions free pay-per-view 

header    T_TONER             Subject =~ /\b(?:printer[-\s]*)?(?:l[a\@]ser[-\s]*)?(?:t[o0]ner|ink(?:[-\s]*jet)?|f[a\@]x|copier)[-\s]+(?:c[a\@]rtridge|supply)/i
describe  T_TONER             Subject contains Toner or Ink Cartridge

header    T_GETPAID      Subject =~ /[g6][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?t p[\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[d\xD0]/i
describe  T_GETPAID      Subject mentions getting paid for something

header    T_MAKEMONEY            Subject =~ /(?:(?:save|make)[ -].{0,15}money[ -](?:in|on)|(?:free|grant|saving|with our|(?:claim|keep) your) money|money machine)/i
describe  T_MAKEMONEY            Subject mentions money in phrase that implies spam

header    T_STOCKMARKET      Subject =~ /STOCK MARKET/i
describe  T_STOCKMARKET      Subject mentions a/the STOCK MARKET 

header    T_WORTHCASH        Subject =~ /\b(?:Worth|Win|take|extra|earn|dollars|Short|need|claim|free|get|opinions?|surveys?)\b.{0,15}(?:fast)?(?:C[a\@]sh|M[0o]ney)\b/i
describe  T_WORTHCASH        Subject mentions something is worth cash

header    T_IMPROVE   Subject =~ /improve your/i
describe  T_IMPROVE   Subject suggests you improve something 

header    T_SUBJBOOST         Subject =~ /[b8\xDF][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[s5\$\xA7][\W_]?t/i
describe  T_SUBJBOOST         boost in Subject

header    T_FOREVER       Subject =~ /\bf[\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[r\xAE][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[vu][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[r\xAE]\b/i
describe  T_FOREVER       Forever in Subject

header    T_SUBJPROVEN        Subject =~ /\bp[\W_]?[r\xAE][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[vu][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[n\xD1\xF1]\b/i
describe  T_SUBJPROVEN        Proven in Subject

header    T_SUBJDEBT         Subject =~ /[d\xD0][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[b8\xDF][\W_]?t/i
describe  T_SUBJDEBT         Subject mentions debt

header    T_INVESTORS         Subject =~ /investors/i
describe  T_INVESTORS         Subject mentions investors

header    T_PAYING            Subject =~ /Paying/i
describe  T_PAYING            Subject mentions Paying for something
                                          
header    T_SUBJDRUGS       Subject =~ /[vu][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?[g6][\W_]?[r\xAE][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5]/i
describe  T_SUBJDRUGS       Subject mentions known spam subject

header    T_MEDICATION   Subject =~ /(?:\/\\\/\\|\/V\\|rn|[m])[\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[d\xD0][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[c\xC7\xE7\xA2\xA9][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?t[\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[n\xD1\xF1]/i
describe  T_MEDICATION   Subject mentions medication

header    T_MEDS          Subject =~ /m(e|3)ds/i  
describe  T_MEDS          Meds in subject

header    T_YOUNGER       Subject =~ /\b[y\xA5\xDD\xFD][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[uv\*\xB5\xD9-\xDC\xF9-\xFC][\W_]?[n\xD1\xF1][\W_]?[g6][\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[r\xAE]\b/i
describe  T_YOUNGER       Younger in Subject

header    T_CONSONANTS        Subject =~ /\b[bcghjklmnpqrstvwxz]{6,20}\b/
describe  T_CONSONANTS        Subject contains consecutive consonants in "word"

header    T_SPAMWORDS      Subject =~ /(?!tion)t[\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[n\xD1\xF1]/i
describe  T_SPAMWORDS      masked spam word(s) in subject
                                          
header    T_SPAMWORDS2      Subject =~ /(?!\bcheap(er)?)\b[c\xC7\xE7\xA2\xA9][\W_]?h[\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[a4\*\@\xC0-\xC5\xAA\xE0-\xE5][\W_]?p([e3\*\xC8-\xCB\xE8-\xEB][\W_]?[r\xAE])?/i
describe  T_SPAMWORDS2      masked spam word(s) in subject

header    T_SPAMWORDS3      Subject =~ /(?!\bFor\b)\bf[\W_]?(?:\[\]|\(\)|[o0\*\xD2-\xD6\xF2-\xF6])[\W_]?[r\xAE]\b/i
describe  T_SPAMWORDS3      masked spam word(s) in subject

header    T_PENIS          Subject =~ /\bpenis\b/i
describe  T_PENIS          masked spam word(s) in subject
 
header    T_SPAMWORDS4      Subject =~ /(?!\bpenis\b)\bp[\W_]?[e3\*\xC8-\xCB\xE8-\xEB][\W_]?[n\xD1\xF1][\W_]?[il1:\|\*\xCC-\xCF\xEC-\xEF][\W_]?[s5\$\xA7]\b/i
describe  T_SPAMWORDS4      masked spam word(s) in subject

header    T_MIXEDCHAR       Subject =~ /[a-z]{1,5}[0-9]{1,5}[a-z]{1,5}[0-9]{1,5}[a-z]{1,5}[0-9]{1,5}/
describe  T_MIXEDCHAR       Subject has multiple mixed chars in one "word"

header    T_RNDSPM1   Subject =~ /\b[cjnqstuvwxz][bgjqu]\b/i
describe  T_RNDSPM1   Subject contains random-text spamsign
                                         
header    T_RNDSPM2   Subject =~ /\be[bfjkopqv]\b/i
describe  T_RNDSPM2   Subject contains random-text spamsign

header    T_RNDSPM3   Subject =~ /\b[abehikmpqrsvwxyz]a[bjkquvz]\b/i
describe  T_RNDSPM3   Subject contains random-text spamsign

header    T_RNDSPM4   Subject =~ /\bx[bfghjklnpqrstwz][bfghjklnpqrstwz]\b/i
describe  T_RNDSPM4   Subject contains random-text spamsign

header    T_RNDSPM5   Subject =~ / [fghjklnqrtz]{3} /i
describe  T_RNDSPM5   Subject contains random-text spamsign

header    T_RNDSPM6   Subject =~ /\b[eiou][bfghjklnpqrtwz]{3}\b/i
describe  T_RNDSPM6   Subject contains random-text spamsign

header    T_RNDSPM7   Subject =~ /\b[bcdfghjklnpqrvwz]{5}\b/i
describe  T_RNDSPM7   Subject contains random-text spamsign

header    T_RNDSPM8      Subject =~ /\b[bcdghjklmnpqrstvwxz]{6}\b/i
describe  T_RNDSPM8      Subject contains random-text spamsign

header    T_RNDSPM9      Subject =~ /\b[bcdfghjklmnpqrstvwxz]{7}\b/i
describe  T_RNDSPM9      Subject contains random-text spamsign
                                         
header    T_LONGSUBJ       Subject =~ /.{170,}/
describe  T_LONGSUBJ       Subject is excessively long -- more than 169 chars

header   T_TELESPRLY            Received =~ /dsl\.telesp\.net\.br/
describe T_TELESPRLY            Spam passed through known spam relay domain
	
header   T_INDYLIB       X-Library=~ /Indy 10.00.14-B/
describe T_INDYLIB       Uses spam-only version of Indy library

header   T_JLH               exists:X-JLH
describe T_JLH               X-JLH header found, possible spamsign

header   T_TRACKING           ALL =~ /-tracking/i
describe T_TRACKING           There is a tracking header in the email
##########################################################################

# bug 2554
body T_HOT_NASTY /\b(?=[dehklnswxy])(?:horny|nasty|hot|wild|young|horniest|nastiest|hottest|wildest|youngest|naughty|dirtiest|slutty|kinky|lusty|extreme|xxx+)\b.{0,9}\b(?=[acfghilmpsvx])(?:virgins?\b|asian|cheerleader|sex|selection|fuck|fucking|anal\b|lesb(?:ian|o)|incest|chicks?|pics|movies|video|gay\b|porn|h[a\@]rdcore|schoolgirls|amateur|slut|adult|cum\b|xxx|sites?|hotties|shit)/i
body T_BEST_PORN /\b(?:best|biggest|largest|most|free|ultimate)\b.{0,9}\b(?:virgins?\b|anal\b|lesbians?|incest|porno?|h[a\@]rdcore|sluts?|xxx+)/i

# bug 3439
uri	T_EMPTY_URI		/^$/

meta	T_EMPTY_URI_HREF	T_EMPTY_URI_HREF_A || T_EMPTY_URI_HREF_AREA || T_EMPTY_URI_HREF_LINK
body	T_EMPTY_URI_HREF_A	eval:html_text_match('blank_uri', '^a$')
body	T_EMPTY_URI_HREF_AREA	eval:html_text_match('blank_uri', '^area$')
body	T_EMPTY_URI_HREF_LINK	eval:html_text_match('blank_uri', '^link$')

meta	T_EMPTY_URI_BG		T_EMPTY_URI_BG_BODY || T_EMPTY_URI_BG_TABLE || T_EMPTY_URI_BG_TD || T_EMPTY_URI_BG_TR
body	T_EMPTY_URI_BG_BODY	eval:html_text_match('blank_uri', '^body$')
body	T_EMPTY_URI_BG_TABLE	eval:html_text_match('blank_uri', '^table$')
body	T_EMPTY_URI_BG_TD	eval:html_text_match('blank_uri', '^td$')
body	T_EMPTY_URI_BG_TR	eval:html_text_match('blank_uri', '^tr$')

meta	T_EMPTY_URI_SRC		T_EMPTY_URI_SRC_IMG || T_EMPTY_URI_SRC_FRAME || T_EMPTY_URI_SRC_IFRAME || T_EMPTY_URI_SRC_EMBED || T_EMPTY_URI_SRC_SCRIPT
body	T_EMPTY_URI_SRC_IMG	eval:html_text_match('blank_uri', '^img$')
body	T_EMPTY_URI_SRC_FRAME	eval:html_text_match('blank_uri', '^frame$')
body	T_EMPTY_URI_SRC_IFRAME	eval:html_text_match('blank_uri', '^iframe$')
body	T_EMPTY_URI_SRC_EMBED	eval:html_text_match('blank_uri', '^embed$')
body	T_EMPTY_URI_SRC_SCRIPT	eval:html_text_match('blank_uri', '^script$')

# can only be from "form"
body	T_EMPTY_URI_ACTION	eval:html_text_match('blank_uri', '^form$')

# bug 3499
body T_MPART_ALT_DIFF1_1    eval:multipart_alternative_difference_count('1','1')
body T_MPART_ALT_DIFF2_1    eval:multipart_alternative_difference_count('2','1')
body T_MPART_ALT_DIFF3_1    eval:multipart_alternative_difference_count('3','1')
body T_MPART_ALT_DIFF4_1    eval:multipart_alternative_difference_count('4','1')
body T_MPART_ALT_DIFF5_1    eval:multipart_alternative_difference_count('5','1')
body T_MPART_ALT_DIFF8_1    eval:multipart_alternative_difference_count('8','1')
body T_MPART_ALT_DIFF10_1   eval:multipart_alternative_difference_count('10','1')

body T_MPART_ALT_DIFF1_5    eval:multipart_alternative_difference_count('1','5')
body T_MPART_ALT_DIFF2_5    eval:multipart_alternative_difference_count('2','5')
body T_MPART_ALT_DIFF3_5    eval:multipart_alternative_difference_count('3','5')
body T_MPART_ALT_DIFF4_5    eval:multipart_alternative_difference_count('4','5')
body T_MPART_ALT_DIFF5_5    eval:multipart_alternative_difference_count('5','5')
body T_MPART_ALT_DIFF8_5    eval:multipart_alternative_difference_count('8','5')
body T_MPART_ALT_DIFF10_5   eval:multipart_alternative_difference_count('10','5')

body T_MPART_ALT_DIFF1_10   eval:multipart_alternative_difference_count('1','10')
body T_MPART_ALT_DIFF2_10   eval:multipart_alternative_difference_count('2','10')
body T_MPART_ALT_DIFF3_10   eval:multipart_alternative_difference_count('3','10')
body T_MPART_ALT_DIFF4_10   eval:multipart_alternative_difference_count('4','10')
body T_MPART_ALT_DIFF5_10   eval:multipart_alternative_difference_count('5','10')
body T_MPART_ALT_DIFF8_10   eval:multipart_alternative_difference_count('8','10')
body T_MPART_ALT_DIFF10_10  eval:multipart_alternative_difference_count('10','10')

body T_MPART_ALT_DIFF1_20   eval:multipart_alternative_difference_count('1','20')
body T_MPART_ALT_DIFF2_20   eval:multipart_alternative_difference_count('2','20')
body T_MPART_ALT_DIFF3_20   eval:multipart_alternative_difference_count('3','20')
body T_MPART_ALT_DIFF4_20   eval:multipart_alternative_difference_count('4','20')
body T_MPART_ALT_DIFF5_20   eval:multipart_alternative_difference_count('5','20')
body T_MPART_ALT_DIFF8_20   eval:multipart_alternative_difference_count('8','20')
body T_MPART_ALT_DIFF10_20  eval:multipart_alternative_difference_count('10','20')

# bug 3186
uri T_BIZ_TLD		/^(?:https?:\/\/|mailto:)[^\/]+\.biz(?![-a-z0-9])/i

# catch mails with redirector looking pieces associated with it.
body T_REDIRS_2		eval:redirect_num('2')
body T_REDIRS_3		eval:redirect_num('3')
body T_REDIRS_4		eval:redirect_num('4')
body T_REDIRS_5		eval:redirect_num('5')
body T_REDIRS_8		eval:redirect_num('8')
body T_REDIRS_10	eval:redirect_num('10')
body T_REDIRS_15	eval:redirect_num('15')
body T_REDIRS_20	eval:redirect_num('20')
