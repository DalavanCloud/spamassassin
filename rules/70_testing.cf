# SpamAssassin rules file: rules under test, $Rev$
#
# This file is a placeholder for rules "under probation", i.e. checked into
# SVN for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# <@LICENSE>
# Copyright 2004 Apache Software Foundation
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
########################################################################

# partial messages; currently-theoretical attack
# unsurprisingly this hits 0/0 right now.  But should we promote it anyway
# to protect against the possibility?
header T_FRAGMENTED_MESSAGE	Content-Type =~ /message\/partial/i

# I'm curious, may help explain more ALL_TRUSTED fps
body T_SA_MARKED_UP     /Spam detection software, running on the system /

########################################################################

# IADB
header __RCVD_IN_IADB		eval:check_rbl('iadb', 'iadb.isipp.com.')
tflags __RCVD_IN_IADB		net nice

header T_RCVD_IN_IADB_LIST	eval:check_rbl_sub('iadb', '127.0.0.1')
describe T_RCVD_IN_IADB_LIST	Sender is listed in ISIPP IADB
tflags T_RCVD_IN_IADB_LIST	net nice

# IADB trusted
header __RCVD_IN_IADB_T		eval:check_rbl('iadbt-firsttrusted', 'iadb.isipp.com.')
tflags __RCVD_IN_IADB_T		net nice

header T_RCVD_IN_IADB_LIST_T	eval:check_rbl_sub('iadbtr', '127.0.0.1')
describe T_RCVD_IN_IADB_LIST_T	Sender is listed in ISIPP IADB
tflags T_RCVD_IN_IADB_LIST_T	net nice

# high daily volume for organization
# high monthly volume for IP address
header T_S2_83_S41_42	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.2')
header T_S2_83_S41_43	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.3')
header T_S2_83_S41_44	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.4')
header T_S2_83_S41_45	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.5')
header T_S2_83_S41_46	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.6')
header T_S2_83_S41_47	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.7')
header T_S2_83_S41_48	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.8')
header T_S2_83_S41_49	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 4.9')
header T_S2_83_S41_50	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 5.0')
header T_S2_83_S41_51	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 5.1')
header T_S2_83_S41_52	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 5.2')
header T_S2_83_S41_53	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 5.3')
header T_S2_83_S41_54	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 5.4')
header T_S2_83_S41_55	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 5.5')
header T_S2_83_S41_56	eval:check_rbl_sub('senderbase', 'S2 > 8.3 && S41 > 5.6')
header T_S2_84_S41_42	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.2')
header T_S2_84_S41_43	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.3')
header T_S2_84_S41_44	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.4')
header T_S2_84_S41_45	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.5')
header T_S2_84_S41_46	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.6')
header T_S2_84_S41_47	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.7')
header T_S2_84_S41_48	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.8')
header T_S2_84_S41_49	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 4.9')
header T_S2_84_S41_50	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 5.0')
header T_S2_84_S41_51	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 5.1')
header T_S2_84_S41_52	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 5.2')
header T_S2_84_S41_53	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 5.3')
header T_S2_84_S41_54	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 5.4')
header T_S2_84_S41_55	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 5.5')
header T_S2_84_S41_56	eval:check_rbl_sub('senderbase', 'S2 > 8.4 && S41 > 5.6')
header T_S2_85_S41_42	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.2')
header T_S2_85_S41_43	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.3')
header T_S2_85_S41_44	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.4')
header T_S2_85_S41_45	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.5')
header T_S2_85_S41_46	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.6')
header T_S2_85_S41_47	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.7')
header T_S2_85_S41_48	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.8')
header T_S2_85_S41_49	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 4.9')
header T_S2_85_S41_50	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 5.0')
header T_S2_85_S41_51	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 5.1')
header T_S2_85_S41_52	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 5.2')
header T_S2_85_S41_53	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 5.3')
header T_S2_85_S41_54	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 5.4')
header T_S2_85_S41_55	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 5.5')
header T_S2_85_S41_56	eval:check_rbl_sub('senderbase', 'S2 > 8.5 && S41 > 5.6')
header T_S2_86_S41_42	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.2')
header T_S2_86_S41_43	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.3')
header T_S2_86_S41_44	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.4')
header T_S2_86_S41_45	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.5')
header T_S2_86_S41_46	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.6')
header T_S2_86_S41_47	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.7')
header T_S2_86_S41_48	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.8')
header T_S2_86_S41_49	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 4.9')
header T_S2_86_S41_50	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 5.0')
header T_S2_86_S41_51	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 5.1')
header T_S2_86_S41_52	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 5.2')
header T_S2_86_S41_53	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 5.3')
header T_S2_86_S41_54	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 5.4')
header T_S2_86_S41_55	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 5.5')
header T_S2_86_S41_56	eval:check_rbl_sub('senderbase', 'S2 > 8.6 && S41 > 5.6')
header T_S2_87_S41_42	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.2')
header T_S2_87_S41_43	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.3')
header T_S2_87_S41_44	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.4')
header T_S2_87_S41_45	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.5')
header T_S2_87_S41_46	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.6')
header T_S2_87_S41_47	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.7')
header T_S2_87_S41_48	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.8')
header T_S2_87_S41_49	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 4.9')
header T_S2_87_S41_50	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 5.0')
header T_S2_87_S41_51	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 5.1')
header T_S2_87_S41_52	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 5.2')
header T_S2_87_S41_53	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 5.3')
header T_S2_87_S41_54	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 5.4')
header T_S2_87_S41_55	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 5.5')
header T_S2_87_S41_56	eval:check_rbl_sub('senderbase', 'S2 > 8.7 && S41 > 5.6')

# high monthly volume for organization
# high monthly volume for IP address
header T_S3_83_S41_42	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.2')
header T_S3_83_S41_43	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.3')
header T_S3_83_S41_44	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.4')
header T_S3_83_S41_45	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.5')
header T_S3_83_S41_46	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.6')
header T_S3_83_S41_47	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.7')
header T_S3_83_S41_48	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.8')
header T_S3_83_S41_49	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 4.9')
header T_S3_83_S41_50	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 5.0')
header T_S3_83_S41_51	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 5.1')
header T_S3_83_S41_52	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 5.2')
header T_S3_83_S41_53	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 5.3')
header T_S3_83_S41_54	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 5.4')
header T_S3_83_S41_55	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 5.5')
header T_S3_83_S41_56	eval:check_rbl_sub('senderbase', 'S3 > 8.3 && S41 > 5.6')
header T_S3_84_S41_42	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.2')
header T_S3_84_S41_43	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.3')
header T_S3_84_S41_44	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.4')
header T_S3_84_S41_45	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.5')
header T_S3_84_S41_46	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.6')
header T_S3_84_S41_47	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.7')
header T_S3_84_S41_48	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.8')
header T_S3_84_S41_49	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 4.9')
header T_S3_84_S41_50	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 5.0')
header T_S3_84_S41_51	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 5.1')
header T_S3_84_S41_52	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 5.2')
header T_S3_84_S41_53	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 5.3')
header T_S3_84_S41_54	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 5.4')
header T_S3_84_S41_55	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 5.5')
header T_S3_84_S41_56	eval:check_rbl_sub('senderbase', 'S3 > 8.4 && S41 > 5.6')
header T_S3_85_S41_42	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.2')
header T_S3_85_S41_43	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.3')
header T_S3_85_S41_44	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.4')
header T_S3_85_S41_45	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.5')
header T_S3_85_S41_46	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.6')
header T_S3_85_S41_47	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.7')
header T_S3_85_S41_48	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.8')
header T_S3_85_S41_49	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 4.9')
header T_S3_85_S41_50	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 5.0')
header T_S3_85_S41_51	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 5.1')
header T_S3_85_S41_52	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 5.2')
header T_S3_85_S41_53	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 5.3')
header T_S3_85_S41_54	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 5.4')
header T_S3_85_S41_55	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 5.5')
header T_S3_85_S41_56	eval:check_rbl_sub('senderbase', 'S3 > 8.5 && S41 > 5.6')
header T_S3_86_S41_42	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.2')
header T_S3_86_S41_43	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.3')
header T_S3_86_S41_44	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.4')
header T_S3_86_S41_45	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.5')
header T_S3_86_S41_46	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.6')
header T_S3_86_S41_47	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.7')
header T_S3_86_S41_48	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.8')
header T_S3_86_S41_49	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 4.9')
header T_S3_86_S41_50	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 5.0')
header T_S3_86_S41_51	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 5.1')
header T_S3_86_S41_52	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 5.2')
header T_S3_86_S41_53	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 5.3')
header T_S3_86_S41_54	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 5.4')
header T_S3_86_S41_55	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 5.5')
header T_S3_86_S41_56	eval:check_rbl_sub('senderbase', 'S3 > 8.6 && S41 > 5.6')
header T_S3_87_S41_42	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.2')
header T_S3_87_S41_43	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.3')
header T_S3_87_S41_44	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.4')
header T_S3_87_S41_45	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.5')
header T_S3_87_S41_46	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.6')
header T_S3_87_S41_47	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.7')
header T_S3_87_S41_48	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.8')
header T_S3_87_S41_49	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 4.9')
header T_S3_87_S41_50	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 5.0')
header T_S3_87_S41_51	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 5.1')
header T_S3_87_S41_52	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 5.2')
header T_S3_87_S41_53	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 5.3')
header T_S3_87_S41_54	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 5.4')
header T_S3_87_S41_55	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 5.5')
header T_S3_87_S41_56	eval:check_rbl_sub('senderbase', 'S3 > 8.7 && S41 > 5.6')

tflags T_S2_83_S41_42 net
tflags T_S2_83_S41_43 net
tflags T_S2_83_S41_44 net
tflags T_S2_83_S41_45 net
tflags T_S2_83_S41_46 net
tflags T_S2_83_S41_47 net
tflags T_S2_83_S41_48 net
tflags T_S2_83_S41_49 net
tflags T_S2_83_S41_50 net
tflags T_S2_83_S41_51 net
tflags T_S2_83_S41_52 net
tflags T_S2_83_S41_53 net
tflags T_S2_83_S41_54 net
tflags T_S2_83_S41_55 net
tflags T_S2_83_S41_56 net
tflags T_S2_84_S41_42 net
tflags T_S2_84_S41_43 net
tflags T_S2_84_S41_44 net
tflags T_S2_84_S41_45 net
tflags T_S2_84_S41_46 net
tflags T_S2_84_S41_47 net
tflags T_S2_84_S41_48 net
tflags T_S2_84_S41_49 net
tflags T_S2_84_S41_50 net
tflags T_S2_84_S41_51 net
tflags T_S2_84_S41_52 net
tflags T_S2_84_S41_53 net
tflags T_S2_84_S41_54 net
tflags T_S2_84_S41_55 net
tflags T_S2_84_S41_56 net
tflags T_S2_85_S41_42 net
tflags T_S2_85_S41_43 net
tflags T_S2_85_S41_44 net
tflags T_S2_85_S41_45 net
tflags T_S2_85_S41_46 net
tflags T_S2_85_S41_47 net
tflags T_S2_85_S41_48 net
tflags T_S2_85_S41_49 net
tflags T_S2_85_S41_50 net
tflags T_S2_85_S41_51 net
tflags T_S2_85_S41_52 net
tflags T_S2_85_S41_53 net
tflags T_S2_85_S41_54 net
tflags T_S2_85_S41_55 net
tflags T_S2_85_S41_56 net
tflags T_S2_86_S41_42 net
tflags T_S2_86_S41_43 net
tflags T_S2_86_S41_44 net
tflags T_S2_86_S41_45 net
tflags T_S2_86_S41_46 net
tflags T_S2_86_S41_47 net
tflags T_S2_86_S41_48 net
tflags T_S2_86_S41_49 net
tflags T_S2_86_S41_50 net
tflags T_S2_86_S41_51 net
tflags T_S2_86_S41_52 net
tflags T_S2_86_S41_53 net
tflags T_S2_86_S41_54 net
tflags T_S2_86_S41_55 net
tflags T_S2_86_S41_56 net
tflags T_S2_87_S41_42 net
tflags T_S2_87_S41_43 net
tflags T_S2_87_S41_44 net
tflags T_S2_87_S41_45 net
tflags T_S2_87_S41_46 net
tflags T_S2_87_S41_47 net
tflags T_S2_87_S41_48 net
tflags T_S2_87_S41_49 net
tflags T_S2_87_S41_50 net
tflags T_S2_87_S41_51 net
tflags T_S2_87_S41_52 net
tflags T_S2_87_S41_53 net
tflags T_S2_87_S41_54 net
tflags T_S2_87_S41_55 net
tflags T_S2_87_S41_56 net
tflags T_S3_83_S41_42 net
tflags T_S3_83_S41_43 net
tflags T_S3_83_S41_44 net
tflags T_S3_83_S41_45 net
tflags T_S3_83_S41_46 net
tflags T_S3_83_S41_47 net
tflags T_S3_83_S41_48 net
tflags T_S3_83_S41_49 net
tflags T_S3_83_S41_50 net
tflags T_S3_83_S41_51 net
tflags T_S3_83_S41_52 net
tflags T_S3_83_S41_53 net
tflags T_S3_83_S41_54 net
tflags T_S3_83_S41_55 net
tflags T_S3_83_S41_56 net
tflags T_S3_84_S41_42 net
tflags T_S3_84_S41_43 net
tflags T_S3_84_S41_44 net
tflags T_S3_84_S41_45 net
tflags T_S3_84_S41_46 net
tflags T_S3_84_S41_47 net
tflags T_S3_84_S41_48 net
tflags T_S3_84_S41_49 net
tflags T_S3_84_S41_50 net
tflags T_S3_84_S41_51 net
tflags T_S3_84_S41_52 net
tflags T_S3_84_S41_53 net
tflags T_S3_84_S41_54 net
tflags T_S3_84_S41_55 net
tflags T_S3_84_S41_56 net
tflags T_S3_85_S41_42 net
tflags T_S3_85_S41_43 net
tflags T_S3_85_S41_44 net
tflags T_S3_85_S41_45 net
tflags T_S3_85_S41_46 net
tflags T_S3_85_S41_47 net
tflags T_S3_85_S41_48 net
tflags T_S3_85_S41_49 net
tflags T_S3_85_S41_50 net
tflags T_S3_85_S41_51 net
tflags T_S3_85_S41_52 net
tflags T_S3_85_S41_53 net
tflags T_S3_85_S41_54 net
tflags T_S3_85_S41_55 net
tflags T_S3_85_S41_56 net
tflags T_S3_86_S41_42 net
tflags T_S3_86_S41_43 net
tflags T_S3_86_S41_44 net
tflags T_S3_86_S41_45 net
tflags T_S3_86_S41_46 net
tflags T_S3_86_S41_47 net
tflags T_S3_86_S41_48 net
tflags T_S3_86_S41_49 net
tflags T_S3_86_S41_50 net
tflags T_S3_86_S41_51 net
tflags T_S3_86_S41_52 net
tflags T_S3_86_S41_53 net
tflags T_S3_86_S41_54 net
tflags T_S3_86_S41_55 net
tflags T_S3_86_S41_56 net
tflags T_S3_87_S41_42 net
tflags T_S3_87_S41_43 net
tflags T_S3_87_S41_44 net
tflags T_S3_87_S41_45 net
tflags T_S3_87_S41_46 net
tflags T_S3_87_S41_47 net
tflags T_S3_87_S41_48 net
tflags T_S3_87_S41_49 net
tflags T_S3_87_S41_50 net
tflags T_S3_87_S41_51 net
tflags T_S3_87_S41_52 net
tflags T_S3_87_S41_53 net
tflags T_S3_87_S41_54 net
tflags T_S3_87_S41_55 net
tflags T_S3_87_S41_56 net

# two term ratio tests
header T_S2_S9_GT_4_7	eval:check_rbl_sub('senderbase', '(S2 / S9) > 4.7')
header T_S2_S9_GT_4_8	eval:check_rbl_sub('senderbase', '(S2 / S9) > 4.8')
header T_S2_S9_GT_4_9	eval:check_rbl_sub('senderbase', '(S2 / S9) > 4.9')
header T_S2_S9_GT_5_0	eval:check_rbl_sub('senderbase', '(S2 / S9) > 5.0')
header T_S2_S9_GT_5_1	eval:check_rbl_sub('senderbase', '(S2 / S9) > 5.1')
header T_S2_S9_GT_5_2	eval:check_rbl_sub('senderbase', '(S2 / S9) > 5.2')
header T_S2_S9_GT_5_3	eval:check_rbl_sub('senderbase', '(S2 / S9) > 5.3')
header T_S2_S9_GT_5_4	eval:check_rbl_sub('senderbase', '(S2 / S9) > 5.4')
header T_S2_S9_GT_5_5	eval:check_rbl_sub('senderbase', '(S2 / S9) > 5.5')
header T_S2_S9_GT_5_6	eval:check_rbl_sub('senderbase', '(S2 / S9) > 5.6')

header T_S2_S7_GT_7_0	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.0')
header T_S2_S7_GT_7_1	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.1')
header T_S2_S7_GT_7_2	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.2')
header T_S2_S7_GT_7_3	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.3')
header T_S2_S7_GT_7_4	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.4')
header T_S2_S7_GT_7_5	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.5')
header T_S2_S7_GT_7_6	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.6')
header T_S2_S7_GT_7_7	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.7')
header T_S2_S7_GT_7_8	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.8')
header T_S2_S7_GT_7_9	eval:check_rbl_sub('senderbase', '(S2 / S7) > 7.9')

header T_S3_S9_GT_4_5	eval:check_rbl_sub('senderbase', '(S3 / S9) > 4.5')
header T_S3_S9_GT_4_6	eval:check_rbl_sub('senderbase', '(S3 / S9) > 4.6')
header T_S3_S9_GT_4_7	eval:check_rbl_sub('senderbase', '(S3 / S9) > 4.7')
header T_S3_S9_GT_4_8	eval:check_rbl_sub('senderbase', '(S3 / S9) > 4.8')
header T_S3_S9_GT_4_9	eval:check_rbl_sub('senderbase', '(S3 / S9) > 4.9')
header T_S3_S9_GT_5_0	eval:check_rbl_sub('senderbase', '(S3 / S9) > 5.0')
header T_S3_S9_GT_5_1	eval:check_rbl_sub('senderbase', '(S3 / S9) > 5.1')
header T_S3_S9_GT_5_2	eval:check_rbl_sub('senderbase', '(S3 / S9) > 5.2')
header T_S3_S9_GT_5_3	eval:check_rbl_sub('senderbase', '(S3 / S9) > 5.3')
header T_S3_S9_GT_5_4	eval:check_rbl_sub('senderbase', '(S3 / S9) > 5.4')

header T_S40_S9_GT_4_9	eval:check_rbl_sub('senderbase', '(S40 / S9) > 4.9')
header T_S40_S9_GT_5_0	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.0')
header T_S40_S9_GT_5_1	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.1')
header T_S40_S9_GT_5_2	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.2')
header T_S40_S9_GT_5_3	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.3')
header T_S40_S9_GT_5_4	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.4')
header T_S40_S9_GT_5_5	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.5')
header T_S40_S9_GT_5_6	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.6')
header T_S40_S9_GT_5_7	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.7')
header T_S40_S9_GT_5_8	eval:check_rbl_sub('senderbase', '(S40 / S9) > 5.8')

header T_S41_S9_GT_4_6	eval:check_rbl_sub('senderbase', '(S41 / S9) > 4.6')
header T_S41_S9_GT_4_7	eval:check_rbl_sub('senderbase', '(S41 / S9) > 4.7')
header T_S41_S9_GT_4_8	eval:check_rbl_sub('senderbase', '(S41 / S9) > 4.8')
header T_S41_S9_GT_4_9	eval:check_rbl_sub('senderbase', '(S41 / S9) > 4.9')
header T_S41_S9_GT_5_0	eval:check_rbl_sub('senderbase', '(S41 / S9) > 5.0')
header T_S41_S9_GT_5_1	eval:check_rbl_sub('senderbase', '(S41 / S9) > 5.1')
header T_S41_S9_GT_5_2	eval:check_rbl_sub('senderbase', '(S41 / S9) > 5.2')
header T_S41_S9_GT_5_3	eval:check_rbl_sub('senderbase', '(S41 / S9) > 5.3')
header T_S41_S9_GT_5_4	eval:check_rbl_sub('senderbase', '(S41 / S9) > 5.4')
header T_S41_S9_GT_5_5	eval:check_rbl_sub('senderbase', '(S41 / S9) > 5.5')

tflags T_S2_S9_GT_4_7 net
tflags T_S2_S9_GT_4_8 net
tflags T_S2_S9_GT_4_9 net
tflags T_S2_S9_GT_5_0 net
tflags T_S2_S9_GT_5_1 net
tflags T_S2_S9_GT_5_2 net
tflags T_S2_S9_GT_5_3 net
tflags T_S2_S9_GT_5_4 net
tflags T_S2_S9_GT_5_5 net
tflags T_S2_S9_GT_5_6 net
tflags T_S2_S7_GT_7_0 net
tflags T_S2_S7_GT_7_1 net
tflags T_S2_S7_GT_7_2 net
tflags T_S2_S7_GT_7_3 net
tflags T_S2_S7_GT_7_4 net
tflags T_S2_S7_GT_7_5 net
tflags T_S2_S7_GT_7_6 net
tflags T_S2_S7_GT_7_7 net
tflags T_S2_S7_GT_7_8 net
tflags T_S2_S7_GT_7_9 net
tflags T_S3_S9_GT_4_5 net
tflags T_S3_S9_GT_4_6 net
tflags T_S3_S9_GT_4_7 net
tflags T_S3_S9_GT_4_8 net
tflags T_S3_S9_GT_4_9 net
tflags T_S3_S9_GT_5_0 net
tflags T_S3_S9_GT_5_1 net
tflags T_S3_S9_GT_5_2 net
tflags T_S3_S9_GT_5_3 net
tflags T_S3_S9_GT_5_4 net
tflags T_S40_S9_GT_4_9 net
tflags T_S40_S9_GT_5_0 net
tflags T_S40_S9_GT_5_1 net
tflags T_S40_S9_GT_5_2 net
tflags T_S40_S9_GT_5_3 net
tflags T_S40_S9_GT_5_4 net
tflags T_S40_S9_GT_5_5 net
tflags T_S40_S9_GT_5_6 net
tflags T_S40_S9_GT_5_7 net
tflags T_S40_S9_GT_5_8 net
tflags T_S41_S9_GT_4_6 net
tflags T_S41_S9_GT_4_7 net
tflags T_S41_S9_GT_4_8 net
tflags T_S41_S9_GT_4_9 net
tflags T_S41_S9_GT_5_0 net
tflags T_S41_S9_GT_5_1 net
tflags T_S41_S9_GT_5_2 net
tflags T_S41_S9_GT_5_3 net
tflags T_S41_S9_GT_5_4 net
tflags T_S41_S9_GT_5_5 net

########################################################################

# let's see how this works
meta T_SPF_PASS_NO_SBL		(SPF_PASS && !RCVD_IN_SBL)
meta T_SPF_HELO_PASS_NO_SBL	(SPF_HELO_PASS && !RCVD_IN_SBL)
tflags T_SPF_PASS_NO_SBL	net nice
tflags T_SPF_HELO_PASS_NO_SBL	net nice

# long-term test
# IP-based volume and date of first email might be better considering
# that SBL is a domain blacklist, but this is a start
header __SENDERBASE_VOL_SPIKE	eval:check_rbl_sub('senderbase', 'S23 > S24 + 1')
header __SENDERBASE_45_DAYS	eval:check_rbl_sub('senderbase', '(time - S25 > 45*86400)')
header __SENDERBASE_90_DAYS	eval:check_rbl_sub('senderbase', '(time - S25 > 90*86400)')
header __SENDERBASE_180_DAYS	eval:check_rbl_sub('senderbase', '(time - S25 > 180*86400)')
header __SENDERBASE_360_DAYS	eval:check_rbl_sub('senderbase', '(time - S25 > 360*86400)')
meta T_SPF_PASS_NO_SBL_45D	(SPF_PASS && !RCVD_IN_SBL && !__SENDERBASE_VOL_SPIKE && __SENDERBASE_45_DAYS)
meta T_SPF_PASS_NO_SBL_90D	(SPF_PASS && !RCVD_IN_SBL && !__SENDERBASE_VOL_SPIKE && __SENDERBASE_90_DAYS)
meta T_SPF_PASS_NO_SBL_180D	(SPF_PASS && !RCVD_IN_SBL && !__SENDERBASE_VOL_SPIKE && __SENDERBASE_180_DAYS)
meta T_SPF_PASS_NO_SBL_360D	(SPF_PASS && !RCVD_IN_SBL && !__SENDERBASE_VOL_SPIKE && __SENDERBASE_360_DAYS)
tflags T_SPF_PASS_NO_SBL_45D net nice
tflags T_SPF_PASS_NO_SBL_90D net nice
tflags T_SPF_PASS_NO_SBL_180D net nice
tflags T_SPF_PASS_NO_SBL_360D net nice

# Carl Hutzler of AOL says: "block on sight" (mail sent 07 May 2004 to discuss
# at lists.surbl.org).  not much hits for me, but let's see for everyone else
uri T_REDIR_AOL_CLICKTHRU     /www\.aol\.com\/ams\/clickThruRedirect\.adp/i

# Suresh says: these will never be used as HELOs from real mail.com relays.
# Just check the most recent handover; the connection to a trusted host.
# This way a legit sender can send to their MSA using that HELO (quite a few
# MUAs will do that), but a spammer gets caught.  (List of domains comes from
# the drop-down list on the Mail.com signup page.)
header T_FAKE_HELO_MAIL_COM_DOM  X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=(?:\S+\.|)(?:(?:mail|email|iname|cheerful|consultant|europe|mindless|myself|post|techie|usa|writeme|2die4|artlover|bikerider|catlover|cliffhanger|cutey|doglover|gardener|hot-shot|inorbit|loveable|mad\.scientist|playful|poetic|popstar|saintly|seductive|soon|whoever|winning|witty|yours|africamail|arcticmail|asia|australiamail|europe|japan|samerica|usa|berlin|dublin|london|madrid|moscowmail|munich|nycmail|paris|rome|sanfranmail|singapore|tokyo|accountant|adexec|allergist|alumnidirector|archaeologist|chemist|clerk|columnist|comic|consultant|counsellor|deliveryman|diplomats|doctor|dr|engineer|execs|financier|geologist|graphic-designer|insurer|journalist|lawyer|legislator|lobbyist|minister|optician|pediatrician|presidency|priest|publicist|realtyagent|registerednurses|repairman|representative|rescueteam|scientist|sociologist|teacher|techietechnologist|umpire)\.com|(?:programmer|earthling|hairdresser)\.net|musician\.org) /i
header T_FAKE_HELO_MAIL_COM_DOM2  X-Spam-Relays-Untrusted =~ /^[^\]]+ helo=(?:(?:mail|email|iname|cheerful|consultant|europe|mindless|myself|post|techie|usa|writeme|2die4|artlover|bikerider|catlover|cliffhanger|cutey|doglover|gardener|hot-shot|inorbit|loveable|mad\.scientist|playful|poetic|popstar|saintly|seductive|soon|whoever|winning|witty|yours|africamail|arcticmail|asia|australiamail|europe|japan|samerica|usa|berlin|dublin|london|madrid|moscowmail|munich|nycmail|paris|rome|sanfranmail|singapore|tokyo|accountant|adexec|allergist|alumnidirector|archaeologist|chemist|clerk|columnist|comic|consultant|counsellor|deliveryman|diplomats|doctor|dr|engineer|execs|financier|geologist|graphic-designer|insurer|journalist|lawyer|legislator|lobbyist|minister|optician|pediatrician|presidency|priest|publicist|realtyagent|registerednurses|repairman|representative|rescueteam|scientist|sociologist|teacher|techietechnologist|umpire)\.com|(?:programmer|earthling|hairdresser)\.net|musician\.org) /i

