# SpamAssassin rules file: rules under test, $Rev$
#
# This file is a placeholder for rules "under probation", i.e. checked into
# SVN for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# <@LICENSE>
# Copyright 2004 Apache Software Foundation
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
########################################################################

# partial messages; currently-theoretical attack
# unsurprisingly this hits 0/0 right now.  But should we promote it anyway
# to protect against the possibility?
header T_FRAGMENTED_MESSAGE	Content-Type =~ /message\/partial/i

# I'm curious, may help explain more ALL_TRUSTED fps
body T_SA_MARKED_UP     /Spam detection software, running on the system /

# more general template rule to try
header __HEADER_TEMPLATE	ALL =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __UIDL_TEMPLATE		X-UIDL =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __XFACE_TEMPLATE		X-Face =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __TOCC_TEMPLATE		ToCc =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __FROM_TEMPLATE		From =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __SUBJECT_TEMPLATE	Subject =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __REF_TEMPLATE		References =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __REP_TEMPLATE		In-Reply-To =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
header __MID_TEMPLATE		MESSAGEID =~ /%[A-Z][A-Z_-]+[^%A-Za-z_-]/
meta T_INCOMPLETE_TEMPLATE	(__HEADERTEMPLATE && !__UIDL_TEMPLATE && !__XFACE_TEMPLATE && !__TOCC_TEMPLATE && !__FROM_TEMPLATE && !__SUBJECT_TEMPLATE && !__REF_TEMPLATE && !__REP_TEMPLATE && !__MID_TEMPLATE)

########################################################################

# IADB
header __RCVD_IN_IADB		eval:check_rbl('iadb', 'iadb.isipp.com.')
tflags __RCVD_IN_IADB		net nice

header T_RCVD_IN_IADB_LIST	eval:check_rbl_sub('iadb', '127.0.0.1')
describe T_RCVD_IN_IADB_LIST	Sender is listed in ISIPP IADB
tflags T_RCVD_IN_IADB_LIST	net nice

# IADB trusted
header __RCVD_IN_IADB_T		eval:check_rbl('iadbt-firsttrusted', 'iadb.isipp.com.')
tflags __RCVD_IN_IADB_T		net nice

header T_RCVD_IN_IADB_LIST_T	eval:check_rbl_sub('iadbtr', '127.0.0.1')
describe T_RCVD_IN_IADB_LIST_T	Sender is listed in ISIPP IADB
tflags T_RCVD_IN_IADB_LIST_T	net nice

########################################################################

# (looks good for T_SPF_PASS_NO_SBL, for everyone except Michael.
# half of my FNs are misfiled hams! --j.)
# 0.497   0.1446   2.5959    0.053   0.41   -0.00  SPF_PASS
# 0.700   0.6002   0.8002    0.429   0.38   -0.00  SPF_PASS:jm
# 0.880   1.1405   0.6428    0.640   0.23   -0.00  SPF_PASS:parkerm
# 2.482   0.7534   4.2123    0.152   0.58   -0.00  SPF_PASS:quinlan
# 0.078   0.0170  12.4542    0.001   0.34   -0.00  SPF_PASS:theo
# 0.439   0.0774   2.5959    0.029   0.45   -0.01  T_SPF_PASS_NO_SBL
# 0.425   0.0500   0.8002    0.059   0.54   -0.01  T_SPF_PASS_NO_SBL:jm
# 0.845   1.0684   0.6428    0.624   0.23   -0.01  T_SPF_PASS_NO_SBL:parkerm
# 2.285   0.3600   4.2123    0.079   0.65   -0.01  T_SPF_PASS_NO_SBL:quinlan
# 0.064   0.0030  12.4542    0.000   0.50   -0.01  T_SPF_PASS_NO_SBL:theo

meta T_SPF_PASS_NO_SBL		(SPF_PASS && !RCVD_IN_SBL)
tflags T_SPF_PASS_NO_SBL	net nice

# I don't think this one is worth keeping though.  not much effect...
# in fact, most of my hits for this are from forwarders.
# 6.090   2.3287  28.4943    0.076   0.43   -0.01  T_SPF_HELO_PASS_NO_SBL
meta T_SPF_HELO_PASS_NO_SBL	(SPF_HELO_PASS && !RCVD_IN_SBL)
tflags T_SPF_HELO_PASS_NO_SBL	net nice

# Carl Hutzler of AOL says: "block on sight" (mail sent 07 May 2004 to discuss
# at lists.surbl.org).  not much hits for me, but let's see for everyone else
uri T_REDIR_AOL_CLICKTHRU     /www\.aol\.com\/ams\/clickThruRedirect\.adp/i

body T_SAVE_BUCKS		/\bsave \$/i

# after all that work, the best two (which are not great), maybe let the
# perceptron decide between these two before promoting one
header T_MANY_MX_5	From:addr =~ /\@mx\d{2,4}\..{1,20}\./i
header T_MANY_MX_10	From:addr =~ /\@\w\d+\..*\./i

# Updated test rules for fraud, uses existing rules and updated rules
body __T_FRAUD_92	/youre? country/i
body __T_FRAUD_110	/the total sum/i
body __T_FRAUD_2	/\bass?ylum\b/i
body __T_FRAUD_102	/foreign (?:offshore )?(?:bank|account)/i
body __T_FRAUD_144	/\bnext of kin\b/i
body __T_FRAUD_235	/(?:international|luckyday|overseas stake|promo|world) lott(?:o|ery)/i
body __T_FRAUD_258	/computer ballot system/i
body __T_FRAUD_113	/win cash/i
body __T_FRAUD_44	/(?:may i first|to) introduce my ?self/i
body __T_FRAUD_81	/as the beneficiary/i
body __T_FRAUD_58	/\bcongo\b/i
body __T_FRAUD_259	/drawn	?from.{0,10}\d{2,3},?\d{3}/i
body __T_FRAUD_149	/as a minister/i
body __T_FRAUD_236	/lott(?:o|ery) (?:co,?ordinator|international)/i
body __T_FRAUD_249	/bequest/i
body __T_FRAUD_125	/(?:white|black|zimbabwean) farmers?/i
body __T_FRAUD_252	/modalit(?:y|ies)/i
body __T_FRAUD_132	/(?:who was a|as a|an? honest|you being a|to any) foreigner/i
body __T_FRAUD_227	/(?:negotiate|reasonable|acc?or?ding|certain|agg?ree).{1,20}percentage/i
body __T_FRAUD_100	/(?:claim|concerning) (?:the|this) money/i
body __T_FRAUD_26	/charity organization/i
body __T_FRAUD_88	/remains unclaimed/i
body __T_FRAUD_16	/land dispute/i
body __T_FRAUD_240	/award notification/i
body __T_FRAUD_157	/god gives .{1,10}second chance/i
body __T_FRAUD_46	/i am contacting you/i
body __T_FRAUD_133	/foreign (?:business partner|customer)/i
body __T_FRAUD_228	/percentage.{1,10}(?:indicat|previous|involved)/i
body __T_FRAUD_120	/letter of authority/i
body __T_FRAUD_114	/you are.{0,8}winner/i
body __T_FRAUD_142	/my late (?:husband|wife|brother|uncle|aunt|father|mother) (?:is|[hw]a[ds])\b/i
body __T_FRAUD_94	/(?:huge|substantial) amount of m[o0]ney/i
body __T_FRAUD_146	/the (?:wife|heir) (?:to|of)\b/i
body __T_FRAUD_96	/(?:will share the money|your share.{1,10}(?:shall|sum|total|money|funds))/i
body __T_FRAUD_41	/prize award dept/i
body __T_FRAUD_216	/reliable person/i
body __T_FRAUD_137	/fiduciary agent/i
body __T_FRAUD_82	/compliments? of the season/i
body __T_FRAUD_251	/magnanimity/i
body __T_FRAUD_19	/political crisis/i
body __T_FRAUD_254	/\bnumbered time\b/i
body __T_FRAUD_241	/urgent and(?: very)? (?:profitable|confidential) business propos(?:al|ition)/i
body __T_FRAUD_35	/international court of justice/i
body __T_FRAUD_217	/secrecy and confidentiality/i
body __T_FRAUD_221	/(?:the importance of|utmost) secrecy/i
body __T_FRAUD_124	/vital documents/i
body __T_FRAUD_18	/over-invoice/i
body __T_FRAUD_42	/(?:finance|holding|securit(?:ies|y)) (?:company|firm|storage house)/i
body __T_FRAUD_31	/embassy/i
body __T_FRAUD_115	/your share shall be\b/i
body __T_FRAUD_3	/assassinate/i
body __T_FRAUD_220	/\bto assure you\b/i
meta T_NIGERIAN_BODY_1	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 1
meta T_NIGERIAN_BODY_2	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 2
meta T_NIGERIAN_BODY_3	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 3
meta T_NIGERIAN_BODY_4	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 + __T_FRAUD_92 + __T_FRAUD_110 + __T_FRAUD_2 + __T_FRAUD_102 + __T_FRAUD_144 + __T_FRAUD_235 + __T_FRAUD_258 + __T_FRAUD_113 + __T_FRAUD_44 + __T_FRAUD_81 + __T_FRAUD_58 + __T_FRAUD_259 + __T_FRAUD_149 + __T_FRAUD_236 + __T_FRAUD_249 + __T_FRAUD_125 + __T_FRAUD_252 + __T_FRAUD_132 + __T_FRAUD_227 + __T_FRAUD_100 + __T_FRAUD_26 + __T_FRAUD_88 + __T_FRAUD_16 + __T_FRAUD_240 + __T_FRAUD_157 + __T_FRAUD_46 + __T_FRAUD_133 + __T_FRAUD_228 + __T_FRAUD_120 + __T_FRAUD_114 + __T_FRAUD_142 + __T_FRAUD_94 + __T_FRAUD_146 + __T_FRAUD_96 + __T_FRAUD_41 + __T_FRAUD_216 + __T_FRAUD_137 + __T_FRAUD_82 + __T_FRAUD_251 + __T_FRAUD_19 + __T_FRAUD_254 + __T_FRAUD_241 + __T_FRAUD_35 + __T_FRAUD_217 + __T_FRAUD_221 + __T_FRAUD_124 + __T_FRAUD_18 + __T_FRAUD_42 + __T_FRAUD_31 + __T_FRAUD_115 + __T_FRAUD_3 + __T_FRAUD_220 ) > 4

# ratware: forging Postfix Receiveds
# this doesn't seem to be working.  It works with pcregrep, though...
# odd...
header T_RATWARE_RCVD_PF_1  Received =~ / \(Postfix\) with ESMTP id .+\; \S+ \d+ \S+ \d+ \d+:\d+:\d+ \S+$/s

header T_RATWARE_RCVD_AT    Received =~ / by \S+\@\S+ with Microsoft SMTPSVC/

########################################################################
# Spamhaus suggested only testing final external IP with XBL, but try
# technique on most blacklists since it helps so much with XBL
# (just prefixed set name with 'x' and added T_ to start of test name)

header __T_RCVD_IN_NJABL	eval:check_rbl('xnjabl-firsttrusted', 'combined.njabl.org.')
describe __T_RCVD_IN_NJABL	Received via a relay in combined.njabl.org
tflags __T_RCVD_IN_NJABL	net

header T_RCVD_IN_NJABL_RELAY	eval:check_rbl_sub('xnjabl-firsttrusted', '127.0.0.2')
describe T_RCVD_IN_NJABL_RELAY	NJABL: sender is confirmed open relay
tflags T_RCVD_IN_NJABL_RELAY	net

header T_RCVD_IN_NJABL_DUL	eval:check_rbl('xnjabl-firsttrusted', 'combined.njabl.org.', '127.0.0.3')
describe T_RCVD_IN_NJABL_DUL	NJABL: dialup sender did non-local SMTP
tflags T_RCVD_IN_NJABL_DUL	net

header T_RCVD_IN_NJABL_SPAM	eval:check_rbl_sub('xnjabl-firsttrusted', '127.0.0.4')
describe T_RCVD_IN_NJABL_SPAM	NJABL: sender is confirmed spam source
tflags T_RCVD_IN_NJABL_SPAM	net

header T_RCVD_IN_NJABL_MULTI	eval:check_rbl_sub('xnjabl-firsttrusted', '127.0.0.5')
describe T_RCVD_IN_NJABL_MULTI	NJABL: sent through multi-stage open relay
tflags T_RCVD_IN_NJABL_MULTI	net

header T_RCVD_IN_NJABL_CGI	eval:check_rbl_sub('xnjabl-firsttrusted', '127.0.0.8')
describe T_RCVD_IN_NJABL_CGI	NJABL: sender is an open formmail
tflags T_RCVD_IN_NJABL_CGI	net

header T_RCVD_IN_NJABL_PROXY	eval:check_rbl_sub('xnjabl-firsttrusted', '127.0.0.9')
describe T_RCVD_IN_NJABL_PROXY	NJABL: sender is an open proxy
tflags T_RCVD_IN_NJABL_PROXY	net

header __T_RCVD_IN_SORBS	eval:check_rbl('xsorbs-firsttrusted', 'dnsbl.sorbs.net.')
describe __T_RCVD_IN_SORBS	SORBS: sender is listed in SORBS
tflags __T_RCVD_IN_SORBS	net

header T_RCVD_IN_SORBS_HTTP	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.2')
describe T_RCVD_IN_SORBS_HTTP	SORBS: sender is open HTTP proxy server
tflags T_RCVD_IN_SORBS_HTTP	net

header T_RCVD_IN_SORBS_MISC	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.3')
describe T_RCVD_IN_SORBS_MISC	SORBS: sender is open proxy server
tflags T_RCVD_IN_SORBS_MISC	net

header T_RCVD_IN_SORBS_SMTP	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.4')
describe T_RCVD_IN_SORBS_SMTP	SORBS: sender is open SMTP relay
tflags T_RCVD_IN_SORBS_SMTP	net

header T_RCVD_IN_SORBS_SOCKS	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.5')
describe T_RCVD_IN_SORBS_SOCKS	SORBS: sender is open SOCKS proxy server
tflags T_RCVD_IN_SORBS_SOCKS	net

#header T_RCVD_IN_SORBS_SPAM	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.6')
#describe T_RCVD_IN_SORBS_SPAM	SORBS: sender is a spam source
#tflags T_RCVD_IN_SORBS_SPAM	net

header T_RCVD_IN_SORBS_WEB	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.7')
describe T_RCVD_IN_SORBS_WEB	SORBS: sender is a abuseable web server
tflags T_RCVD_IN_SORBS_WEB	net

header T_RCVD_IN_SORBS_BLOCK	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.8')
describe T_RCVD_IN_SORBS_BLOCK	SORBS: sender demands to never be tested
tflags T_RCVD_IN_SORBS_BLOCK	net

header T_RCVD_IN_SORBS_ZOMBIE	eval:check_rbl_sub('xsorbs-firsttrusted', '127.0.0.9')
describe T_RCVD_IN_SORBS_ZOMBIE	SORBS: sender is on a hijacked network
tflags T_RCVD_IN_SORBS_ZOMBIE	net

header T_RCVD_IN_SORBS_DUL	eval:check_rbl('xsorbs-firsttrusted', 'dnsbl.sorbs.net.', '127.0.0.10')
describe T_RCVD_IN_SORBS_DUL	SORBS: sent directly from dynamic IP address
tflags T_RCVD_IN_SORBS_DUL	net

header __T_RCVD_IN_SBL_XBL	eval:check_rbl('xsblxbl-firsttrusted', 'sbl-xbl.spamhaus.org.')
describe __T_RCVD_IN_SBL_XBL	Received via a relay in Spamhaus SBL+XBL
tflags __T_RCVD_IN_SBL_XBL	net

header T_RCVD_IN_SBL		eval:check_rbl_sub('xsblxbl-firsttrusted', '127.0.0.2')
describe T_RCVD_IN_SBL		Received via a relay in Spamhaus SBL
tflags T_RCVD_IN_SBL		net

header T_RCVD_IN_BL_SPAMCOP_NET	eval:check_rbl_txt('xspamcop-firsttrusted', 'bl.spamcop.net.')
describe T_RCVD_IN_BL_SPAMCOP_NET	Received via a relay in bl.spamcop.net
tflags T_RCVD_IN_BL_SPAMCOP_NET	net

header T_RCVD_IN_RSL		eval:check_rbl_txt('xrsl-firsttrusted', 'relays.visi.com.')
describe T_RCVD_IN_RSL		Received via a relay in RSL
tflags T_RCVD_IN_RSL		net
