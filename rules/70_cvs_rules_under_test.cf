# this file is a placeholder for rules "under probation",
# ie. checked into CVS for testing.
#
# It should not be distributed; if the rules have good stats
# after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "" -- this
# helps identify probationary rules in test output.

# bug 637
# more specific FROM_HAS_MIXED_NUMS, less FPs
header FROM_HAS_MIXED_NUMS2        From =~ /\w{2,}\d{4,}[a-z]{1,2}\d{2,}\@/i
describe FROM_HAS_MIXED_NUMS2 From address matches known spammer format

# http://www.hughes-family.org/bugzilla/show_bug.cgi?id=632
body LOW_PRICE                  /\blow.{0,4} (?-i:P)rice/i
describe LOW_PRICE              Lowest Price

# http://www.hughes-family.org/bugzilla/show_bug.cgi?id=610
body T_SALE                       /\bsales? (?:price|system|department|technology|ends|today)|\b(?:on|summer|movie|clearance|for|your|increase|super|losing|return|business|airfare) (?-i:S)ales?/i
describe T_SALE                   Stuff on Sale

# http://www.hughes-family.org/bugzilla/show_bug.cgi?id=679
body T_MEMBER                 /\bmember (?:number|reward|value|benefit|rate|report|card|information)s?\b/i
describe T_MEMBER             Member Stuff

# Till now no spammer told me where he's working at :o)
#   -- Malte
# freqs:  2.273    0.383    3.416    0.10    1.00  T_NOSPAM_INC
header T_NOSPAM_INC		exists:Organization
describe T_NOSPAM_INC		Where are you working at?
tflags T_NOSPAM_INC		nice

######################################################################
# the following rules have been revived for "one last mass mass-check"
# before 2.40 release, as discussed on -devel.  They seem to get
# quite bad results generally, but are worth a check.
#
# I haven't added the T_ prefix to most, as I'm going to go over
# *all* the rules anyway with a fine-toothed comb once we consolidate
# all the mass-check results... so all rules are T_ rules for now ;)

# desc:  0.004    0.009    0.001    0.94    3.60  EJACULATION

body     EJACULATION            /\b(?:increase|improve|greater).{0,10}ejaculation/i
describe EJACULATION            Increase your ejaculation!

body TRACE_BY_SSN               /Trace anyone by social security number/i
describe TRACE_BY_SSN           Talks about tracing by SSN
body AUTO_EMAIL_REMOVAL         /Auto Email Removal/
describe AUTO_EMAIL_REMOVAL     Claims auto-email removal
body CYBER_FIRE_POWER           /\b(?:by|for) Cyber FirePower\!/
describe CYBER_FIRE_POWER       mentions Cyber FirePower!, a spam-tool
body ONCE_IN_LIFETIME           /once in a lifetime opportunity/i
describe ONCE_IN_LIFETIME       Once in a lifetime, apparently
rawbody SAFEGUARD_NOTICE        /This safeguard is not inserted when using the registered version/s
describe SAFEGUARD_NOTICE       Contains signature of unregistered spam tool
body FREE_FLAG                  /\bfree flag/i
describe FREE_FLAG              Free Flag
body MORE_TRAFFIC               /\bmore (?:internet|web) traffic\b/i
describe MORE_TRAFFIC           More Internet Traffic
body NO_MIDDLEMAN               /\bno middleman\b/i
describe NO_MIDDLEMAN           No Middleman
body PHONE_CANCER               /\bphone.{0,15}cancer\b/i
describe PHONE_CANCER           Cell Phone Cancer Scam
body PORN_GALLERIES             /\bhuge galleries\b/i
describe PORN_GALLERIES         Possible porn - Galleries of Pictures
body UNCLAIMED_MONEY            /\bunclaimed (?:funds|money|prizes?|rewards?)\b/i
describe UNCLAIMED_MONEY        People just leave money laying around
rawbody SPAM_FORM_INPUT         /<input name=.{0,5}submit.{0,99} Submit By E-Mail /i
describe SPAM_FORM_INPUT        Form for verifying email address

body INTL_EXEC_GUILD            /International Executive Guild/
describe INTL_EXEC_GUILD        Well known SPAM senders

body IN_ACCORDANCE_WITH_LAWS    /has been sent in accordance with/
describe IN_ACCORDANCE_WITH_LAWS Claims to be in accordance with some Spam law

header ORDER_STATUS             Subject =~ / order\b/i
describe ORDER_STATUS           Subject looks like order info
tflags ORDER_STATUS             nice
score ORDER_STATUS -1.0

body HOTMAIL_FOOTER4            /Join the world's largest e-mail service with MSN Hotmail\./
describe HOTMAIL_FOOTER4        Common footer for Hotmail   
tflags HOTMAIL_FOOTER4          nice
score HOTMAIL_FOOTER4           -1.0

header MAY_BE_FORGED            Received =~ /\(may be forged\)/i   
describe MAY_BE_FORGED          'Received:' has 'may be forged' warning

header DATE_MISSING             Date =~ /^UNSET$/ [if-unset: UNSET]
describe DATE_MISSING           Missing Date: header

# freqs:  0.001    0.003    0.000    1.00    2.66  POST_IN_RCVD
header POST_IN_RCVD             Received =~ / Post\.(?:sk|cz)/   
describe POST_IN_RCVD           Received contains fake 'Post.cz' hostname

header X_FIX_PRESENT            exists:X-Fix

header FROM_UGETMORE            From =~ /\@ugetmore4less.net/i   
describe FROM_UGETMORE          From an address @ugetmore4less.net
header FROM_TOPICA              From =~ /\@(?:\w\.)*email-publisher.com/i   
describe FROM_TOPICA            From an address @email-publisher.com

# freqs:  0.003    0.008    0.000    1.00    1.00  WWW_AUTOREMOVE_COM
uri WWW_AUTOREMOVE_COM      /autoremove\.com/i   
describe WWW_AUTOREMOVE_COM     Frequent SPAM content
uri WWW_TRAFFICWOW_NET      /trafficwow\.net/i
describe WWW_TRAFFICWOW_NET         Frequent SPAM content   
header RATWARE_39	ALL =~ /V3,1,6,1/
describe RATWARE_39	Bulk email software fingerprint (39) found in headers

######################################################################
