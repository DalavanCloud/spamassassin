# SpamAssassin rules file: CVS rules under test
#
# This file is a placeholder for rules "under probation", ie. checked into
# CVS for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
###########################################################################

# new MIME_BOUND tests
#
# results for quinlan:
#  1.350    4.145    0.000    1.00    0.87    1.00  T_MIME_BOUND_NEXTPART
#  0.911    2.799    0.000    1.00    0.84    1.00  T_MIME_BOUND_DASH_DIGIT
#  0.131    0.404    0.000    1.00    0.71    1.00  T_MIME_BOUND_MANY_HEX
#  0.123    0.377    0.000    1.00    0.71    1.00  T_MIME_BOUND_TEP

# This may need tweaking if new NextPart formats appear.
header __NEXTPART_ALL		Content-Type =~ /NextPart/
header __NEXTPART_NORMAL	Content-Type =~ /-{3}[-_]=_NextPart_[\dA-F]{3}(_[\dA-F]{3,8})?_[\dA-F]{8}.[\dA-F]{8}\b/
meta T_MIME_BOUND_NEXTPART	(__NEXTPART_ALL && !__NEXTPART_NORMAL)
score T_MIME_BOUND_NEXTPART	1.0

header T_MIME_BOUND_DASH_DIGIT	Content-Type =~ /boundary="_-{10}=_\d{19,22}"/
score T_MIME_BOUND_DASH_DIGIT	1.0

header T_MIME_BOUND_MANY_HEX	Content-Type =~ /boundary="[\da-f]{8}(?:-[\da-f]{4}){3}-[\da-f]{12}"/
score T_MIME_BOUND_MANY_HEX	1.0

header T_MIME_BOUND_TEP		Content-Type =~ /boundary="TEP-\d{9,10}\.\d{10}\.\d{10}"/
score T_MIME_BOUND_TEP		1.0

# results for quinlan
#  0.149    0.458    0.000    1.00    0.72    0.50  T_FROM_TOPICA
header T_FROM_TOPICA		From:addr =~ /\@(?:\w+\.)?email-publisher\.com$/
describe T_FROM_TOPICA		From an address at email-publisher.com
score T_FROM_TOPICA		0.5

# results for quinlan
#  0.245    0.727    0.013    0.98    0.57    0.50  T_FROM_ALL_NUMS
header __FROM_JUST_NUMBER	From:addr =~ /^\d+\@/
header __FROM_PHONE		From:addr =~ /^\d{3}(?:[-.]?\d{3}[-.]?\d{4}|\d{7})\@/
meta T_FROM_ALL_NUMS		(__FROM_JUST_NUMBER && !__FROM_PHONE)
describe T_FROM_ALL_NUMS	From an address that is all numbers (non-phone)
score T_FROM_ALL_NUMS		0.5

# results for quinlan
#  0.482    1.454    0.013    0.99    0.61    0.50  T_SOME_BREAKTHROUGH
body T_SOME_BREAKTHROUGH	/(?:science|medical|major|scientific|fundamental|technology|revolutionary)\s+breakthrough/i
score T_SOME_BREAKTHROUGH	0.5

# results for quinlan
#  0.193    0.592    0.000    1.00    0.74    0.50  T_SELECTED_YOU
body T_SELECTED_YOU		/(?:you (?:have been|were) selected|we (?:have )?selected you)/i
score T_SELECTED_YOU		0.5

body T_HTML_TAG_EXISTS_TITLE		eval:html_tag_exists('title')
describe T_HTML_TAG_EXISTS_TITLE	HTML has "title" tag
score T_HTML_TAG_EXISTS_TITLE		0.5

body T_HTML_UNTITLED_TITLE	eval:html_eval('title_text', '=~ /Untitled/i')
describe T_HTML_UNTITLED_TITLE	HTML title contains "Untitled"
score T_HTML_UNTITLED_TITLE	2.5

body T_HTML_EMPTY_TITLE		eval:html_eval('title_text', '!~ /\S/s')
describe T_HTML_EMPTY_TITLE	HTML title contains no text
score T_HTML_EMPTY_TITLE	2.5

# Sep 23 2002 jm: another spamhaus rule
header T_QVES_COM               Received =~ /by email.qves.com with Microsoft/
describe T_QVES_COM             Sent by a known spamhaus (qves)
score T_QVES_COM                3.0

uri T_ADCLICK                   m,\Qhttp://www.adclick.ws/p\E,
describe T_ADCLICK              Contains adclick URL
score T_ADCLICK                 2.0

body T_POSTCARD			/send a postcard to Unsubscribe/
describe T_POSTCARD		Send a postcard to unsubscribe
score T_POSTCARD		3.0

# quinlan: this is not any better on my corpus, but I figured it was
# worth a shot
body T_UNSUBSCRIBE_WTF		/(?:(?:unsubscribe|remov[ae]).{0,16}\b(?:letter|postcard|fax)|\b(?:letter|postcard|fax).{0,16}(?:unsubscribe|remov[ae]))/i
describe T_UNSUBSCRIBE_WTF	Send a postcard/letter/fax to unsubscribe
score T_UNSUBSCRIBE_WTF		3.0

# results for quinlan:
# 0.333    1.023    0.000    1.00    0.77    1.00  T_RATWARE_CDO
header T_RATWARE_CDO		X-Mailer =~ /Microsoft CDO for Windows 2000/
describe T_RATWARE_CDO		Sent from "Microsoft CDO for Windows 2000" 
score T_RATWARE_CDO		1.0

# results for quinlan:
# 0.421    1.292    0.000    1.00    0.79    1.00  T_RATWARE_EMWAC
header T_RATWARE_EMWAC		Received =~ /EMWAC SMTPRS/
describe T_RATWARE_EMWAC	Sent via a relay running "EMWAC SMTPRS"
score T_RATWARE_EMWAC		1.0

# results for quinlan:
# 0.368    1.131    0.000    1.00    0.78    1.00  T_RATWARE_THEBAT
header T_RATWARE_THEBAT		X-Mailer =~ /The Bat/
describe T_RATWARE_THEBAT	Sent from "The Bat"
score T_RATWARE_THEBAT		1.0

# theory: more nonspam than spam contains ads from mainstream ad co's ;) (jm)
uri T_AD_DOUBLECLICK      m,\Qhttp://ad.doubleclick.net/ad/\E,
tflags T_AD_DOUBLECLICK   nice
score T_AD_DOUBLECLICK    -1.0
uri T_AD_MSADS_NET        m,\Qhttp://global.msads.net/ads/\E,
tflags T_AD_MSADS_NET   nice
score T_AD_MSADS_NET    -1.0
uri T_AD_ADS_COM_COM      m,\Qhttp://ads.com.com/\E,
tflags T_AD_ADS_COM_COM   nice
score T_AD_ADS_COM_COM    -1.0
uri T_AD_ZDNET            m,\Qhttp://www.zdnet.com/include/ads/\E,
tflags T_AD_ZDNET   nice
score T_AD_ZDNET    -1.0
uri T_ZD_BURSTNET         m,\Qhttp://www.burstnet.com/ads/\E,
tflags T_AD_BURSTNET   nice
score T_AD_BURSTNET    -1.0

