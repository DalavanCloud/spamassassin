# SpamAssassin rules file: CVS rules under test, $Revision: 1.614 $
#
# This file is a placeholder for rules "under probation", ie. checked into
# CVS for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of either the Artistic License or the GNU General
# Public License as published by the Free Software Foundation; either
# version 1 of the License, or (at your option) any later version.
#
# See the file "License" in the top level of the SpamAssassin source
# distribution for more details.
#
###########################################################################

# some dial-up lists that seem decent, worth testing some more
header T_RCVD_IN_DUN_DNSRBL rbleval:check_rbl('dun-notfirsthop', 'dun.dnsrbl.net.')
tflags T_RCVD_IN_DUN_DNSRBL net

# still need to check for cost, policies, etc.
# URL: http://www.fabel.dk/relay/
header T_RCVD_IN_FABEL		rbleval:check_rbl('fabel', 'spamsources.fabel.dk.')
describe T_RCVD_IN_FABEL	Received via a relay in spamsources.fabel.dk
tflags T_RCVD_IN_FABEL net

# bug 1733: SenderBase
# sa.senderbase.org for SpamAssassin queries
# test.senderbase.org for everything else (until SenderBase is in production)
header __SENDERBASE rbleval:check_rbl_txt('senderbase', 'sa.senderbase.org.')
tflags __SENDERBASE net

# SenderBase test rule, should have same results as RCVD_IN_BONDEDSENDER
header T_RCVD_IN_BONDEDSENDER rbleval:check_rbl_sub('senderbase', 'defined(S45) && S45 eq "Y"')
tflags T_RCVD_IN_BONDEDSENDER net

# Justin says Yahoo stopped using this hostname entirely (which makes me
# wonder if spammers will still use it and whether it will work on our
# older corpus mail)
uri T_YAHOO_REDIRECTOR		/^https?:\/\/rd\.yahoo\.com/i
describe T_YAHOO_REDIRECTOR	Uses commonly-spammed redirector URL

# This is not necessarily intended for the 2.60 release; if it's not
# 1.0 S/O, just leave it in here for 2.61cvs.
#
header T_FAKE_HELO_DELPHI	eval:check_for_rdns_helo_mismatch("delphi\.com", "delphi\.com")
describe T_FAKE_HELO_DELPHI	Host HELO did not match rDNS: delphi.com

# delphi.com is frequently forged.  but it's no longer an ISP ;)
header T_HAS_NUM_AT_DELPHI	ALL =~ /\d\S+\@delphi\.com\b/
describe T_HAS_NUM_AT_DELPHI	Contains a Delphi address with a number

