#
# 'Ratware' -- ie. bulk-mailers commonly used by spammers.
#
# Sometimes these leave 'sent by mailername' fingerprints in the
# headers, which provide a nice way for us to catch them.
#
# Note that the tests which look at the "ALL" pseudoheader are quite
# inefficient; if you're going to add a new RATWARE test, please name
# the specific header, as that's much quicker.

header RATWARE_GROUPMAIL   ALL =~ /Group Mail/
describe RATWARE_GROUPMAIL Bulk email software fingerprint (Group Mail) found in headers
header RATWARE_IMKTG	   ALL =~ /Internet Marketing/
describe RATWARE_IMKTG	   Bulk email software fingerprint (IMktg) found in headers
header RATWARE_NETMAILER   ALL =~ /NetMailer/
describe RATWARE_NETMAILER Bulk email software fingerprint (NetMailer) found in headers
header RATWARE_YMR	   ALL =~ /YMR/
describe RATWARE_YMR	   Bulk email software fingerprint (YMR) found in headers
header RATWARE_MATCHMAKER  ALL =~ /Matchmaker/
describe RATWARE_MATCHMAKER Bulk email software fingerprint (Matchmaker) found in headers
header RATWARE_DIFFOND	   ALL =~ /DiffondiCool/
describe RATWARE_DIFFOND   Bulk email software fingerprint (DiffondiCool) found in headers
header RATWARE_COGNI       ALL =~ /Cognigen/
describe RATWARE_COGNI	   Bulk email software fingerprint (Cognigen) found in headers
header RATWARE_STORM       X-Mailer =~ /StormPost 1.0/
describe RATWARE_STORM     Bulk email software fingerprint (StormPost) found in headers

# We should not be seeing X-Mailer headers from news gateways, in email messages.
# TODO: check to see if legit mails, gatewayed from USENET to mail, might contain
# this header!
header RATWARE_EGROUPS     X-Mailer =~ /eGroups Message Poster/
describe RATWARE_EGROUPS   Bulk email software fingerprint (eGroups) found in headers

header RATWARE_CSMTP     X-Mailer =~ /CSMTPConnection v/
describe RATWARE_CSMTP   Bulk email software fingerprint (CSMTPConnection) found in headers
header RATWARE_XMAILER     X-Mailer =~ /{%xmailer%}/
describe RATWARE_XMAILER   Bulk email software fingerprint (xmailer tag) found in headers
header RATWARE_LC_OUTLOOK     X-Mailer =~ /^outlook$/
describe RATWARE_LC_OUTLOOK   Bulk email software fingerprint (outlook) found in headers
header RATWARE_CARETOP     X-Mailer =~ /Caretop 2604/
describe RATWARE_CARETOP   Bulk email software fingerprint (Caretop) found in headers
header RATWARE_PASCUAL     X-Mailer =~ /made from pascual/
describe RATWARE_PASCUAL   Bulk email software fingerprint (pascual) found in headers
header RATWARE_GR     X-Mailer =~ /GRMessageQueue/
describe RATWARE_GR   Bulk email software fingerprint (/GRMessageQueue/) found in headers
header RATWARE_JPFREE     X-Mailer =~ /jpfree Group Mail Express v1.0/
describe RATWARE_JPFREE   Bulk email software fingerprint (jpfree) found in headers
header RATWARE_VC_IPA     X-Mailer =~ /2.0-b55-VC_IPA/
describe RATWARE_VC_IPA   Bulk email software fingerprint (VC_IPA) found in headers
header RATWARE_EPAPER     X-Mailer =~ /EPaper Boy/
describe RATWARE_EPAPER   Bulk email software fingerprint (EPaper) found in headers
header RATWARE_HSU     X-Mailer =~ /Mailer by Henry Su/
describe RATWARE_HSU   Bulk email software fingerprint (HSU) found in headers
header RATWARE_MMAILER     X-Mailer =~ /MMailer v3.0/
describe RATWARE_MMAILER   Bulk email software fingerprint (MMailer) found in headers
header RATWARE_MBOMBER     X-Mailer =~ /Mail Bomber/
describe RATWARE_MBOMBER   Bulk email software fingerprint (Mail Bomber) found in headers
header RATWARE_JIXING     X-Mailer =~ /JiXing .{0,30}Design By JohnnieHuang/
describe RATWARE_JIXING   Bulk email software fingerprint (JiXing) found in headers
header RATWARE_YAM     X-Mailer =~ /Yam Mailer v1.0/
describe RATWARE_YAM   Bulk email software fingerprint (Yam) found in headers
header RATWARE_POWERC     X-Mailer =~ /PowerCampaign v2.30.003--/
describe RATWARE_POWERC   Bulk email software fingerprint (PowerCampaign) found in headers
header RATWARE_SEEDNET     X-Mailer =~ /Seednet custom enewsletter/
describe RATWARE_SEEDNET   Bulk email software fingerprint (Seednet) found in headers
header RATWARE_EVAMAIL     X-Mailer =~ /EVAMAIL/
describe RATWARE_EVAMAIL   Bulk email software fingerprint (EVAMAIL) found in headers
header RATWARE_CBLAST     X-Mailer =~ /Campaign Blaster/
describe RATWARE_CBLAST   Bulk email software fingerprint (Campaign Blaster) found in headers
header RATWARE_MAMA     X-Mailer =~ /mama sender auth:/
describe RATWARE_MAMA   Bulk email software fingerprint (mama) found in headers
header RATWARE_EBIZ     X-Mailer =~ /eBizmailer3.0/
describe RATWARE_EBIZ   Bulk email software fingerprint (eBizmailer) found in headers
header RATWARE_OPTIN     X-Mailer =~ /Opt-In Lightning By Garvinweb/
describe RATWARE_OPTIN   Bulk email software fingerprint (Opt-In Lightning) found in headers
header RATWARE_UPROAR     X-Mailer =~ /Uproar Mass Mailer/
describe RATWARE_UPROAR   Bulk email software fingerprint (Uproar) found in headers

header RATWARE_CURMAIL     X-Mailer =~ /CurrentMailer\~/
describe RATWARE_CURMAIL   Bulk email software fingerprint (CurrentMailer) found in headers
header RATWARE_CHARSET     X-Mailer =~ /charset\(89\)/
describe RATWARE_CHARSET   Bulk email software fingerprint (charset) found in headers
header RATWARE_SCREWUP_1     X-Mailer =~ /^X-Mailer: /
describe RATWARE_SCREWUP_1   Bulk email software fingerprint (screwup 1) found in headers
header RATWARE_SCREWUP_2     X-Mailer =~ /^: /
describe RATWARE_SCREWUP_2   Bulk email software fingerprint (screwup 2) found in headers
header RATWARE_ANSMTP     X-Mailer =~ /_ANSMTP_/
describe RATWARE_ANSMTP   Bulk email software fingerprint (ANSMTP) found in headers
header RATWARE_HASH_1     X-Mailer =~ /^\w+!\w+\#\w+\*$/
describe RATWARE_HASH_1   Bulk email software fingerprint (hash 1) found in headers
header RATWARE_HASH_2     X-Mailer =~ /^[A-Za-z0-9\._]{16,}$/
describe RATWARE_HASH_2   Bulk email software fingerprint (hash 2) found in headers


# commented all of these until they get some hits ;)
# header RATWARE_00	ALL =~ /4\.\.72\.1712\.3/
# describe RATWARE_00	Bulk email software fingerprint (00) found in headers
# header RATWARE_01	ALL =~ /ACE Contact Manager/
# describe RATWARE_01	Bulk email software fingerprint (01) found in headers
# header RATWARE_02	ALL =~ /Aristotle Mail/
# describe RATWARE_02	Bulk email software fingerprint (02) found in headers
# bad: found in nonspam
# header RATWARE_03	ALL =~ /Avalanche/
# describe RATWARE_03	Bulk email software fingerprint (03) found in headers
# not a spamtool, just a type of mailer!
# header RATWARE_04	ALL =~ /Calypso/
# describe RATWARE_04	Bulk email software fingerprint (04) found in headers
# header RATWARE_05	ALL =~ /clansoft/
# describe RATWARE_05	Bulk email software fingerprint (05) found in headers
# header RATWARE_07	ALL =~ /Cyber-Bomber/
# describe RATWARE_07	Bulk email software fingerprint (07) found in headers
# found in nonspam: not ratware
# header RATWARE_08	ALL =~ /Crescent/
# describe RATWARE_08	Bulk email software fingerprint (08) found in headers
# header RATWARE_10	ALL =~ /Dynamic Mail Server/
# describe RATWARE_10	Bulk email software fingerprint (10) found in headers
# header RATWARE_11	ALL =~ /CTMailer/
# describe RATWARE_11	Bulk email software fingerprint (11) found in headers
# header RATWARE_12	ALL =~ /E-Broadcaster/
# describe RATWARE_12	Bulk email software fingerprint (12) found in headers
# header RATWARE_13	ALL =~ /E-mail Magnet/
# describe RATWARE_13	Bulk email software fingerprint (13) found in headers
# header RATWARE_14	ALL =~ /Ellipse Bulk Emailer/
# describe RATWARE_14	Bulk email software fingerprint (14) found in headers
# header RATWARE_15	ALL =~ /EmailBlaster/
# describe RATWARE_15	Bulk email software fingerprint (15) found in headers
# header RATWARE_16	ALL =~ /Emailer.Platinum/
# describe RATWARE_16	Bulk email software fingerprint (16) found in headers
# bad: found in nonspam
# header RATWARE_17	ALL =~ /eMerge/
# describe RATWARE_17	Bulk email software fingerprint (17) found in headers
# header RATWARE_18	ALL =~ /Extractor/
# describe RATWARE_18	Bulk email software fingerprint (18) found in headers
# header RATWARE_19	ALL =~ /Floodgate/
# describe RATWARE_19	Bulk email software fingerprint (19) found in headers
# header RATWARE_20	ALL =~ /FlashSend/
# describe RATWARE_20	Bulk email software fingerprint (20) found in headers
# header RATWARE_21	ALL =~ /Goldrush/
# describe RATWARE_21	Bulk email software fingerprint (21) found in headers
# header RATWARE_24	ALL =~ /Mailcast/
# describe RATWARE_24	Bulk email software fingerprint (24) found in headers
# header RATWARE_25	ALL =~ /MailKing/
# describe RATWARE_25	Bulk email software fingerprint (25) found in headers
# header RATWARE_26	ALL =~ /MassE-Mail/
# describe RATWARE_26	Bulk email software fingerprint (26) found in headers
# header RATWARE_27	ALL =~ /massmail.pl/
# describe RATWARE_27	Bulk email software fingerprint (27) found in headers
# header RATWARE_30	ALL =~ /News Breaker/
# describe RATWARE_30	Bulk email software fingerprint (30) found in headers
# header RATWARE_31	ALL =~ /pop3.report/
# describe RATWARE_31	Bulk email software fingerprint (31) found in headers
# header RATWARE_32	ALL =~ /RamoMail/
# describe RATWARE_32	Bulk email software fingerprint (32) found in headers
# header RATWARE_33	ALL =~ /Ready Aim/
# describe RATWARE_33	Bulk email software fingerprint (33) found in headers
# header RATWARE_34	ALL =~ /Shopping.Planet/
# describe RATWARE_34	Bulk email software fingerprint (34) found in headers
# header RATWARE_35	ALL =~ /Stalker.s/
# describe RATWARE_35	Bulk email software fingerprint (35) found in headers
# header RATWARE_36	ALL =~ /TBBS\/TIGER/
# describe RATWARE_36	Bulk email software fingerprint (36) found in headers
# header RATWARE_37	ALL =~ /TOO BAD/
# describe RATWARE_37	Bulk email software fingerprint (37) found in headers
# header RATWARE_38	ALL =~ /TotalMailTURBO Mail/
# describe RATWARE_38	Bulk email software fingerprint (38) found in headers
# header RATWARE_39	ALL =~ /V3,1,6,1/
# describe RATWARE_39	Bulk email software fingerprint (39) found in headers
# header RATWARE_40	ALL =~ /V3,1,2,0/
# describe RATWARE_40	Bulk email software fingerprint (40) found in headers
# header RATWARE_41	ALL =~ /V3,2,2,0/
# describe RATWARE_41	Bulk email software fingerprint (41) found in headers
# header RATWARE_42	ALL =~ /V.null.\.1712\.3/
# describe RATWARE_42	Bulk email software fingerprint (42) found in headers
# header RATWARE_43	ALL =~ /WindoZ/
# describe RATWARE_43	Bulk email software fingerprint (43) found in headers
# bad: found in nonspam
# header RATWARE_44	ALL =~ /WinNT.s.Blat/
# describe RATWARE_44	Bulk email software fingerprint (44) found in headers
# header RATWARE_45	ALL =~ /WorldMerge/
# describe RATWARE_45	Bulk email software fingerprint (45) found in headers
