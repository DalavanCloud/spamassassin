# this file is a placeholder for rules "under probation",
# ie. checked into CVS for testing.
#
# It should not be distributed; if the rules have good stats
# after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.

# bug 637
# more specific FROM_HAS_MIXED_NUMS, less FPs
header FROM_HAS_MIXED_NUMS2        From =~ /\w{2,}\d{4,}[a-z]{1,2}\d{2,}\@/i
describe FROM_HAS_MIXED_NUMS2 From address matches known spammer format

# bug 510. modified so that descs don't trigger the tests
body T_GET_PAID                   /get (?-i:P)aid/i  
describe T_GET_PAID               Contains 'get paid' with capitals

body T_FREE_TICKETS               /(?-i:F)ree ticket/i  
describe T_FREE_TICKETS           Contains 'free tickets' with capitals

body T_FREE_WEBSITE               /(?-i:F)ree web/i  
describe T_FREE_WEBSITE           Contains 'free website' with capitals

# http://www.hughes-family.org/bugzilla/show_bug.cgi?id=632
body T_LOW_PRICE                  /\blow.{0,4} (?-i:P)rice/i
describe T_LOW_PRICE              Lowest Price

# http://www.hughes-family.org/bugzilla/show_bug.cgi?id=610
body T_SALE                       /\bsales? (?:price|system|department|technology|ends|today)|\b(?:on|summer|movie|clearance|for|your|increase|super|losing|return|business|airfare) (?-i:S)ales?/i
describe T_SALE                   Stuff on Sale

# http://www.hughes-family.org/bugzilla/show_bug.cgi?id=679
body T_MEMBER                 /\bmember (?:number|reward|value|benefit|rate|report|card|information)s?\b/i
describe T_MEMBER             Member Stuff

# I (yet) haven't seen any spam with accents, umlauts etc. in the From or Subject
#   -- Malte
header T_FROM_ISO885915		From =~ /=\?ISO-8859-15?\?q\?(?:[a-z]*=[A-F][0-9A-F][a-z]*)+\?=/i
describe T_FROM_ISO885915	From contains encoded ISO-8859-1(5) characters
tflags T_FROM_ISO885915		nice
header T_SUBJ_ISO885915		Subject =~ /=\?ISO-8859-15?\?q\?(?:[a-z]*=[A-F][0-9A-F][a-z]*)+\?=/i
describe T_SUBJ_ISO885915	Subject contains encoded ISO-8859-1(5) characters
tflags T_SUBJ_ISO885915		nice

# Till now no spammer told me where he's working at :o)
#   -- Malte
header T_NOSPAM_INC		exists:Organization
describe T_NOSPAM_INC		Where are you working at?
tflags T_NOSPAM_INC		nice


######################################################################
# the following rules have been revived for "one last mass mass-check"
# before 2.40 release, as discussed on -devel.  They seem to get
# quite bad results generally, but are worth a check.
#
# I haven't added the T_ prefix to most, as I'm going to go over
# *all* the rules anyway with a fine-toothed comb once we consolidate
# all the mass-check results... so all rules are T_ rules for now ;)

body T_NASD_FINANCIAL           /\b(?:member\s+(?-i:NASD\/SIPC)|not\s+insured\s+.{0,10}(?-i:FDIC)|(?-i:FDIC)\s+insured)/i
describe T_NASD_FINANCIAL       Message indicates a financial institute
tflags   T_NASD_FINANCIAL           nice
score T_NASD_FINANCIAL -1.0
header USER_AGENT_GNUS_XM      X-Mailer   =~ /^Gnus\/\d\.\d+ /
describe USER_AGENT_GNUS_XM    X-Mailer header indicates a non-spam MUA (Gnus)
tflags USER_AGENT_GNUS_XM nice
score USER_AGENT_GNUS_XM -1.0
header USER_AGENT_OE           X-Mailer   =~ /^Microsoft Outlook Express [4-6]\.\d{2}\.\d{4}\.\d{1,4}$/
describe USER_AGENT_OE         X-Mailer header indicates a non-spam MUA (Outlook Express)
tflags USER_AGENT_OE nice
score USER_AGENT_OE -1.0
header USER_AGENT_THEBAT       X-Mailer   =~ /^The Bat! \(v1\.\d{2}[a-z )]/
describe USER_AGENT_THEBAT     X-Mailer header indicates a non-spam MUA (The Bat!)
tflags USER_AGENT_THEBAT nice
score USER_AGENT_THEBAT -1.0

body CLICK_TO_REMOVE_MAILTO        /\bclick to.{0,30}remove.{0,50}mailto:/is   
describe CLICK_TO_REMOVE_MAILTO    Click-to-remove with mailto: found   

body LASER_PRINTER              /LASER PRINTER SUPPLIES/ 
describe LASER_PRINTER          Discusses laser printer supplies

body EU_EMAIL_OPTOUT            /EU (?:e-?mail opt.?out|e.?commerce) directive/i
describe EU_EMAIL_OPTOUT        Claims compliance with SPAM regulations

body NIGERIAN_SCAM              /BASED ON INFORMATION GATHERED ABOUT YOU, WE BELIEVE\s*YOU WOULD BE IN A POSITION TO HELP US IN TRANSFER/i
describe NIGERIAN_SCAM          Nigerian scam, cf http://www.snopes2.com/inboxer/scams/nigeria.htm

body     EJACULATION            /\b(?:increase|improve|greater).{0,10}ejaculation/i
describe EJACULATION            Increase your ejaculation!

rawbody OBFUSCATING_JAVASCRIPT   /charCodeAt|fromCharCode/i
describe OBFUSCATING_JAVASCRIPT   An attempt to hide spam inside obfuscating Javascript code
body EU_200_32_CE               /Directive 200.32.CE/i
describe EU_200_32_CE           Claims compliance with SPAM regulations
body PRINT_OUT_AND_FAX          /print\s+out\s+and\s+fax/i
describe PRINT_OUT_AND_FAX      Contains words 'print out and fax'
body TRACE_BY_SSN               /Trace anyone by social security number/i
describe TRACE_BY_SSN           Talks about tracing by SSN
body AUTO_EMAIL_REMOVAL         /Auto Email Removal/
describe AUTO_EMAIL_REMOVAL     Claims auto-email removal
body CYBER_FIRE_POWER           /\b(?:by|for) Cyber FirePower\!/
describe CYBER_FIRE_POWER       mentions Cyber FirePower!, a spam-tool
body ONCE_IN_LIFETIME           /once in a lifetime opportunity/i
describe ONCE_IN_LIFETIME       Once in a lifetime, apparently
body ITS_EFFECTIVE              /\bit's effective\b/i
describe ITS_EFFECTIVE          Something claims to be effective
body SAFEGUARD_NOTICE           /This safeguard is not inserted when using the registered version/
describe SAFEGUARD_NOTICE       Contains signature of unregistered spam tool
body FREE_FLAG                  /\bfree flag/i
describe FREE_FLAG              Free Flag
body FREE_HOSTING               /\bfree hosting\b/i
describe FREE_HOSTING           Free Hosting
body LIFE_INSURANCE             /\blife insurance.{1,30}no.{1,15}exam/i
describe LIFE_INSURANCE         No Examination life Insurance
body MORE_TRAFFIC               /\bmore (?:internet|web) traffic\b/i
describe MORE_TRAFFIC           More Internet Traffic
body NO_MIDDLEMAN               /\bno middleman\b/i
describe NO_MIDDLEMAN           No Middleman
body NO_SPENDING                /\bno spending limits\b/i
describe NO_SPENDING            No Spending Limits
body PRICES_WONT_LAST           /\bprices.{0,11} last\b/i
describe PRICES_WONT_LAST       Prices won't Last
body BREAKTHROUGH               /\bbreakthrough price/i
describe BREAKTHROUGH           Breakthrough Pricing
body BONUS_PAYMENT              /\bbonus payment/i
describe BONUS_PAYMENT          Bonus Payments
body IRS                        /\bIRS .{0,15}secrets\b/i
describe IRS                    IRS Scams
body HARD_CASH                  /\bhard cash\b/i
describe HARD_CASH              Is cash really hard?
body CHANGE_TERMS               /\bstrictly based on the following terms and conditions\b/i
describe CHANGE_TERMS           Terms and conditions
body PHONE_CANCER               /\bphone.{0,15}cancer\b/i
describe PHONE_CANCER           Cell Phone Cancer Scam
body BACKED_BY                  /\bbacked by [mb]illions\b/i
describe BACKED_BY              Backed by Billions
body SPY_ON_FRIENDS             /\binvestigat.{0.15} (?:friend|employee|neighbor)/i
describe SPY_ON_FRIENDS         Investigate your Friends!
body PORN_GALLERIES             /\bhuge galleries\b/i
describe PORN_GALLERIES         Possible porn - Galleries of Pictures
body UNCLAIMED_MONEY            /\bunclaimed (?:funds|money|prizes?|rewards?)\b/i
describe UNCLAIMED_MONEY        People just leave money laying around
rawbody SPAM_FORM_INPUT         /<input name=.{0,5}submit.{0,99} Submit By E-Mail /i
describe SPAM_FORM_INPUT        Form for verifying email address
body POPLAUNCH                  /StealthLaunch PopLaunch.\s/
describe POPLAUNCH              SPAM software

body INTL_EXEC_GUILD            /International Executive Guild/
describe INTL_EXEC_GUILD        Well known SPAM senders
body ANOTHER_NET_AD             /Another Internet Ad campaign produced/
describe ANOTHER_NET_AD         Tells you it's an ad
body BRAND_NEW_PAGER            /BRAND NEW Pager FREE/
describe BRAND_NEW_PAGER        No such thing as a free lunch
body SHOES_GUY                  /(?:\b(?:Lingui|Guilin)\b.{1,30}){2,}/i
describe SHOES_GUY              Want some shoes?
body EXCUSE_8                   /requests to be taken off our mailing list/i
describe EXCUSE_8               Claims you can be removed from the list
body GREEN_EXCUSE_1             /using email instead can significantly reduce this/i
describe GREEN_EXCUSE_1         Claims SPAM helps the environment
body GREEN_EXCUSE_2             /the trees, save the planet, use email!/i
describe GREEN_EXCUSE_2         Claims SPAM helps the environment
body YOU_HAVE_BEEN_SELECTED     /You have been selected as a (?:finalist|winner)/i
describe YOU_HAVE_BEEN_SELECTED "You have been selected as a finalist", sure
body FILTERED_BY_WORLDREMOVE    /filtered by WorldRemove/
describe FILTERED_BY_WORLDREMOVE Claims to listen to some removal request list
rawbody MURKOWSKI_CRUFT         /www\.senate\.gov\/~?murkowski/
describe MURKOWSKI_CRUFT        Old Murkowski disclaimer
body NO_SELLING                 /absolutely NO selling/i
describe NO_SELLING             Claims not to be selling anything
rawbody MONSTERHUT              /monsterhut.com/

describe MONSTERHUT             Mentions monsterhut.com
body THIS_AINT_JUNK             /This.{0,30}is not (?:a )?junk (?:email)?/is
describe THIS_AINT_JUNK         Claims "This is not junk email"
body SLASH_PRICE                /\bslash.{0,2} price/i
describe SLASH_PRICE            Slashed Price
body WEALTH                     /\bachieve .{0,15}wealth\b/i
describe WEALTH                 Achieve Wealth
body SELECTED                   /\byou.{0.9} been selected\b/i
describe SELECTED               You've been selected! Lucky You!
body IN_ACCORDANCE_WITH_LAWS    /has been sent in accordance with/
describe IN_ACCORDANCE_WITH_LAWS Claims to be in accordance with some Spam law
body TO_BE_REMOVED_REPLY        /\bto\b.{0,20}\b(?:remove|unsubscribe|opt[ -]?out).{0,20}\b(?:reply|send)\b/is
describe TO_BE_REMOVED_REPLY    Says: "to be removed, reply via email" or similar   

body BALANCE_FOR_LONG           eval:check_for_very_long_text('10000')
describe BALANCE_FOR_LONG       Message text is over 10K in size 
tflags BALANCE_FOR_LONG         nice 
score BALANCE_FOR_LONG -1.0
describe BALANCE_FOR_LONG_20K   Message text is over 20K in size
body BALANCE_FOR_LONG_20K       eval:check_for_very_long_text('20000')
describe BALANCE_FOR_LONG_20K   Message text is over 20K in size  
tflags BALANCE_FOR_LONG_20K     nice  
score BALANCE_FOR_LONG_20K -1.0
describe BALANCE_FOR_LONG_40K   Message text is over 40K in size
body BALANCE_FOR_LONG_40K       eval:check_for_very_long_text('40000')
describe BALANCE_FOR_LONG_40K   Message text is over 40K in size  
tflags BALANCE_FOR_LONG_40K     nice
score BALANCE_FOR_LONG_40K -1.0

header ORDER_STATUS             Subject =~ / order\b/i
describe ORDER_STATUS           Subject looks like order info
tflags ORDER_STATUS             nice
score ORDER_STATUS -1.0

header FROM_NEWS_LIST           From =~ /(?:\@news|\@list)/i 
describe FROM_NEWS_LIST         From: has a news or list hostname in FQDN 
tflags FROM_NEWS_LIST           nice 
score FROM_NEWS_LIST           -1.0

body HOTMAIL_FOOTER4            /Join the world's largest e-mail service with MSN Hotmail\./
describe HOTMAIL_FOOTER4        Common footer for Hotmail   
tflags HOTMAIL_FOOTER4          nice
score HOTMAIL_FOOTER4           -1.0

body     PRIVACY_STATEMENT      /\bPRIVACY STATEMENT\b/i   
describe PRIVACY_STATEMENT      Contains a Privacy Statement   
tflags   PRIVACY_STATEMENT      nice 
score PRIVACY_STATEMENT           -1.0

body     TRACK_NUMBER           /\bassign.{1,100}\b(?:ticket|tracking) number/i   
describe TRACK_NUMBER           Talks about tracking numbers   
tflags   TRACK_NUMBER           nice
score TRACK_NUMBER           -1.0

body MSN_FOOTER2                /Remove my e-mail address from Gaming Zone /
describe MSN_FOOTER2            Common footer for MSN
tflags MSN_FOOTER2              nice
score MSN_FOOTER2           -1.0

header MAY_BE_FORGED            Received =~ /\(may be forged\)/i   
describe MAY_BE_FORGED          'Received:' has 'may be forged' warning


header DATE_MISSING             Date =~ /^UNSET$/ [if-unset: UNSET]
describe DATE_MISSING           Missing Date: header

header   SUSPECT_LIST_HEADERS   eval:suspect_list_headers()
describe SUSPECT_LIST_HEADERS   Mailing list headers are suspicious
header TO_INVESTORS             To =~ /\bInvestors\@/
describe TO_INVESTORS           To: non-existent 'Investors' address

header POST_IN_RCVD             Received =~ / Post\.(?:sk|cz)/   
describe POST_IN_RCVD           Received contains fake 'Post.cz' hostname

header BCC                      exists:Bcc
header X_FIX_PRESENT            exists:X-Fix

header FROM_UGETMORE            From =~ /\@ugetmore4less.net/i   
describe FROM_UGETMORE          From an address @ugetmore4less.net
header FROM_TOPICA              From =~ /\@(?:\w\.)*email-publisher.com/i   
describe FROM_TOPICA            From an address @email-publisher.com

uri E_WEBHOSTCENTRAL_URL        /e-webhostcentral\.com/i
describe E_WEBHOSTCENTRAL_URL       Frequent SPAM content   
uri FREEWEBHOSTINGCENTRAL       /freewebhostingcentral/i   
describe FREEWEBHOSTINGCENTRAL      Frequent SPAM content   
uri FREEWEBCO_NET_URL       /freewebco\.net/i
describe FREEWEBCO_NET_URL      Frequent SPAM content   
uri FREEMEGS_URL          /25freemegs\.com/i   
describe FREEMEGS_URL         Frequent SPAM content   
uri WEB4PORNO_URL           /web4porno\.com/i
describe WEB4PORNO_URL          Frequent SPAM content   
uri CLICKSFORMONEY_NET      /clicksformoney\.net/i   
describe CLICKSFORMONEY_NET     Frequent SPAM content   
uri YELLOWSUN           /yellowsun01\.com/i   
describe YELLOWSUN          Frequent SPAM content
uri WWW_AUTOREMOVE_COM      /autoremove\.com/i   
describe WWW_AUTOREMOVE_COM     Frequent SPAM content
uri WWW_DIRECTFORCEMARKETING_COM    /directforcemarketing\.com/i   
describe WWW_DIRECTFORCEMARKETING_COM   Frequent SPAM content   
uri WWW_TRAFFICWOW_NET      /trafficwow\.net/i
describe WWW_TRAFFICWOW_NET         Frequent SPAM content   
uri WWW_NETSITESFORFREE_NET     /netsitesforfree\.net/i   
describe WWW_NETSITESFORFREE_NET    Frequent SPAM content
uri URI_IS_POUND        m{\#$} 
describe URI_IS_POUND   Filename is just a '\#'; probably a JS trick

######################################################################
