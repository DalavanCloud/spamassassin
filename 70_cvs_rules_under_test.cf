# SpamAssassin rules file: CVS rules under test
#
# This file is a placeholder for rules "under probation", ie. checked into
# CVS for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
###########################################################################

# should be fixed now
header T_INVALID_MSGID		Message-Id !~ /^<(?:[a-zA-Z0-9.,!\#\$%&'*\+\/=?\^_{}|~-]+|\".+\")\@(?:[a-zA-Z0-9_.-]+|\[\d{1,3}(?:\.\d{1,3}){3}\])>(?:\s*\(.*\))?\s*$/ [if-unset: <NO@MSGID>]
describe T_INVALID_MSGID	Message-Id is not valid, according to RFC 2822

# results for quinlan
#  0.149    0.458    0.000    1.00    0.72    0.50  T_FROM_TOPICA
header T_FROM_TOPICA		From:addr =~ /\@(?:\w+\.)?email-publisher\.com$/
describe T_FROM_TOPICA		From an address at email-publisher.com
score T_FROM_TOPICA		0.5

# results for quinlan
#  0.245    0.727    0.013    0.98    0.57    0.50  T_FROM_ALL_NUMS
header __FROM_JUST_NUMBER	From:addr =~ /^\d+\@/
header __FROM_PHONE		From:addr =~ /^\d{3}(?:[-.]?\d{3}[-.]?\d{4}|\d{7})\@/
meta T_FROM_ALL_NUMS		(__FROM_JUST_NUMBER && !__FROM_PHONE)
describe T_FROM_ALL_NUMS	From an address that is all numbers (non-phone)
score T_FROM_ALL_NUMS		0.5

# seems like the hit rate is a bit too low on this one
uri T_ADCLICK_URL		m,\Qhttp://www.adclick.ws/p\E,
describe T_ADCLICK_URL		Contains adclick URL

# Needs testing
body T_QUOTE_TWICE_1		/^> >\s/
describe T_QUOTE_TWICE_1	Contains twice quoted reply
tflags T_QUOTE_TWICE_1		nice
score T_QUOTE_TWICE_1		-1.0

# Needs testing
# Outlook Express has spaces around the text, Outlook doesn't
# (jm comment: please add ^ anchor if possible.)
body T_OUTLOOK_REPLY		/----- ?Original Message ?-----/s
describe T_OUTLOOK_REPLY	Contains what looks like an outlook reply
tflags T_OUTLOOK_REPLY		nice
score T_OUTLOOK_REPLY		-1.0
#
# anchored version of T_OUTLOOK_REPLY
# T_OUTLOOK_REPLY gets some FPs and matches messages that are replies to
# replies
header __ORIGINAL_MESSAGE_AGENT	X-Mailer =~ /\b(?:Microsoft Outlook|Internet Mail Service|Mozilla|AOL)\b/
rawbody __ORIGINAL_MESSAGE_LINE	/^-{5,8} ?Original Message ?-{5,8}$/
meta T_ORIGINAL_MESSAGE		(__ORIGINAL_MESSAGE_AGENT && __ORIGINAL_MESSAGE_LINE)
describe T_ORIGINAL_MESSAGE	Looks like a reply to a message
tflags T_ORIGINAL_MESSAGE	nice
score T_ORIGINAL_MESSAGE	-1.0

# avoid an FP; good ones have a hostname after the @
header T_MSGID_GOOD_EXCHANGE	Message-Id =~ /^<[A-Z]{28}\.\S+\@\S+>$/
tflags T_MSGID_GOOD_EXCHANGE	nice
score T_MSGID_GOOD_EXCHANGE	-1.0

uri T_ADMANMAIL			/^http:\/\/admanmail\.com\//
describe T_ADMANMAIL		Contains URL of frequent spam site

# Looks good, but should be tested first.  fixes current THIS_AINT_SPAM
body T_THIS_AINT_SPAM		/This.{0,30}is.{1,10}not?.{0,15}spam/is
describe T_THIS_AINT_SPAM	Claims "This is not spam"

# similar to THIS_AINT_SPAM, but probably should be a separate rule
body T_CANNOT_BE_SPAM		/cannot be considered spam/i

# group with ONE_TIME_MAILING
body T_NEVER_ANOTHER		/never receive another mailing/i

# group these with other SUBJ_FOO rules
header T_SUBJ_AS_SEEN		Subject =~ /\bAs Seen/i
header T_SUBJ_DOUBLE_YOUR	Subject =~ /Double Your/i
# high FP rate?
header T_SUBJ_FOR_ONLY 		Subject =~ /For Only/i
header T_SUBJ_FREE_INSTANT 	Subject =~ /Free Instant/i
# high overlap with DOMAINS_CHEAP - maybe not worth keeping
header T_SUBJ_NOW_ONLY		Subject =~ /\bNow Only/i
header T_SUBJ_RIPPED		Subject =~ /Ripped & Strong/i
header T_SUBJ_YOUR_DEBT		Subject =~ /Your (?:Bills|Debt|Credit)/i
header T_SUBJ_YOUR_FAMILY	Subject =~ /Your Family/i
header T_SUBJ_YOUR_OWN		Subject =~ /Your Own/i

# seem good enough to stand on own
body T_HOME_LOANS		/home loans/i
body T_MILLION_EMAIL		/million (?:\w+ )?(?:e-?mail )?addresses/i
# do not pluralize next rule
body T_PRODUCT_SERVICE		/product or service/i
# similar to OFFER, but fewer FPs
body T_RECEIVE_OFFER		/receive special offer/i
body T_RECEIVE_EMAIL		/receive third party email/i

# variations of new rule
# original version (non-optimal number of FPs, but probably good enough)
body T_EXCUSE_24_V1		/you(?:'ve|'re| have| are)? receiv(?:ed|ing) this (?:e.?mail|advertisement) (?:by either|because)/i
# "more spam" version
body T_EXCUSE_24_V2		/you(?:'ve|'re| have| are)? receiv(?:e|ed|ing) this (?:e.?mail|advertisement|offer|special|recurring|paid).{0,16}\b(?:by either|because)/i
# "more spam" version minus "you are"
body T_EXCUSE_24_V3		/you(?:'ve|'re| have)? receiv(?:e|ed|ing) this (?:e.?mail|advertisement|offer|special|recurring|paid).{0,16}\b(?:by either|because)/i
# "more spam" version minus "email"
body T_EXCUSE_24_V4		/you(?:'ve|'re| have| are)? receiv(?:e|ed|ing) this (?:advertisement|offer|special|recurring|paid).{0,16}\b(?:by either|because)/i

# possible replacements for DIET
# version 1: add possible variations
body T_DIET_V1			/\b(?:(?:without(?: any)?|never|no).?(?:exercis(?:e|ing)|diet(?:ing|))|weight.?loss|(?:extra|los(?:[et]|ing)|burn|burning).{0,10}(?:pounds|weight|inches|lbs)|burn.{0,10}(?:fat|cellulose))\b/i
# version 2: add only those variations seen in my corpus
body T_DIET_V2			/\b(?:(?:without|no) (?:exercis(?:e|ing)|dieting)|weight.?loss|(?:extra|lose|lost|losing).{0,10}(?:pounds|weight|inches|lbs)|burn.{1,10}fat)\b/i

# less encompassing DIET variations (probably not worth keeping if
# DIET can be upgraded
header T_LOSE_WEIGHT		Subject =~ /(?:lose .{0,16}(?:weight|pounds|lbs)|weight.loss)/i
body T_BURNING_FAT		/aging while burning fat/i

# replacement for REFINANCE_YOUR_HOME (current version has spacing mistake)
body T_REFINANCE_YOUR_HOME	/\brefinance your(?: current)? (?:home|house)\b/i

# replacement for REMOVE_FROM_LIST (current version has spacing mistake)
body T_REMOVE_FROM_LIST		/to be removed from (?:the|my|our) (?:mailing|e.?mail|opt[ -]?in)? ?list/i

# possible replacement for SENT_IN_COMPLIANCE
body T_SENT_IN_COMPLIANCE	/(?:e.?mail|message) .{0,10}sen[dt] (?:to you )?in (?:\w{1,10} )?compliance (?:of|with)/i

# one or both of these may need to factor in ok_languages or ok_locales
body T_UNPRINTABLE		/[\x00-\x08\x0b\x0c\x0e-\x1f\x7f]{3,}/
body T_HIGHBIT			/[\x80-\xff]{8,}/

# possible replacement for SAVINGS (fixes \b issue following %)
header T_SAVINGS		Subject =~ /\bsave\s+(?:on\s+your|up\s+to|big|over|at\s+least|\d+\%|you)(?:\s|\b|$)/i

# possible lower-FP replacement for ACCEPT_CREDIT_CARDS
body T_ACCEPT_CREDIT_CARDS	/\b(?:accept\b|are accepting).{1,15}credit cards?\b/i

# possible replacement for ADVERT_CODE2 (rather minor improvement)
header T_ADVERT_CODE2		Subject =~ /\bA\s*D\s*V\b/i

# HTML control -- HTML spam rules should all have better S/O than this
body T_HTML_MESSAGE		eval:html_message()
score T_HTML_MESSAGE		0.0000001

# HTML input form tests (plus having an HTML form at all)
body T_HTML_INPUT_TYPE_HIDDEN	eval:html_test('input_type_hidden')
body T_HTML_INPUT_NAME_EMAIL	eval:html_test('input_name_email')
body T_HTML_INPUT_VALUE_EMAIL	eval:html_test('input_value_email')
body T_HTML_TAG_EXISTS_FORM     eval:html_tag_exists('form')
# HTML image tricks
body T_HTML_IMG_ALT_ONLY1	eval:html_test('img_alt_only1')
body T_HTML_IMG_ALT_ONLY2	eval:html_test('img_alt_only2')
body T_HTML_IMG_SRC_NO_IMAGE	eval:html_test('img_src_no_image')
# possible improvements for WEB_BUGS (code into HTML.pm if it works)
body T_HTML_WEB_BUGS1		eval:html_test('t_web_bugs1')
body T_HTML_WEB_BUGS2		eval:html_test('t_web_bugs2')
# possible improvements for HTML_JAVASCRIPT
body T_HTML_JAVASCRIPT		eval:html_test('t_javascript')

###########################################################################

# it's BANG, not PLING (Brits!)
# single word versions
body T_BANG_BOSS		/\bboss!/i
body T_BANG_CARTOONS		/\bcartoons!/i
body T_BANG_CYBERANALYSTS	/\bcyberanalysts!/i
body T_BANG_EXERCISE		/\bexercise!/i
body T_BANG_EXERCISER		/\bexerciser!/i
body T_BANG_EXERCISES		/\bexercises!/i
body T_BANG_FREEDOM		/\bfreedom!/i
body T_BANG_GUARANTEED		/\bguaranteed!/i
body T_BANG_MONEY		/\bmoney!/i
body T_BANG_OFFERED		/\boffered!/i
body T_BANG_OFFERS		/\boffers!/i
body T_BANG_OPRAH		/\boprah!/i
body T_BANG_QUOTE		/\bquote!/i
body T_BANG_QUOTES		/\bquotes!/i
body T_BANG_SLEEP		/\bsleep!/i
body T_BANG_SLEEPING		/\bsleeping!/i
body T_BANG_TRAFFIC		/\btraffic!/i
body T_BANG_WORLD		/\bworld!/i
body T_BANG_WORLDWIDE		/\bworldwide!/i
# a few multi-word variants with no FPs for me (test separately and
# use instead of single word versions if nobody has FP problems)
body T_BANG_EXERCISE_X		/\bexercis(?:e|er|es)!/i
body T_BANG_GUARANTEE_X		/\bguaranteed?\!/i
# just 'offer!' has FPs for me
body T_BANG_OFFER_X		/\boffer(?:ed|s)!/i
body T_BANG_QUOTE_X		/\bquotes?\!/i
body T_BANG_SLEEP_X		/\bsleep(?:ing)?\!/i
body T_BANG_WORLD_X		/\bworld(?:wide)?\!/i
# a few versions that are more case-sensitive
body T_BANG_MORE_C		/\b(?-i:M)ore!/i
body T_BANG_FREEDOM_C		/\b(?-i:F)reedom!/
body T_BANG_GUARANTEED_C	/\b(?-i:G)uaranteed?\!/i
body T_BANG_QUOTE_C		/\b(?-i:Q)uotes?\!/i

###########################################################################

# These seem to work well for me to find a "unique identifier" which happens
# to be a rot13 email address, note that these don't actually test for rot13
# encoding, they look for the obscuring of the "@" and "."  characters.
body T_ROT13_EMAIL		/^(\w+\^\S+\(\S+)(?:\s+\#+\s+\1)?\s*$/m
describe T_ROT13_EMAIL		Message has what looks like a ROT13 encoded email address

body T_ROT13_EMAIL_2		/^(\w+\^\S+\(\S+)(?:\s+\#+\s+\1)?[\s\n]*\Z/m
describe T_ROT13_EMAIL_2	Message has what looks like a ROT13 encoded email address

body T_ROT13_EMAIL_3		/^(\w+\^\S+\(\S+)/m
describe T_ROT13_EMAIL_3	Message has what looks like a ROT13 encoded email address

# should have all the hits of T_ROT13_EMAIL_3 but perhaps be slightly less
# prone to FPs
body T_ROT13_EMAIL_4		/^\w+\^\S+\(\w{2,3}\b/m
describe T_ROT13_EMAIL_4	Message has what looks like a ROT13 encoded email address

# mailman list reminder mails are getting tagged in 2.41, adding a rule to check for these
header __FROM_MAILMAN_OWNER	From:addr =~ /^mailman-owner@/
header __SUBJECT_MAILMAN_REMIND	Subject =~ /\bmailing list memberships reminder\b/
meta T_MAILMAN_REMINDER		(__FROM_MAILMAN_OWNER && __SUBJECT_MAILMAN_REMIND)
describe T_MAILMAN_REMINDER	Mail headers indicate a mailman membership reminder
score T_MAILMAN_REMINDER		-3
tflags T_MAILMAN_REMINDER nice

########################################################

header   T_NONSENSE_FROM_1      From:addr =~ /[^\W\daeiouy_-]{5}\S*\@/i
describe T_NONSENSE_FROM_1      From user name appears to be nonsense (1)

header   T_NONSENSE_FROM_2      From:addr =~ /[^\W\daeiouy_-]{6,}\S*\@/i
describe T_NONSENSE_FROM_2      From user name appears to be nonsense (2)

header   T_NONSENSE_FROM_00_10  eval:nonsense_from_percent('00', '10')
describe T_NONSENSE_FROM_00_10  0%-10% weird trigraphs in From

header   T_NONSENSE_FROM_10_20  eval:nonsense_from_percent('10', '20')
describe T_NONSENSE_FROM_10_20  10%-20% weird trigraphs in From

header   T_NONSENSE_FROM_20_30  eval:nonsense_from_percent('20', '30')
describe T_NONSENSE_FROM_20_30  20%-30% weird trigraphs in From

header   T_NONSENSE_FROM_30_40  eval:nonsense_from_percent('30', '40')
describe T_NONSENSE_FROM_30_40  30%-40% weird trigraphs in From

header   T_NONSENSE_FROM_40_50  eval:nonsense_from_percent('40', '50')
describe T_NONSENSE_FROM_40_50  40%-50% weird trigraphs in From

header   T_NONSENSE_FROM_50_60  eval:nonsense_from_percent('50', '60')
describe T_NONSENSE_FROM_50_60  50%-60% weird trigraphs in From

header   T_NONSENSE_FROM_60_70  eval:nonsense_from_percent('60', '70')
describe T_NONSENSE_FROM_60_70  60%-70% weird trigraphs in From

header   T_NONSENSE_FROM_70_80  eval:nonsense_from_percent('70', '80')
describe T_NONSENSE_FROM_70_80  70%-80% weird trigraphs in From

header   T_NONSENSE_FROM_80_90  eval:nonsense_from_percent('80', '90')
describe T_NONSENSE_FROM_80_90  80%-90% weird trigraphs in From

#header   T_NONSENSE_FROM_90_100 eval:nonsense_from_percent('90', '100')
#describe T_NONSENSE_FROM_90_100 90%-100% weird trigraphs in From

header   T_NONSENSE_FROM_90_91 eval:nonsense_from_percent('90', '91')
header   T_NONSENSE_FROM_91_92 eval:nonsense_from_percent('91', '92')
header   T_NONSENSE_FROM_92_93 eval:nonsense_from_percent('92', '93')
header   T_NONSENSE_FROM_93_94 eval:nonsense_from_percent('93', '94')
header   T_NONSENSE_FROM_94_95 eval:nonsense_from_percent('94', '95')
header   T_NONSENSE_FROM_95_96 eval:nonsense_from_percent('95', '96')
header   T_NONSENSE_FROM_96_97 eval:nonsense_from_percent('96', '97')
header   T_NONSENSE_FROM_97_98 eval:nonsense_from_percent('97', '98')
header   T_NONSENSE_FROM_98_99 eval:nonsense_from_percent('98', '99')
header   T_NONSENSE_FROM_99_100 eval:nonsense_from_percent('99', '100')

score   T_NONSENSE_FROM_00_10  0.01
score   T_NONSENSE_FROM_10_20  0.01
score   T_NONSENSE_FROM_20_30  0.01
score   T_NONSENSE_FROM_30_40  0.01
score   T_NONSENSE_FROM_40_50  0.01
score   T_NONSENSE_FROM_50_60  0.01
score   T_NONSENSE_FROM_60_70  0.01
score   T_NONSENSE_FROM_70_80  0.01
score   T_NONSENSE_FROM_80_90  0.01
#score   T_NONSENSE_FROM_90_100 0.01

score   T_NONSENSE_FROM_90_91 0.01
score   T_NONSENSE_FROM_91_92 0.01
score   T_NONSENSE_FROM_92_93 0.01
score   T_NONSENSE_FROM_93_94 0.01
score   T_NONSENSE_FROM_94_95 0.01
score   T_NONSENSE_FROM_95_96 0.01
score   T_NONSENSE_FROM_96_97 0.01
score   T_NONSENSE_FROM_97_98 0.01
score   T_NONSENSE_FROM_98_99 0.01
score   T_NONSENSE_FROM_99_100 0.01

############################################################

body T_HTML_IMAGE_AREA01	eval:html_range('total_image_area','0','1000')
body T_HTML_IMAGE_AREA02	eval:html_range('total_image_area','1000','5000')
body T_HTML_IMAGE_AREA03	eval:html_range('total_image_area','10000','20000')
body T_HTML_IMAGE_AREA04	eval:html_range('total_image_area','20000','30000')
body T_HTML_IMAGE_AREA05	eval:html_range('total_image_area','30000','40000')
body T_HTML_IMAGE_AREA06	eval:html_range('total_image_area','40000','50000')
body T_HTML_IMAGE_AREA07	eval:html_range('total_image_area','50000','60000')
body T_HTML_IMAGE_AREA08	eval:html_range('total_image_area','60000','70000')
body T_HTML_IMAGE_AREA09	eval:html_range('total_image_area','70000','80000')
body T_HTML_IMAGE_AREA10	eval:html_range('total_image_area','80000','90000')
body T_HTML_IMAGE_AREA11	eval:html_range('total_image_area','100000','200000')
body T_HTML_IMAGE_AREA12	eval:html_range('total_image_area','200000','300000')
body T_HTML_IMAGE_AREA13	eval:html_range('total_image_area','300000','400000')
body T_HTML_IMAGE_AREA14	eval:html_range('total_image_area','400000','500000')
body T_HTML_IMAGE_AREA15	eval:html_range('total_image_area','500000','600000')
body T_HTML_IMAGE_AREA16	eval:html_range('total_image_area','600000','700000')
body T_HTML_IMAGE_AREA17	eval:html_range('total_image_area','700000','800000')
body T_HTML_IMAGE_AREA18	eval:html_range('total_image_area','800000','900000')
body T_HTML_IMAGE_AREA19	eval:html_range('total_image_area','1000000')

body T_HTML_NUM_IMGS01          eval:html_range('num_imgs','0','1')
body T_HTML_NUM_IMGS02          eval:html_range('num_imgs','1','2')
body T_HTML_NUM_IMGS03          eval:html_range('num_imgs','2','3')
body T_HTML_NUM_IMGS04          eval:html_range('num_imgs','3','4')
body T_HTML_NUM_IMGS05          eval:html_range('num_imgs','4','5')
body T_HTML_NUM_IMGS06          eval:html_range('num_imgs','5','6')
body T_HTML_NUM_IMGS07          eval:html_range('num_imgs','6','7')
body T_HTML_NUM_IMGS08          eval:html_range('num_imgs','7','8')
body T_HTML_NUM_IMGS09          eval:html_range('num_imgs','8','9')
body T_HTML_NUM_IMGS10          eval:html_range('num_imgs','9','10')
body T_HTML_NUM_IMGS11          eval:html_range('num_imgs','10','20')
body T_HTML_NUM_IMGS12          eval:html_range('num_imgs','20','30')
body T_HTML_NUM_IMGS13          eval:html_range('num_imgs','30','40')
body T_HTML_NUM_IMGS14          eval:html_range('num_imgs','40','50')
body T_HTML_NUM_IMGS15          eval:html_range('num_imgs','50','60')
body T_HTML_NUM_IMGS16          eval:html_range('num_imgs','60','70')
body T_HTML_NUM_IMGS17          eval:html_range('num_imgs','70','80')
body T_HTML_NUM_IMGS18          eval:html_range('num_imgs','80','90')
body T_HTML_NUM_IMGS19          eval:html_range('num_imgs','90','100')
body T_HTML_NUM_IMGS20          eval:html_range('num_imgs','100')

body T_HTML_CONSEC_IMGS01       eval:html_range('max_consec_imgs','1','2')
body T_HTML_CONSEC_IMGS02       eval:html_range('max_consec_imgs','2','3')
body T_HTML_CONSEC_IMGS03       eval:html_range('max_consec_imgs','3','4')
body T_HTML_CONSEC_IMGS04       eval:html_range('max_consec_imgs','4','5')
body T_HTML_CONSEC_IMGS05       eval:html_range('max_consec_imgs','5','6')
body T_HTML_CONSEC_IMGS06       eval:html_range('max_consec_imgs','6','7')
body T_HTML_CONSEC_IMGS07       eval:html_range('max_consec_imgs','7','8')
body T_HTML_CONSEC_IMGS08       eval:html_range('max_consec_imgs','8','9')
body T_HTML_CONSEC_IMGS09       eval:html_range('max_consec_imgs','9','10')
body T_HTML_CONSEC_IMGS10       eval:html_range('max_consec_imgs','10','20')
body T_HTML_CONSEC_IMGS11       eval:html_range('max_consec_imgs','20','30')
body T_HTML_CONSEC_IMGS12       eval:html_range('max_consec_imgs','30','40')
body T_HTML_CONSEC_IMGS13       eval:html_range('max_consec_imgs','40','50')
body T_HTML_CONSEC_IMGS14       eval:html_range('max_consec_imgs','50','60')
body T_HTML_CONSEC_IMGS15       eval:html_range('max_consec_imgs','60','70')
body T_HTML_CONSEC_IMGS16       eval:html_range('max_consec_imgs','70','80')
body T_HTML_CONSEC_IMGS17       eval:html_range('max_consec_imgs','80','90')
body T_HTML_CONSEC_IMGS18       eval:html_range('max_consec_imgs','90','100')
body T_HTML_CONSEC_IMGS19       eval:html_range('max_consec_imgs','100')



body T_HTML_MAX_IMG_RATIO01     eval:html_range('max_img_ratio','0.0','0.5')
body T_HTML_MAX_IMG_RATIO02     eval:html_range('max_img_ratio','0.5','0.999')
meta T_HTML_MAX_IMG_RATIO02B    (T_HTML_MAX_IMG_RATIO02 && !FROM_EGROUPS)
body T_HTML_MAX_IMG_RATIO03     eval:html_range('max_img_ratio','5','10')
meta T_HTML_MAX_IMG_RATIO03B    (T_HTML_MAX_IMG_RATIO03 && !FROM_EGROUPS)
body T_HTML_MAX_IMG_RATIO04     eval:html_range('max_img_ratio','10','20')
body T_HTML_MAX_IMG_RATIO05     eval:html_range('max_img_ratio','20','30')
body T_HTML_MAX_IMG_RATIO06     eval:html_range('max_img_ratio','30','40')
body T_HTML_MAX_IMG_RATIO07     eval:html_range('max_img_ratio','40','50')
body T_HTML_MAX_IMG_RATIO08     eval:html_range('max_img_ratio','50','75')
body T_HTML_MAX_IMG_RATIO09     eval:html_range('max_img_ratio','75','100')
body T_HTML_MAX_IMG_RATIO10     eval:html_range('max_img_ratio','100')

body T_HTML_MIN_IMG_RATIO1      eval:html_range('min_img_ratio','0.0','0.01')
body T_HTML_MIN_IMG_RATIO2      eval:html_range('min_img_ratio','0.01','0.1')
body T_HTML_MIN_IMG_RATIO3      eval:html_range('min_img_ratio','0.1','0.25')
body T_HTML_MIN_IMG_RATIO4      eval:html_range('min_img_ratio','0.25','0.50')
body T_HTML_MIN_IMG_RATIO5      eval:html_range('min_img_ratio','0.50','0.75')
body T_HTML_MIN_IMG_RATIO6      eval:html_range('min_img_ratio','0.75','0.999')

#---------------------------------------------------------

meta T_HTML_NUM_IMGS01B         (T_HTML_NUM_IMGS01 && !FROM_EGROUPS)
meta T_HTML_NUM_IMGS02B         (T_HTML_NUM_IMGS02 && !FROM_EGROUPS)

meta T_HTML_CONSEC_IMGS01B      (T_HTML_CONSEC_IMGS01 && !FROM_EGROUPS)

meta T_HTML_IMAGE_AREA03B       (T_HTML_IMAGE_AREA03 && !FROM_EGROUPS)
meta T_HTML_IMAGE_AREA04B       (T_HTML_IMAGE_AREA04 && !FROM_EGROUPS)
meta T_HTML_IMAGE_AREA05B       (T_HTML_IMAGE_AREA05 && !FROM_EGROUPS)
meta T_HTML_IMAGE_AREA06B       (T_HTML_IMAGE_AREA06 && !FROM_EGROUPS)

# HTML_50_70 with at least 3 IMG tags
body __T_HTML_NUM_IMGS_3        eval:html_range('num_imgs','3')
meta T_HTML_50_70_IMGS3         (HTML_50_70 && __T_HTML_NUM_IMGS_3)

#---------------------------------------------------------

score T_HTML_IMAGE_AREA01        0.01
score T_HTML_IMAGE_AREA02        0.01
score T_HTML_IMAGE_AREA03        0.01
score T_HTML_IMAGE_AREA04        0.01
score T_HTML_IMAGE_AREA05        0.01
score T_HTML_IMAGE_AREA06        0.01
score T_HTML_IMAGE_AREA07        0.01
score T_HTML_IMAGE_AREA08        0.01
score T_HTML_IMAGE_AREA09        0.01
score T_HTML_IMAGE_AREA10        0.01
score T_HTML_IMAGE_AREA11        0.01
score T_HTML_IMAGE_AREA12        0.01
score T_HTML_IMAGE_AREA13        0.01
score T_HTML_IMAGE_AREA14        0.01
score T_HTML_IMAGE_AREA15        0.01
score T_HTML_IMAGE_AREA16        0.01
score T_HTML_IMAGE_AREA17        0.01
score T_HTML_IMAGE_AREA18        0.01
score T_HTML_IMAGE_AREA19        0.01

score T_HTML_NUM_IMGS01          0.01
score T_HTML_NUM_IMGS02          0.01
score T_HTML_NUM_IMGS03          0.01
score T_HTML_NUM_IMGS04          0.01
score T_HTML_NUM_IMGS05          0.01
score T_HTML_NUM_IMGS06          0.01
score T_HTML_NUM_IMGS07          0.01
score T_HTML_NUM_IMGS08          0.01
score T_HTML_NUM_IMGS09          0.01
score T_HTML_NUM_IMGS10          0.01
score T_HTML_NUM_IMGS11          0.01
score T_HTML_NUM_IMGS12          0.01
score T_HTML_NUM_IMGS13          0.01
score T_HTML_NUM_IMGS14          0.01
score T_HTML_NUM_IMGS15          0.01
score T_HTML_NUM_IMGS16          0.01
score T_HTML_NUM_IMGS17          0.01
score T_HTML_NUM_IMGS18          0.01
score T_HTML_NUM_IMGS19          0.01
score T_HTML_NUM_IMGS20          0.01

score T_HTML_CONSEC_IMGS01       0.01
score T_HTML_CONSEC_IMGS02       0.01
score T_HTML_CONSEC_IMGS03       0.01
score T_HTML_CONSEC_IMGS04       0.01
score T_HTML_CONSEC_IMGS05       0.01
score T_HTML_CONSEC_IMGS06       0.01
score T_HTML_CONSEC_IMGS07       0.01
score T_HTML_CONSEC_IMGS08       0.01
score T_HTML_CONSEC_IMGS09       0.01
score T_HTML_CONSEC_IMGS10       0.01
score T_HTML_CONSEC_IMGS11       0.01
score T_HTML_CONSEC_IMGS12       0.01
score T_HTML_CONSEC_IMGS13       0.01
score T_HTML_CONSEC_IMGS14       0.01
score T_HTML_CONSEC_IMGS15       0.01
score T_HTML_CONSEC_IMGS16       0.01
score T_HTML_CONSEC_IMGS17       0.01
score T_HTML_CONSEC_IMGS18       0.01
score T_HTML_CONSEC_IMGS19       0.01


score T_HTML_MAX_IMG_RATIO01     0.01
score T_HTML_MAX_IMG_RATIO02     0.01
score T_HTML_MAX_IMG_RATIO02B    0.01
score T_HTML_MAX_IMG_RATIO03     0.01
score T_HTML_MAX_IMG_RATIO03B    0.01
score T_HTML_MAX_IMG_RATIO04     0.01
score T_HTML_MAX_IMG_RATIO05     0.01
score T_HTML_MAX_IMG_RATIO06     0.01
score T_HTML_MAX_IMG_RATIO07     0.01
score T_HTML_MAX_IMG_RATIO08     0.01
score T_HTML_MAX_IMG_RATIO09     0.01
score T_HTML_MAX_IMG_RATIO10     0.01

score T_HTML_MIN_IMG_RATIO1      0.01
score T_HTML_MIN_IMG_RATIO2      0.01
score T_HTML_MIN_IMG_RATIO3      0.01
score T_HTML_MIN_IMG_RATIO4      0.01
score T_HTML_MIN_IMG_RATIO5      0.01
score T_HTML_MIN_IMG_RATIO6      0.01


score T_HTML_NUM_IMGS01B         0.01
score T_HTML_NUM_IMGS02B         0.01
score T_HTML_CONSEC_IMGS01B      0.01
score T_HTML_IMAGE_AREA03B       0.01
score T_HTML_IMAGE_AREA04B       0.01
score T_HTML_IMAGE_AREA05B       0.01
score T_HTML_IMAGE_AREA06B       0.01
score T_HTML_50_70_IMGS3         0.01

####################################################################

header T_FROM_ENDS_IN_NUMS1       From =~ /\D\d\@/
header T_FROM_ENDS_IN_NUMS2       From =~ /\D\d\d\@/
header T_FROM_ENDS_IN_NUMS3       From =~ /\D\d\d\d\@/
header T_FROM_ENDS_IN_NUMS4       From =~ /\D\d\d\d\d\@/
header T_FROM_ENDS_IN_NUMS5       From =~ /\D\d\d\d\d\d\@/
header T_FROM_ENDS_IN_NUMS6       From =~ /\d\d\d\d\d\d\@/

score T_FROM_ENDS_IN_NUMS1       0.01
score T_FROM_ENDS_IN_NUMS2       0.01
score T_FROM_ENDS_IN_NUMS3       0.01
score T_FROM_ENDS_IN_NUMS4       0.01
score T_FROM_ENDS_IN_NUMS5       0.01
score T_FROM_ENDS_IN_NUMS6       0.01

############################################################

meta T_CONFIRMED_FORGED         (FORGED_RCVD_TRAIL && (FORGED_AOL_RCVD || FORGED_HOTMAIL_RCVD || FORGED_EUDORAMAIL_RCVD || FORGED_YAHOO_RCVD || FORGED_JUNO_RCVD || FORGED_GW05_RCVD || FORGED_MX_HOTMAIL))

meta T_MULTI_FORGED             ((FORGED_AOL_RCVD + FORGED_HOTMAIL_RCVD + FORGED_EUDORAMAIL_RCVD + FORGED_YAHOO_RCVD + FORGED_JUNO_RCVD + FORGED_GW05_RCVD) > 1)

###########################################################

body T_HTML_TAG_EXISTS_CENTER    eval:html_tag_exists('center')
body T_HTML_TAG_EXISTS_HX        eval:html_test('header_tag')

body T_HTML_BIG_FONT_B           eval:html_test('big_font_B')
body T_HTML_FONT_SIZE_PX         eval:html_test('font_px')
body T_HTML_STYLE_LINE_HEIGHT    eval:html_test('line_height')

body T_HTML_SHOUTING1            eval:html_range('max_shouting','0','1')
body T_HTML_SHOUTING2            eval:html_range('max_shouting','1','2')
body T_HTML_SHOUTING3            eval:html_range('max_shouting','2','3')
body T_HTML_SHOUTING4            eval:html_range('max_shouting','3','4')
body T_HTML_SHOUTING5            eval:html_range('max_shouting','4','5')
body T_HTML_SHOUTING6            eval:html_range('max_shouting','5','6')
body T_HTML_SHOUTING7            eval:html_range('max_shouting','6','7')
body T_HTML_SHOUTING8            eval:html_range('max_shouting','7','8')
body T_HTML_SHOUTING9            eval:html_range('max_shouting','8')

score T_HTML_SHOUTING1            0.01
score T_HTML_SHOUTING2            0.01
score T_HTML_SHOUTING3            0.01
score T_HTML_SHOUTING4            0.01
score T_HTML_SHOUTING5            0.01
score T_HTML_SHOUTING6            0.01
score T_HTML_SHOUTING7            0.01
score T_HTML_SHOUTING8            0.01
score T_HTML_SHOUTING9            0.01


##################################################################

body T_HTML_MAIL_ONLY             /HTML only email, sorry/i

