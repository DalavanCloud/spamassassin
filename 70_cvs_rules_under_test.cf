# SpamAssassin rules file: CVS rules under test
#
# This file is a placeholder for rules "under probation", ie. checked into
# CVS for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
###########################################################################

# new MIME_BOUND tests
#
# results for quinlan:
#  1.350    4.145    0.000    1.00    0.87    1.00  T_MIME_BOUND_NEXTPART
#  0.911    2.799    0.000    1.00    0.84    1.00  T_MIME_BOUND_DASH_DIGIT
#  0.131    0.404    0.000    1.00    0.71    1.00  T_MIME_BOUND_MANY_HEX
#  0.123    0.377    0.000    1.00    0.71    1.00  T_MIME_BOUND_TEP

# This may need tweaking if new NextPart formats appear.
header __NEXTPART_ALL		Content-Type =~ /NextPart/
header __NEXTPART_NORMAL	Content-Type =~ /-{3}[-_]=_NextPart_[\dA-F]{3}(_[\dA-F]{3,8})?_[\dA-F]{8}.[\dA-F]{8}\b/
meta T_MIME_BOUND_NEXTPART	(__NEXTPART_ALL && !__NEXTPART_NORMAL)
score T_MIME_BOUND_NEXTPART	1.0

header T_MIME_BOUND_DASH_DIGIT	Content-Type =~ /boundary="_-{10}=_\d{19,22}"/
score T_MIME_BOUND_DASH_DIGIT	1.0

header T_MIME_BOUND_MANY_HEX	Content-Type =~ /boundary="[\da-f]{8}(?:-[\da-f]{4}){3}-[\da-f]{12}"/
score T_MIME_BOUND_MANY_HEX	1.0

header T_MIME_BOUND_TEP		Content-Type =~ /boundary="TEP-\d{9,10}\.\d{10}\.\d{10}"/
score T_MIME_BOUND_TEP		1.0

# results for quinlan
#  0.149    0.458    0.000    1.00    0.72    0.50  T_FROM_TOPICA
header T_FROM_TOPICA		From:addr =~ /\@(?:\w+\.)?email-publisher\.com$/
describe T_FROM_TOPICA		From an address at email-publisher.com
score T_FROM_TOPICA		0.5

# results for quinlan
#  0.245    0.727    0.013    0.98    0.57    0.50  T_FROM_ALL_NUMS
header __FROM_JUST_NUMBER	From:addr =~ /^\d+\@/
header __FROM_PHONE		From:addr =~ /^\d{3}(?:[-.]?\d{3}[-.]?\d{4}|\d{7})\@/
meta T_FROM_ALL_NUMS		(__FROM_JUST_NUMBER && !__FROM_PHONE)
describe T_FROM_ALL_NUMS	From an address that is all numbers (non-phone)
score T_FROM_ALL_NUMS		0.5

# results for quinlan
#  0.482    1.454    0.013    0.99    0.61    0.50  T_SOME_BREAKTHROUGH
body T_SOME_BREAKTHROUGH	/(?:science|medical|major|scientific|fundamental|technology|revolutionary)\s+breakthrough/i
score T_SOME_BREAKTHROUGH	0.5

# results for quinlan
#  0.193    0.592    0.000    1.00    0.74    0.50  T_SELECTED_YOU
body T_SELECTED_YOU		/(?:you (?:have been|were) selected|we (?:have )?selected you)/i
score T_SELECTED_YOU		0.5

# jm: somehow these guys keep slipping through, and they're very persistent.
# they use both azoogle.com and azogle.com, but this header is always
# in this format.
header T_AZOOGLE                X-Info =~ /service to abuse\@azoogle\.com$/
describe T_AZOOGLE              From azoogle.com, azogle.com, etc.
score T_AZOOGLE                 3.0

# some ratware makes random usernames with lots of numbers
# now requires that addr starts with a number, try to cut down FPs,
# since prev versions hit on TMDA addresses!
header T_FROM_HAS_LOTSA_NUMS2_4      From:addr =~ /^\d(?:\d[^\@\s]*){4}\@/
header T_FROM_HAS_LOTSA_NUMS2_5      From:addr =~ /^\d(?:\d[^\@\s]*){5}\@/
header T_FROM_HAS_LOTSA_NUMS3_3      From:addr =~ /^\d\d(?:[^\d\@\s]*\d){3}[^\@\s]*\@/
header T_FROM_HAS_LOTSA_NUMS3_4      From:addr =~ /^\d\d(?:[^\d\@\s]*\d){4}[^\@\s]*\@/
header T_FROM_HAS_LOTSA_NUMS3_5      From:addr =~ /^\d\d(?:[^\d\@\s]*\d){5}[^\@\s]*\@/
header T_FROM_HAS_LOTSA_NUMS3_6      From:addr =~ /^\d\d(?:[^\d\@\s]*\d){6}[^\@\s]*\@/

# variants that require >= 1 non-digit
header T_FROM_HAS_ALPHAS           From:addr =~ /[a-zA-Z][^\@\s]+\@/
score T_FROM_HAS_ALPHAS 0.1
meta T_FROM_HAS_LOTSA_NUMS4_3      (T_FROM_HAS_LOTSA_NUMS3_3 && __T_FROM_HAS_ALPHAS)
meta T_FROM_HAS_LOTSA_NUMS4_4      (T_FROM_HAS_LOTSA_NUMS3_4 && __T_FROM_HAS_ALPHAS)
meta T_FROM_HAS_LOTSA_NUMS4_5      (T_FROM_HAS_LOTSA_NUMS3_5 && __T_FROM_HAS_ALPHAS)
meta T_FROM_HAS_LOTSA_NUMS4_6      (T_FROM_HAS_LOTSA_NUMS3_6 && __T_FROM_HAS_ALPHAS)

