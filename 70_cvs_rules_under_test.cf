# SpamAssassin rules file: CVS rules under test
#
# This file is a placeholder for rules "under probation", ie. checked into
# CVS for testing. It should not be distributed; if the rules have good
# stats after a mass-check or two, then fold them into the distributed
# rules files.
#
# I suggest adding a prefix to rules in this file, "T_" -- this
# helps identify probationary rules in test output.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of either the Artistic License or the GNU General
# Public License as published by the Free Software Foundation; either
# version 1 of the License, or (at your option) any later version.
#
# See the file "License" in the top level of the SpamAssassin source
# distribution for more details.
#
###########################################################################

# quinlan: I worked at a company that used CorporateTime which very annoyingly
# always used an ISO-8859-1 encoded header even when the Subject: did not have
# a non-ASCII character.  I think other false positives are likely due to
# similarly broken software.
# jm: I notice that all my FPs are gw'd thru IMS; let's try that.
header __SUBJ_BASE64			Subject:raw =~ /=\?[^\?]+\?B\?/
header __SUBJ_QP			Subject:raw =~ /=\?[^\?]+\?Q\?/
header __SUBJ_HAS_NON_ASCII		Subject =~ /[\x00-\x06\x0e-\x1f\x80-\xff]/
header __RCVD_IMS			Received =~ /Internet\s+Mail\s+Service/
meta T_UNNECESSARY_SUBJ_B64_ENCODING	(__SUBJ_BASE64 && !__SUBJ_HAS_NON_ASCII && !__RCVD_IMS)
meta T_UNNECESSARY_SUBJ_QP_ENCODING	(__SUBJ_QP && !__SUBJ_HAS_NON_ASCII && !__RCVD_IMS)
describe T_UNNECESSARY_SUBJ_B64_ENCODING Subject encoded to hide from filters (B64)
describe T_UNNECESSARY_SUBJ_QP_ENCODING Subject encoded to hide from filters (QP)

# A new spamware creates invalid Date stamps, using printf ("%d:%d:%d").
# Catch it here (assuming one of the above doesn't catch it anyway).
# NOTE: __XM_BAD_DATE_MUAS is used below
header __DATE_TIME_INVALID	Date =~ /\s(?!\d\d:\d\d:\d\d)\d{1,2}:\d{1,2}:\d{1,2}\s/
header __XM_BAD_DATE_MUAS	X-Mailer =~ /(?:FoxMail|EMUmail|TFS Secure Messaging|sendEmail|EarthLink MailBox \d\.\d)/i
meta T_INVALID_DATE_HMS		(__DATE_TIME_INVALID && !__XM_BAD_DATE_MUAS)
describe T_INVALID_DATE_HMS	Date header does not use valid HH:MM:SS formatting

# possible replacement for INVALID_DATE.
# NOTE: uses __XM_BAD_DATE_MUAS from above
# rfc822:                       date-time =          [ day-of-week "," ]         (day / obs-day)                 month                           (year / obs-year)   hour ":" minute [ ":" second ]       (zone / obs-zone)          [ comment ]
header __INVALID_DATE		Date !~ /^\s*(?:(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), )?[0-3 ]?[0-9] (?:Jan|Feb|Ma[ry]|Apr|Ju[nl]|Aug|Sep|Oct|Nov|Dec) (?:19|20)?[0-9]{2} [0-2][0-9](?:\:[0-5][0-9]){1,2} (?:[+-][0-9]{4}|UT|[A-Z]{2,3}T)(?:\s+\(.*\))?\s*$/ [if-unset: Mon, 24 Feb 2003 09:30 +0100 (mss)]
header __XM_FOXMAIL		X-Mailer =~ /FoxMail/
meta T_INVALID_DATE_2		(__INVALID_DATE && !__XM_BAD_DATE_MUAS)
describe T_INVALID_DATE_2	Invalid Date: header (not RFC 2822)

# Wierd.  Can only assume this is caused by PEBKAC on the sending side...
meta T_HTML_WITHOUT_HTML_1	(MIME_HTML_ONLY && !HTML_MESSAGE)
describe T_HTML_WITHOUT_HTML_1	Claims to be HTML, but there is no HTML text
# uses __MIME_HTML test from below and eval in EvalTests.pm (at least for now)
meta T_HTML_WITHOUT_HTML_2	(__MIME_HTML && !HTML_MESSAGE)
describe T_HTML_WITHOUT_HTML_2	Claims to be HTML, but there is no HTML text

# 2003-02-23: quinlan
# bug 1376: HTML without <!DOCTYPE> from mailers that always use <!DOCTYPE>
#
# Note: some variations of this rule actually perform better, but they all
# overlap 96-100% with MIME_HTML_ONLY whereas this variation adds real value
# and has a high hit rate.
body __HTML_TAG_EXISTS_DOCTYPE	eval:html_tag_exists('!doctype')
meta T_MIME_HTML_NO_DOCTYPE	(__MIME_HTML && !__HTML_TAG_EXISTS_DOCTYPE)

# 2003-02-25: quinlan
# Whee... more HTML tests!
# Note: these use __MIME_HTML, we might need to exempt MIME attachments from
# that rule
# Apr 22 2003 jm: removed __TAG_EXISTS_DIV from OUTLOOK, as 'MS Exchange
# Server version 6.0.4630.0' does not insert that, causing FPs
# my FPs for this should hopefully be fixed now
# ... place with brother rule in 20_ratware.cf
header __ANY_QUALCOMM_MUA	X-Mailer =~ /^QUALCOMM\b/
meta T_FORGED_QUALCOMM_TAGS	(__ANY_QUALCOMM_MUA && __MIME_HTML && !__TAG_EXISTS_HTML)

# MIME Content-Transfer-Encoding control rules
rawbody T_MIME_BASE64			eval:check_for_mime('t_mime_base64_count')
rawbody T_MIME_QP			eval:check_for_mime('t_mime_qp_count')

# 2003-03-06: quinlan
rawbody T_MIME_BASE64_BLANKS		eval:check_for_mime('t_mime_base64_blanks')
rawbody T_MIME_BASE64_ILLEGAL		eval:check_for_mime('t_mime_base64_illegal')
rawbody T_MIME_BASE64_WITHOUT_NAME	eval:check_for_mime('t_mime_base64_without_name')
rawbody T_MIME_QP_INLINE_NO_CHARSET	eval:check_for_mime('t_mime_qp_inline_no_charset')

# quinlan: 2003-03-15
# these all appear in the same low-scoring spammer for me, but they
# might differ for others so I'm trying some different URLs, check
# overlap in others' results before committing anything
#
# quinlan: 2003-03-28: does ANYONE other than me have any hits for these?
#
# Apr  1 2003 jm: constantcontact is a spamtool, also used in legit mailouts
# by a Java company :(
#
# 2003-05-05 quinlan: reduced to shorter list of high S/O rules that hit
# more than just me, not sure if any are worth it
header T_CONSTANTCONTACT		ALL =~ /\bconstantcontact\.com\b/i
header T_ROVING_COM			ALL =~ /\broving\.com\b/i
uri T_RS6_NET_URL			/\brs6\.net\b/i

uri      T_HTTP_EXCESSIVE_ENTITIES m{^https?://\S*\&\#(?:0?3[0-9]|0?[46][1-9a-f]|0?[57][\da])}i
describe T_HTTP_EXCESSIVE_ENTITIES Completely unnecessary %-escapes inside a URL

body T_BLANK_LINE_RATIO_04_70_80	eval:check_blank_line_ratio('70','80','4')
body T_BLANK_LINE_RATIO_04_80_90	eval:check_blank_line_ratio('80','90','4')
body T_BLANK_LINE_RATIO_04_90_92	eval:check_blank_line_ratio('90','92','4')
body T_BLANK_LINE_RATIO_04_92_94	eval:check_blank_line_ratio('92','94','4')
body T_BLANK_LINE_RATIO_04_94_96	eval:check_blank_line_ratio('94','96','4')
body T_BLANK_LINE_RATIO_04_96_98	eval:check_blank_line_ratio('96','98','4')
body T_BLANK_LINE_RATIO_04_98_100	eval:check_blank_line_ratio('98','100','4')
body T_BLANK_LINE_RATIO_04_70_100	eval:check_blank_line_ratio('70','100','4')

###########################################################################

# per bug 1373
body __HTML_COMMENT_RATIO_70_80		eval:html_range('total_comment_ratio','0.70','0.80')
body __HTML_COMMENT_RATIO_80_90		eval:html_range('total_comment_ratio','0.80','0.90')
body __HTML_COMMENT_RATIO_90_100	eval:html_range('total_comment_ratio','0.90','0.100')
body __HTML_COMMENT_RATIO_70_100	eval:html_range('total_comment_ratio','0.70','0.100')
meta T_HTML_COMMENT_RATIO_70_80_MIME_HTML_ONLY		__HTML_COMMENT_RATIO_70_80 && MIME_HTML_ONLY
meta T_HTML_COMMENT_RATIO_80_90_MIME_HTML_ONLY		__HTML_COMMENT_RATIO_80_90 && MIME_HTML_ONLY
meta T_HTML_COMMENT_RATIO_90_100_MIME_HTML_ONLY		__HTML_COMMENT_RATIO_90_100 && MIME_HTML_ONLY
meta T_HTML_COMMENT_RATIO_70_100_MIME_HTML_ONLY		__HTML_COMMENT_RATIO_70_100 && MIME_HTML_ONLY

header T_RATWARE_RCVD_BONUS_SPC	Received =~ /\) by  [a-zA-Z0-9]/
describe T_RATWARE_RCVD_BONUS_SPC Received headers forged (extra spaces)

# quinlan: How much better are these than MIME_HTML_ONLY?  I'm concerned
# it's a bit too easy to create high S/O rules with MIME_HTML_ONLY
meta T_MIME_HTML_NO_HTML_TAG	MIME_HTML_ONLY && !__TAG_EXISTS_HTML
meta T_MIME_HTML_NO_BODY_TAG	MIME_HTML_ONLY && !__TAG_EXISTS_BODY
# but we'll try this anyway
meta T_MIME_HTML_NO_MAJOR_TAG	MIME_HTML_ONLY && !__TAG_EXISTS_HTML && !__TAG_EXISTS_BODY

# 2003-02-23: quinlan
# Message-Id: format tests
# hotmail
header T_MSGID_ADDED_BY_HOTMAIL_1	Message-Id =~ /<MC\d{1,2}-F{1,2}\w{21,22}\@\S*hotmail\.com>/
header T_MSGID_ADDED_BY_HOTMAIL_2	Message-Id =~ /<[A-Z]{2}\d{1,2}-F{1,2}\w{21,22}\@\S*hotmail\.com>/
# 13 hexadecimal digits instead of 12
header T_MSGID_OUTLOOK_HEX	Message-Id =~ /<[a-f0-9]{13}\$[a-f0-9]{8}\$[a-f0-9]{8}\@/
# this one high correlation with ratware "EMWAC SMTPRS"
header T_MSGID_B_DIGITS		Message-Id =~ /<B\d{10}\@/
# pretty good spamware sign, looks like it uses random numbers with no padding
#   Message-Id: <\d{1,3}\.\d{1,6}\.\d{1,6}@\S+>h
#   usually also has INVALID_DATE and NO_REAL_NAME
# excludes perhaps 27.0%
header T_MSGID_THREESIXSIX	Message-Id =~ /<\d{3}\.\d{6}\.\d{6}\@\S+>/
# excludes perhaps 2.9%
header T_MSGID_THREESIXSIX_00	Message-Id =~ /<\d{2,3}\.\d{5,6}\.\d{5,6}\@\S+>/
# excludes perhaps 2.0%
header T_MSGID_THREESIXSIX_01	Message-Id =~ /<\d{1,3}\.\d{5,6}\.\d{5,6}\@\S+>/
# excludes perhaps 0.2%
header T_MSGID_THREESIXSIX_02	Message-Id =~ /<\d{1,3}\.\d{4,6}\.\d{4,6}\@\S+>/
# excludes perhaps 0.02%
header T_MSGID_THREESIXSIX_03	Message-Id =~ /<\d{1,3}\.\d{3,6}\.\d{3,6}\@\S+>/
# excludes nothing
header T_MSGID_THREESIXSIX_04	Message-Id =~ /<\d{1,3}\.\d{1,6}\.\d{1,6}\@\S+>/
# same except with stricter domain
header T_MSGID_THREESIXSIX_05	Message-Id =~ /<\d{3}\.\d{6}\.\d{6}\@(?:[\w-]+\.)*\w+>/
header T_MSGID_THREESIXSIX_06	Message-Id =~ /<\d{2,3}\.\d{5,6}\.\d{5,6}\@(?:[\w-]+\.)*\w+>/
header T_MSGID_THREESIXSIX_07	Message-Id =~ /<\d{1,3}\.\d{5,6}\.\d{5,6}\@(?:[\w-]+\.)*\w+>/
header T_MSGID_THREESIXSIX_08	Message-Id =~ /<\d{1,3}\.\d{4,6}\.\d{4,6}\@(?:[\w-]+\.)*\w+>/
header T_MSGID_THREESIXSIX_09	Message-Id =~ /<\d{1,3}\.\d{3,6}\.\d{3,6}\@(?:[\w-]+\.)*\w+>/
header T_MSGID_THREESIXSIX_10	Message-Id =~ /<\d{1,3}\.\d{1,6}\.\d{1,6}\@(?:[\w-]+\.)*\w+>/

# NOTE: uses __ANY_OUTLOOK_MUA.  This catches Send-Safe and a few others
header __OL_STYLE_FROM		From =~ /\".*\" <.+>/
header __VIA_FROM_MANGLER	Received =~ /iPlanet/
meta T_FORGED_MUA_OUTLOOK_FROM	(__ANY_OUTLOOK_MUA && !__OL_STYLE_FROM && !__VIA_FROM_MANGLER)
describe T_FORGED_MUA_OUTLOOK_FROM Forged mail pretending to be from Outlook (by From)

# NOTE: uses __ANY_IMS_MUA from above, __CTYPE_HAS_BOUNDARY from 20_ratware.cf
header __IMS_BOUNDARY		Content-Type =~ /\n\s+boundary=\"----_=_NextPart_[\dA-F]+_[\dA-F]+.[\dA-F]+\"/s
meta T_FORGED_IMS_CTYPE		(__ANY_IMS_MUA && __CTYPE_HAS_BOUNDARY && !__IMS_BOUNDARY)
describe T_FORGED_IMS_CTYPE	Forged mail pretending to be from IMS (boundary)

# NOTE: uses __ANY_QUALCOMM_MUA, __VIA_FROM_MANGLER from above
header __EUD_STYLE_FROM		From =~ /^(?:[^\"][^']+[^\"]|\".*\'.*\") <[^>]+>$/
meta T_FORGED_MUA_EUDORA_FROM	(__ANY_QUALCOMM_MUA && !__EUD_STYLE_FROM && !__VIA_FROM_MANGLER)
describe T_FORGED_MUA_EUDORA_FROM Forged mail pretending to be from Eudora (by From)

# Thanks to Brian J. Peterson for this
# Catches spams sent by illiterate spammer ("secks", "whoarez" etc.)
header T_RATWARE_MIZSPEELING	eval:check_for_mizspeeling_ratware()
describe T_RATWARE_MIZSPEELING	Sent using spammer tool (mizspeeling)

# quinlan: entire corpus, then last 2000 spam and 2000 ham:
# 18.125  36.2000   0.0500    0.999   0.95    0.01  T_RCVD_IN_MONKEYS_UPL
#  7.766  19.0844   0.0678    0.996   0.94    0.01  T_RCVD_IN_MONKEYS_UPL
header T_RCVD_IN_MONKEYS_UPL	rbleval:check_rbl_txt('relay', 'proxies.relays.monkeys.com.')
describe T_RCVD_IN_MONKEYS_UPL	Received via a relay in proxies.relays.monkeys.com.
tflags T_RCVD_IN_MONKEYS_UPL net

# quinlan: entire corpus, then last 2000 spam and 2000 ham:
#  0.686   1.5620   0.0904    0.945   0.79    0.01  T_RCVD_IN_DYNABLOCK
#  0.775   1.5000   0.0500    0.968   0.82    0.01  T_RCVD_IN_DYNABLOCK
header T_RCVD_IN_DYNABLOCK	rbleval:check_rbl('dynablock-notfirsthop', 'dynablock.wirehub.net.')
tflags T_RCVD_IN_DYNABLOCK	net

# mixed list, still need to check for cost, policies, etc.
header T_RCVD_IN_DEADBEEF	rbleval:check_rbl('deadbeef', 'bl.deadbeef.com.')
header T_RCVD_IN_DNSBLINFO	rbleval:check_rbl('dnsblinfo', 'spamsources.dnsbl.info.')
header T_RCVD_IN_DNSRBLSPAM	rbleval:check_rbl('dnsrblspam', 'spam.dnsrbl.net.')
header T_RCVD_IN_GIPPER	rbleval:check_rbl('gipper', 'proxy.bl.gweep.ca.')
header T_RCVD_IN_INTERSIL	rbleval:check_rbl('intersil', 'blackholes.intersil.net.')
header T_RCVD_IN_RELAYS_KUNDENSERVER	rbleval:check_rbl('kundenserver', 'relays.bl.kundenserver.de.')
header T_RCVD_IN_SPAMSOURCES_FABEL	rbleval:check_rbl('fabel', 'spamsources.fabel.dk.')
header T_RCVD_IN_VOX_SCHPIDER_COM	rbleval:check_rbl('schpider', 'vox.schpider.com.')
header T_RCVD_IN_WSFF		rbleval:check_rbl('wsff', 'will-spam-for-food.eu.org.')
tflags T_RCVD_IN_DEADBEEF net
tflags T_RCVD_IN_DNSBLINFO net
tflags T_RCVD_IN_DNSRBLSPAM net
tflags T_RCVD_IN_GIPPER net
tflags T_RCVD_IN_INTERSIL net
tflags T_RCVD_IN_RELAYS_KUNDENSERVER net
tflags T_RCVD_IN_SPAMSOURCES_FABEL net
tflags T_RCVD_IN_VOX_SCHPIDER_COM net
tflags T_RCVD_IN_WSFF net

# wirehub
header T_RCVD_IN_WIREHUB_BH	rbleval:check_rbl('wirehub', 'blackholes.wirehub.net.')
tflags T_RCVD_IN_WIREHUB_BH net
header T_RCVD_IN_WIREHUB_PROXIES	rbleval:check_rbl('pbwn', 'proxies.blackholes.wirehub.net.')
tflags T_RCVD_IN_WIREHUB_PROXIES net

# OPM sub-tests
# transfers: axfr/ixfr for trusted sites
# url: http://opm.blitzed.org/
# pay-to-use: no
# delist: automatic expiry, no fee, retested on request (free)
header T_RCVD_IN_OPM_WINGATE		rbleval:check_rbl_sub('opm', '1')
tflags T_RCVD_IN_OPM_WINGATE net
header T_RCVD_IN_OPM_SOCKS		rbleval:check_rbl_sub('opm', '2')
tflags T_RCVD_IN_OPM_SOCKS net
header T_RCVD_IN_OPM_HTTP_CONNECT	rbleval:check_rbl_sub('opm', '4')
tflags T_RCVD_IN_OPM_HTTP_CONNECT net
header T_RCVD_IN_OPM_ROUTER		rbleval:check_rbl_sub('opm', '8')
tflags T_RCVD_IN_OPM_ROUTER net
header T_RCVD_IN_OPM_HTTP_POST		rbleval:check_rbl_sub('opm', '16')
tflags T_RCVD_IN_OPM_HTTP_POST net

# fiveten - many blacklists, but only the bulk one performs well
# transfers: not specified, unknown
# url: http://blackholes.five-ten-sg.com/
# pay-to-use: no
# delist: email address contact provided
header __FIVETEN	rbleval:check_rbl('fiveten', 'blackholes.five-ten-sg.com.')
tflags __FIVETEN net
# bulk mailers that don't require confirmed opt-in from their customers,
# or that have have allowed known spammers to become clients.
header T_RCVD_IN_FIVETEN_BULK	rbleval:check_rbl_sub('fiveten', '127.0.0.4')
tflags T_RCVD_IN_FIVETEN_BULK net
# retest all of the rest (since check_rbl_sub wasn't used before)
header T_RCVD_IN_FIVETEN_SPAM	rbleval:check_rbl_sub('fiveten', '127.0.0.2')
tflags T_RCVD_IN_FIVETEN_SPAM net
header T_RCVD_IN_FIVETEN_DIALUP	rbleval:check_rbl('fiveten-notfirsthop', 'blackholes.five-ten-sg.com.', '127.0.0.3')
tflags T_RCVD_IN_FIVETEN_DIALUP net
header T_RCVD_IN_FIVETEN_MULTISTAGE	rbleval:check_rbl_sub('fiveten', '127.0.0.5')
tflags T_RCVD_IN_FIVETEN_MULTISTAGE net
header T_RCVD_IN_FIVETEN_SINGLESTAGE	rbleval:check_rbl_sub('fiveten', '127.0.0.6')
tflags T_RCVD_IN_FIVETEN_SINGLESTAGE net
header T_RCVD_IN_FIVETEN_SPAMSUPPORT	rbleval:check_rbl_sub('fiveten', '127.0.0.7')
tflags T_RCVD_IN_FIVETEN_SPAMSUPPORT net
header T_RCVD_IN_FIVETEN_WEBFORM	rbleval:check_rbl_sub('fiveten', '127.0.0.8')
tflags T_RCVD_IN_FIVETEN_WEBFORM net
header T_RCVD_IN_FIVETEN_MISC	rbleval:check_rbl_sub('fiveten', '127.0.0.9')
tflags T_RCVD_IN_FIVETEN_MISC net
header T_RCVD_IN_FIVETEN_KLEZ	rbleval:check_rbl_sub('fiveten', '127.0.0.10')
tflags T_RCVD_IN_FIVETEN_KLEZ net
header T_RCVD_IN_FIVETEN_TCPA	rbleval:check_rbl_sub('fiveten', '127.0.0.11')
tflags T_RCVD_IN_FIVETEN_TCPA net
header T_RCVD_IN_FIVETEN_FREE	rbleval:check_rbl_sub('fiveten', '127.0.0.12')
tflags T_RCVD_IN_FIVETEN_FREE net

# some additional osirusoft tests, needs more work
# all osirusoft tests maybe a bad idea, osirusoft web site seems defunct
header T_X_OSIRU_OPT_IN		rbleval:check_rbl_sub('osirusoft', '127.0.0.7')
header T_X_OSIRU_OPEN_PROXY	rbleval:check_rbl_sub('osirusoft', '127.0.0.9')
tflags T_X_OSIRU_OPT_IN net
tflags T_X_OSIRU_OPEN_PROXY net
# repeats?
header T_RCVD_IN_OSSRC	rbleval:check_rbl('ossrc', 'spamsources.relays.osirusoft.com.')
tflags T_RCVD_IN_OSSRC net

# SORBS
# transfers: both axfr and ixfr available
# url: http://www.dnsbl.sorbs.net/
# pay-to-use: no
# delist: $50 fee for T_RCVD_IN_SORBS_SPAM, others are retested on request (free)
header T_RCVD_IN_SORBS	rbleval:check_rbl('sorbs', 'dnsbl.sorbs.net.')
tflags T_RCVD_IN_SORBS net
header T_RCVD_IN_SORBS_HTTP	rbleval:check_rbl_sub('sorbs', '127.0.0.2')
tflags T_RCVD_IN_SORBS_HTTP net
header T_RCVD_IN_SORBS_MISC	rbleval:check_rbl_sub('sorbs', '127.0.0.3')
tflags T_RCVD_IN_SORBS_MISC net
header T_RCVD_IN_SORBS_SMTP	rbleval:check_rbl_sub('sorbs', '127.0.0.4')
tflags T_RCVD_IN_SORBS_SMTP net
header T_RCVD_IN_SORBS_SOCKS	rbleval:check_rbl_sub('sorbs', '127.0.0.5')
tflags T_RCVD_IN_SORBS_SOCKS net
header T_RCVD_IN_SORBS_SPAM	rbleval:check_rbl_sub('sorbs', '127.0.0.6')
tflags T_RCVD_IN_SORBS_SPAM net
header T_RCVD_IN_SORBS_WEB	rbleval:check_rbl_sub('sorbs', '127.0.0.7')
tflags T_RCVD_IN_SORBS_WEB net

# bug 1017: domain-based blacklists, experimental
# dsn.rfc-ignorant.org
header T_FROM_IN_RFCI_DSN	rbleval:check_rbl_from_host('rfci-dsn', 'dsn.rfc-ignorant.org.')
tflags T_FROM_IN_RFCI_DSN net

# OK, a whole batch of faked-HELO detection rules.  These work by checking
# for hosts HELOing in a certain domain, but without rDNS matching that.
# these are the most frequently-impersonated headers in my recent corpora...
#
# NOTE: these cannot simply be inverted for a "nice" rule; to do this would
# require checking only the last untrusted line, rather than all of them.
#
header T_FAKE_HELO_YAHOO	eval:check_for_rdns_helo_mismatch("yahoo\.com","yahoo\.com")
header T_FAKE_HELO_NETSCAPE	eval:check_for_rdns_helo_mismatch("netscape\.net","netscape\.net")
header T_FAKE_HELO_YAHOO_CO_UK	eval:check_for_rdns_helo_mismatch("yahoo\.co\.uk","yahoo\.co\.uk")
header T_FAKE_HELO_NETSCAPE_COM	eval:check_for_rdns_helo_mismatch("(?:netscape|netcenter|aol)\.(?:com|net)","netscape\.com")

# 2003-05-03, bugs 1769, 1844: single replacement rule for OBFUSCATING_COMMENT*
rawbody __OBFUSCATING_COMMENT_A	/\w<![^>]*>\w/
rawbody __OBFUSCATING_COMMENT_B	/[^\s>]<![^>]*>[^\s<]/
#
meta T_OBFUSCATING_COMMENT_00	((__OBFUSCATING_COMMENT_A && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_B && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_01	((__OBFUSCATING_COMMENT_A && __MIME_HTML) || (__OBFUSCATING_COMMENT_B && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_02	((__OBFUSCATING_COMMENT_A && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_03	((__OBFUSCATING_COMMENT_A && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_04	((__OBFUSCATING_COMMENT_A && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_B && MIME_HTML_ONLY))
#
meta T_OBFUSCATING_COMMENT_05	((__OBFUSCATING_COMMENT_A && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_B && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_06	((__OBFUSCATING_COMMENT_A && __MIME_HTML) || (__OBFUSCATING_COMMENT_B && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_07	((__OBFUSCATING_COMMENT_A && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_08	((__OBFUSCATING_COMMENT_A && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_09	((__OBFUSCATING_COMMENT_A && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_B && __MIME_HTML_ONLY))
#
meta T_OBFUSCATING_COMMENT_10	((__OBFUSCATING_COMMENT_A && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_B && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_11	((__OBFUSCATING_COMMENT_A && __MIME_HTML) || (__OBFUSCATING_COMMENT_B && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_12	((__OBFUSCATING_COMMENT_A && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_13	((__OBFUSCATING_COMMENT_A && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_14	((__OBFUSCATING_COMMENT_A && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_B && __MIME_HTML))
#
meta T_OBFUSCATING_COMMENT_15	((__OBFUSCATING_COMMENT_A && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_B && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_16	((__OBFUSCATING_COMMENT_A && __MIME_HTML) || (__OBFUSCATING_COMMENT_B && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_17	((__OBFUSCATING_COMMENT_A && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_18	((__OBFUSCATING_COMMENT_A && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_19	((__OBFUSCATING_COMMENT_A && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_B && HTML_MESSAGE))
#
meta T_OBFUSCATING_COMMENT_20	((__OBFUSCATING_COMMENT_A && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_B && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_21	((__OBFUSCATING_COMMENT_A && __MIME_HTML) || (__OBFUSCATING_COMMENT_B && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_22	((__OBFUSCATING_COMMENT_A && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_23	((__OBFUSCATING_COMMENT_A && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_B && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_24	((__OBFUSCATING_COMMENT_A && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_B && (HTML_MESSAGE || __MIME_HTML_ONLY)))
#
# spin of the above based on ajs version of rule in bug 1844
#
# 2003-05-03, bugs 1769, 1844: single replacement rule for OBFUSCATING_COMMENT*
rawbody __OBFUSCATING_COMMENT_C	/\w(?:<![^>]*>)+\w/
rawbody __OBFUSCATING_COMMENT_D	/[^\s>](?:<![^>]*>)+[^\s<]/
#
meta T_OBFUSCATING_COMMENT_00B	((__OBFUSCATING_COMMENT_C && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_D && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_01B	((__OBFUSCATING_COMMENT_C && __MIME_HTML) || (__OBFUSCATING_COMMENT_D && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_02B	((__OBFUSCATING_COMMENT_C && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_03B	((__OBFUSCATING_COMMENT_C && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_04B	((__OBFUSCATING_COMMENT_C && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_D && MIME_HTML_ONLY))
#
meta T_OBFUSCATING_COMMENT_05B	((__OBFUSCATING_COMMENT_C && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_D && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_06B	((__OBFUSCATING_COMMENT_C && __MIME_HTML) || (__OBFUSCATING_COMMENT_D && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_07B	((__OBFUSCATING_COMMENT_C && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_08B	((__OBFUSCATING_COMMENT_C && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && __MIME_HTML_ONLY))
meta T_OBFUSCATING_COMMENT_09B	((__OBFUSCATING_COMMENT_C && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_D && __MIME_HTML_ONLY))
#
meta T_OBFUSCATING_COMMENT_10B	((__OBFUSCATING_COMMENT_C && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_D && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_11B	((__OBFUSCATING_COMMENT_C && __MIME_HTML) || (__OBFUSCATING_COMMENT_D && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_12B	((__OBFUSCATING_COMMENT_C && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_13B	((__OBFUSCATING_COMMENT_C && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && __MIME_HTML))
meta T_OBFUSCATING_COMMENT_14B	((__OBFUSCATING_COMMENT_C && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_D && __MIME_HTML))
#
meta T_OBFUSCATING_COMMENT_15B	((__OBFUSCATING_COMMENT_C && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_D && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_16B	((__OBFUSCATING_COMMENT_C && __MIME_HTML) || (__OBFUSCATING_COMMENT_D && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_17B	((__OBFUSCATING_COMMENT_C && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_18B	((__OBFUSCATING_COMMENT_C && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && HTML_MESSAGE))
meta T_OBFUSCATING_COMMENT_19B	((__OBFUSCATING_COMMENT_C && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_D && HTML_MESSAGE))
#
meta T_OBFUSCATING_COMMENT_20B	((__OBFUSCATING_COMMENT_C && HTML_MESSAGE) || (__OBFUSCATING_COMMENT_D && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_21B	((__OBFUSCATING_COMMENT_C && __MIME_HTML) || (__OBFUSCATING_COMMENT_D && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_22B	((__OBFUSCATING_COMMENT_C && MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_23B	((__OBFUSCATING_COMMENT_C && __MIME_HTML_ONLY) || (__OBFUSCATING_COMMENT_D && (HTML_MESSAGE || __MIME_HTML_ONLY)))
meta T_OBFUSCATING_COMMENT_24B	((__OBFUSCATING_COMMENT_C && (HTML_MESSAGE || __MIME_HTML_ONLY)) || (__OBFUSCATING_COMMENT_D && (HTML_MESSAGE || __MIME_HTML_ONLY)))

# more for bug 1769
header T_GAPPY_SUBJECT_01	Subject =~ /\b(?:[a-z][\W]{1,3}){4,}/i
header T_GAPPY_SUBJECT_02	Subject =~ /\b(?:[a-z][\W]{1,3}){5,}/i
header T_GAPPY_SUBJECT_03	Subject =~ /\b(?:[a-z][\W]{1,4}){4,}/i
header T_GAPPY_SUBJECT_04	Subject =~ /\b(?:[a-z][\W]{1,4}){5,}/i
header T_GAPPY_SUBJECT_05	Subject =~ /\b(?:[a-z][\W]{1,5}){4,}/i
header T_GAPPY_SUBJECT_06	Subject =~ /\b(?:[a-z][\W]{1,5}){5,}/i
header T_GAPPY_SUBJECT_07	Subject =~ /\b(?:[a-z][\W]{1,6}){4,}/i
header T_GAPPY_SUBJECT_08	Subject =~ /\b(?:[a-z][\W]{1,6}){5,}/i
header T_GAPPY_SUBJECT_09	Subject =~ /\b(?:[a-z][\W]{1,3}){3,}/i
header T_GAPPY_SUBJECT_10	Subject =~ /\b(?:[a-z][\W]{1,4}){3,}/i
header T_GAPPY_SUBJECT_11	Subject =~ /\b(?:[a-z][\W]{1,5}){3,}/i
header T_GAPPY_SUBJECT_12	Subject =~ /\b(?:[a-z][\W]{1,6}){3,}/i
# anything not a number or letter in Latin 1
header T_GAPPY_SUBJECT_01B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,3}){4,}/i
header T_GAPPY_SUBJECT_02B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,3}){5,}/i
header T_GAPPY_SUBJECT_03B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,4}){4,}/i
header T_GAPPY_SUBJECT_04B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,4}){5,}/i
header T_GAPPY_SUBJECT_05B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,5}){4,}/i
header T_GAPPY_SUBJECT_06B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,5}){5,}/i
header T_GAPPY_SUBJECT_07B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,6}){4,}/i
header T_GAPPY_SUBJECT_08B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,6}){5,}/i
header T_GAPPY_SUBJECT_09B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,3}){3,}/i
header T_GAPPY_SUBJECT_10B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,4}){3,}/i
header T_GAPPY_SUBJECT_11B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,5}){3,}/i
header T_GAPPY_SUBJECT_12B	Subject =~ /\b(?:[a-z][^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,6}){3,}/i
# same except looking for \w as text
header T_GAPPY_SUBJECT_01C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,3}){4,}/i
header T_GAPPY_SUBJECT_02C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,3}){5,}/i
header T_GAPPY_SUBJECT_03C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,4}){4,}/i
header T_GAPPY_SUBJECT_04C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,4}){5,}/i
header T_GAPPY_SUBJECT_05C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,5}){4,}/i
header T_GAPPY_SUBJECT_06C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,5}){5,}/i
header T_GAPPY_SUBJECT_07C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,6}){4,}/i
header T_GAPPY_SUBJECT_08C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,6}){5,}/i
header T_GAPPY_SUBJECT_09C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,3}){3,}/i
header T_GAPPY_SUBJECT_10C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,4}){3,}/i
header T_GAPPY_SUBJECT_11C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,5}){3,}/i
header T_GAPPY_SUBJECT_12C	Subject =~ /\b(?:\w[^0-9A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]{1,6}){3,}/i

# http://marc.theaimsgroup.com/?l=spamassassin-talk&m=105203882531351&w=2
header T_RATWARE_X_SCANNER	X-Scanner =~ /^: /

header __RATWARE_EXISCAN	X-Scanner =~ /exiscan/
header __RATWARE_ANTIABUSE	X-AntiAbuse =~ /Originator.Caller UID.GID - \[\d \d\] \/ \[\d \d\]/
meta T_RATWARE_EXISCAN_FORGERY	(__RATWARE_EXISCAN && __RATWARE_ANTIABUSE && __HAS_MSMAIL_PRI)

# also, References headers have a format
header T_RATWARE_BAD_REFS	References =~ /^[^<]\S+\$\S+\@\S+[^>]$/

# Gecko ver is 8 digits: "Gecko/20011019"
header T_RATWARE_BAD_GECKO	User-Agent =~ /Gecko\/(?:\d{1,7}|\d{9,})(?:\s|$)/

# hmm, interesting.   Ensure the MUA is using consistent priorities.
# http://www3.cds.ne.jp/~marimo/oka/research/em/data0002.html
header __X_PRI_HI		X-Priority =~ /^[12]/
header __X_PRI_MD		X-Priority =~ /^3/
header __X_PRI_LO		X-Priority =~ /^[456789]/
header __X_MSPRI_HI		X-Msmail-Priority =~ /^High/
header __X_MSPRI_MD		X-Msmail-Priority =~ /^Normal/
header __X_MSPRI_LO		X-Msmail-Priority =~ /^Low/
meta T_X_PRI_MISMATCH_HI	(__X_PRI_HI && __HAS_MSMAIL_PRI && !__X_MSPRI_HI)
meta T_X_PRI_MISMATCH_MD	(__X_PRI_MD && __HAS_MSMAIL_PRI && !__X_MSPRI_MD)
meta T_X_PRI_MISMATCH_LO	(__X_PRI_LO && __HAS_MSMAIL_PRI && !__X_MSPRI_LO)

# bug 1757
body T_HELLO_ADDRESS		/(?:Hi|Hello|Dear)[, ]?.{0,30}@\S/i
describe T_HELLO_ADDRESS	Greets you by address, not by name

# bug 1756
body T_GENERIC_VIAGRA		/Generic Viagra/
describe T_GENERIC_VIAGRA	Mentions Generic Viagra

# bug 1801
uri T_IP_LINK_PLUS	/^https?\:\/\/(?:\S*\@)?\d+\.\d+\.\d+\.\d+.{0,20}(?:cgi|click|ads|id\=)/i
describe T_IP_LINK_PLUS		Dotted-decimal IP address followed by GCI, clickthru, etc.

# try various redirects to see what works best
uri T_YAHOO_REDIR_1		/^https?\:\/\/rd\.yahoo\.com\/[0-9]{4,}/i
describe T_YAHOO_REDIR_1	Yahoo Redirect

uri T_YAHOO_REDIR_2		/^https?\:\/\/rd\.yahoo\.com\/DailyNews\b/i
describe T_YAHOO_REDIR_2	Yahoo Redirect

uri T_YAHOO_REDIR_3		/^https?\:\/\/rd\.yahoo\.com\/dir\b/i
describe T_YAHOO_REDIR_3	Yahoo Redirect

uri T_YAHOO_REDIR_4		/^https?\:\/\/rd\.yahoo\.com\/welcome\b/i
describe T_YAHOO_REDIR_4	Yahoo Redirect

uri T_YAHOO_REDIR_5		/^https?\:\/\/rd\.yahoo\.com\/partner\b/i
describe T_YAHOO_REDIR_5	Yahoo Redirect

# alternate version found in 70_cvs_rules_under_test.cf
uri T_YAHOO_REDIRECTOR		/^http:\/\/rd\.yahoo\.com/i
describe T_YAHOO_REDIRECTOR	Uses commonly-spammed redirector URL

uri T_ASIAN_LINKS			/(?:^https?\:\/\/|^mailto\:).{0,20}\.(?:kr|jp)\//i
describe T_ASIAN_LINKS		Links to Korea, Japan, etc.

uri T_BIZ_LINKS			/(?:^https?\:\/\/|^mailto\:).{0,20}\.bi?z/i
describe T_BIZ_LINKS		Links to .biz .bz

uri T_MORTGAGE_LINKS		/(?:^https?\:\/\/|^mailto\:).{0,20}(?:low|about)mortgage/i
describe T_MORTGAGE_LINKS		Links to discount mortgage spammers

uri T_STRANGE_CHAR_LINKS		/^https?\:\/\/.{0,20}(?:[%@]|=2E)/i
describe T_STRANGE_CHAR_LINKS	Links with strange characters

uri T_SEX_BANNED_LINKS	/(?:^https?\:\/\/|^mailto\:).{0,15}(?:hugefist|enlargepills|yourpenis|freakyfarm|latex-teens|animalobsession|bukkakehouse)/i
describe T_SEX_BANNED_LINKS	Links to Sex Sites

uri T_SEX_PHRASE_LINKS	/(?:^https?\:\/\/|^mailto\:).{0,20}(?:bimbos|farmsex|porn.*mail|girls4u|cumslut)/i
describe T_SEX_PHRASE_LINKS	Links with Sex Phrases

uri T_PHRASE_COMBO_LINKS	/(?:^https?\:\/\/|^mailto\:).(?:free|hot|cash|money|click|track|gold|platinum|bargain|prize|save).{0,15}(?:click|track|cash|money|offer|deal|card|quotes|promo)/i
describe T_PHRASE_COMBO_LINKS	Links containing suspicious phrase combinations 

uri T_SUSPICIOUS_LINKS	/(?:^https?\:\/\/|^mailto\:).{0,25}(?:poker\.net|get-deal|bargain[zs\-]|clicks|spree|members\=|lotto|offer[sz]|4you)/i
describe T_SUSPICIOUS_LINKS	Links containing suspicious phrases

uri T_BANNED_LINKS1	/(?:^https?\:\/\/|^mailto\:).{0,20}(?:needanewjob|valodata|jutan|bridgewater|youngblue|rocketfibre|shopnow|affistats|priceisright|compare-lender)/i
describe T_BANNED_LINKS1		Links to Banned Companies 1

uri T_BANNED_LINKS2	/(?:^https?\:\/\/|^mailto\:).{0,20}(?:ientry|mybill|dyfyi|farmsex|affinitycommerce|unsecured-credit|e-centives|fyi01|clicktrack|emailads|zizi|vistaprint)/i
describe T_BANNED_LINKS2		Links to Banned Companies 2

uri T_BANNED_LINKS3	/(?:^https?\:\/\/|^mailto\:).{0,20}(?:radarline|optilc|biosweep|dealnetwork|myobmail|yourvling|xeemo|incestuals|mnjmtech|escript|m0rtage)/i
describe T_BANNED_LINKS3		Links to Banned Companies 3

uri T_BANNED_LINKS4	/(?:^https?\:\/\/|^mailto\:).{0,20}(?:ltracker|premiumsmail|rxmedical|bannedcd|raveonmail|postdirect|5moni|gammae|freeht|ns-hosting|domainsforeveryone)/i
describe T_BANNED_LINKS4		Links to Banned Companies 4

uri T_BANNED_LINKS5	/(?:^https?\:\/\/|^mailto\:).{0,20}(?:freedigitalppv|fastbustzone|dailycomnet|zoanmail|ew01|executive-level|cyberforce|adserver|flipside.com|faqchat)/i
describe T_BANNED_LINKS5		Links to Banned Companies 5

uri T_BANNED_LINKS6	/(?:^https?\:\/\/|^mailto\:).{0,20}(?:dforyi|totemmail|addsaturation)/i
describe T_BANNED_LINKS6		Links to Banned Companies 6

rawbody T_HREF_3D			/(?:href|src)=3D\"/i
describe T_HREF_3D		Uses href=3D Trick

# bug 1803
body T_GAPPY_PORN_01                       /\b(?:s\We\Wx|p\Wo\Wr\Wn|x\Wx\Wx|f\Wu\Wc\Wk|p\Wa\Wr\Wt\Wy|t\We\We\Wn|f\Wu\Wn|h\Wo\Wt)/i
describe T_GAPPY_PORN_01           G.a.p.p.y - P.o.r.n

body T_GAPPY_PORN_02                       /\b(?:s\.e\.x|p\.o\.r\.n|x\.x\.x|f\.u\.c\.k|p\.a\.r\.t\.y|t\.e\.e\.n|f\.u\.n|h\.o\.t)/i
describe T_GAPPY_PORN_02           G.a.p.p.y - P.o.r.n

# bug 1743
header T_WS_PHRASE                To =~ /\s*\"\s\"\s/
describe T_WS_PHRASE              Phrase part of address is a space

# bug 1876
body 		T_GREATGIFT		/Makes a great.{1,20}gift/i
describe	T_GREATGIFT		This spam makes a great gift!

body 		T_WEHAVEASOLUTION		/We have a solution/i
describe	T_WEHAVEASOLUTION		Claims to have a solution

body		T_WSDOMAIN		/YourDomain\.ws/i
describe	T_WSDOMAIN		Selling ".ws" domains

rawbody		T_PUSHHERELINK		/<a[^>]*>[^<]*((push|go)\s(here|this) |cease.{1,10}mail)[^<]*<\/a>/i
describe	T_PUSHHERELINK		Link asks you to "push here" or "go here" or "cease mail" or the like

rawbody		T_MULTIPLEIMAGES		/<a[^>]*>[^<]*<img[^>]*>[^>]*<\/a>.*<a [^>]*>[^<]*<img[^>]*>[^>]*<\/a>.*<a[^>]*>[^<]*<img[^>]*>[^>]*<\/a>/si
describe	T_MULTIPLEIMAGES		Contains 3 or more hyperlinked images

uri 		T_OFFER888 		/Offer888/i
uri 		T_PERMISSIONPASS 		/PermissionPass/i
uri 		T_EQUALAMAIL 		/EqualaMAIL/i
uri 		T_DOLLARMACHINE 		/dollar.?machine/i
uri 		T_HITBOX 			/hitbox\.com/i

# trying to modify the razor range rules ... - tvd
body	T_RAZOR2_CF_RANGE_11_50	eval:check_razor2_range('11','50')
body	T_RAZOR2_CF_RANGE_51_100	eval:check_razor2_range('51','100')
body	T_RAZOR2_CF_RANGE_01_25	eval:check_razor2_range('01','25')
body	T_RAZOR2_CF_RANGE_26_50	eval:check_razor2_range('26','50')
body	T_RAZOR2_CF_RANGE_51_75	eval:check_razor2_range('51','75')
body	T_RAZOR2_CF_RANGE_76_100	eval:check_razor2_range('76','100')
tflags T_RAZOR2_CF_RANGE_11_50 net
tflags T_RAZOR2_CF_RANGE_51_100 net
tflags T_RAZOR2_CF_RANGE_01_25 net
tflags T_RAZOR2_CF_RANGE_26_50 net
tflags T_RAZOR2_CF_RANGE_51_75 net
tflags T_RAZOR2_CF_RANGE_76_100 net
