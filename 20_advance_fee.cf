# SpamAssassin rules file: advance fee fraud rules (Nigerian 419 scams)
#
# Please don't modify this file as your changes will be overwritten with
# the next update. Use @@LOCAL_RULES_DIR@@/local.cf instead.
# See 'perldoc Mail::SpamAssassin::Conf' for details.
#
# <@LICENSE>
# Copyright 2004 Apache Software Foundation
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# </@LICENSE>
#
###########################################################################

require_version @@VERSION@@

header NIGERIAN_SUBJECT1	Subject =~ /^(?:Re:|\[.{1,10}\])?\s*(?:(?:very )?URGENT|ATTENTION)\s*$/i
describe NIGERIAN_SUBJECT1	Subject is indicative of a Nigerian spam
header NIGERIAN_SUBJECT2	Subject =~ /^(?:Re:|\[.{1,10}\])?\s*(?:very )?urgent\s+(?:(?:and|&)\s+)?(?:confidential|assistance|business|attention|reply|response|help)\b/i
describe NIGERIAN_SUBJECT2	Subject is indicative of a Nigerian spam

###########################################################################

# tvd - I really wish there was a better way to do this, but ...
# perhaps make a quick eval that counts how many matches, then we use
# the cached result in tests?

meta NIGERIAN_BODY1	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_15 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_38 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 ) > 1
describe NIGERIAN_BODY1	Message body looks like a Nigerian spam message 1+

meta NIGERIAN_BODY2	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_15 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_38 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 ) > 2
describe NIGERIAN_BODY2	Message body looks like a Nigerian spam message 2+

meta NIGERIAN_BODY3	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_15 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_38 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 ) > 3
describe NIGERIAN_BODY3	Message body looks like a Nigerian spam message 3+

meta NIGERIAN_BODY4	( __NIGERIAN_BODY_1 + __NIGERIAN_BODY_2 + __NIGERIAN_BODY_3 + __NIGERIAN_BODY_5 + __NIGERIAN_BODY_6 + __NIGERIAN_BODY_7 + __NIGERIAN_BODY_8 + __NIGERIAN_BODY_9 + __NIGERIAN_BODY_10 + __NIGERIAN_BODY_11 + __NIGERIAN_BODY_12 + __NIGERIAN_BODY_13 + __NIGERIAN_BODY_14 + __NIGERIAN_BODY_15 + __NIGERIAN_BODY_16 + __NIGERIAN_BODY_17 + __NIGERIAN_BODY_18 + __NIGERIAN_BODY_19 + __NIGERIAN_BODY_20 + __NIGERIAN_BODY_21 + __NIGERIAN_BODY_22 + __NIGERIAN_BODY_25 + __NIGERIAN_BODY_26 + __NIGERIAN_BODY_27 + __NIGERIAN_BODY_28 + __NIGERIAN_BODY_29 + __NIGERIAN_BODY_30 + __NIGERIAN_BODY_31 + __NIGERIAN_BODY_32 + __NIGERIAN_BODY_33 + __NIGERIAN_BODY_34 + __NIGERIAN_BODY_35 + __NIGERIAN_BODY_36 + __NIGERIAN_BODY_37 + __NIGERIAN_BODY_38 + __NIGERIAN_BODY_39 + __NIGERIAN_BODY_40 + __NIGERIAN_BODY_41 + __NIGERIAN_BODY_42 + __NIGERIAN_BODY_43 + __NIGERIAN_BODY_44 + __NIGERIAN_BODY_45 + __NIGERIAN_BODY_46 ) > 4
describe NIGERIAN_BODY4	Message body looks like a Nigerian spam message 4+

body __NIGERIAN_BODY_1		/\b(?:financial|confiden(?:tial|ce)|safe|mutual|secret|success|risk-?free|details|business).{1,30}\btransaction\b/i
body __NIGERIAN_BODY_2		/\btransaction\b.{1,30}\b(?:magnitude|diplomatic|strict|absolute|secret|confiden(?:tial|ce)|guarantee)/i
body __NIGERIAN_BODY_3		/BASED ON INFORMATION GATHERED ABOUT YOU, WE BELIEVE\s*YOU WOULD BE IN A POSITION TO HELP US IN TRANSFER/i
body __NIGERIAN_BODY_5		/\bpoisoned (?:to death )?by his business associate/i
body __NIGERIAN_BODY_6		/\bIt is with trust and confidentiality\b/i
body __NIGERIAN_BODY_7		/\bU\.?S\.?(?:D\.?)?\s*(?:\$\s*)?(?:\d+,\d+,\d+|\d+\.\d+\.\d+|\d+(?:\.\d+)?\s*milli?on)/i
body __NIGERIAN_BODY_8		/\b(?:You may be sur?prised to receive this letter from me|this (?:letter|mail) (?:(?:may|will) come to you as|will be) a sur?prise)\b/i
body __NIGERIAN_BODY_9		/\bthe .{1,10} son of\b/i
body __NIGERIAN_BODY_10		/\burgent and(?: very)? (?:profitable|confidential) business (?:proposal|proposition)\b/i
body __NIGERIAN_BODY_11		/\bassistance to relocate\b/i
body __NIGERIAN_BODY_12		/\bto which will be transferred the sum\b/i
body __NIGERIAN_BODY_13		/\byour(?: private)? (?:tele)?phone (?:and|&) fax Numbers?\b/i
body __NIGERIAN_BODY_14		/\bthe importance of Secrecy\b/i
body __NIGERIAN_BODY_15		/\bmodalities\b/i
body __NIGERIAN_BODY_16		/\bI am a Private Investigator\b/i
body __NIGERIAN_BODY_17		/\bWRITING THIS LETTER TO SOLICIT\b/i
body __NIGERIAN_BODY_18		/\bSEVERAL ATTEMPTS HAVE BEEN MADE WITH OUT SUCCESS\b/i
body __NIGERIAN_BODY_19		/\bMY PROPOSAL IS ACCEPTABLE\b/i
body __NIGERIAN_BODY_20		/\d+%.{0,15}\)? (?:of (?:the total|this|the) (?:amount|sum|money)|for you|for my investment|for (?:us|me)|.{0,15}\bfor your expenses)\b/i
body __NIGERIAN_BODY_21		/\bforeign account\b/i
body __NIGERIAN_BODY_22		/\btrust (?:and|&) confidentiality\b/i
body __NIGERIAN_BODY_25		/\bvery beneficial to both of us\b/i
body __NIGERIAN_BODY_26		/\bmilli?on (?:.{1,25} thousand\s*)?(?:(?:united states|u\.?s\.?) dollars|(?i:U\.?S\.?D?))\b/i
body __NIGERIAN_BODY_27		/\bcorrespondent branch\b/i
body __NIGERIAN_BODY_28		/\btransaction is .{1,15} risk free.\b/i
body __NIGERIAN_BODY_29		/\b(?:percentage|rate) of this money\b/i
body __NIGERIAN_BODY_30		/\bfavou?rable response\b/i
body __NIGERIAN_BODY_31		/\btotal acceptance and commitment\b/i
body __NIGERIAN_BODY_32		/\blocate(?: .{1,20})? extended relative/i
body __NIGERIAN_BODY_33		/\bhonest cooperation\b/i
body __NIGERIAN_BODY_34		/\b(?:wife|son|brother|daughter) of the late\b/i
body __NIGERIAN_BODY_35		/\bintuitive confidence/i
body __NIGERIAN_BODY_36		/\battached to ticket number\b/i
body __NIGERIAN_BODY_37		/\ball funds will be returned\b/i
body __NIGERIAN_BODY_38		/\b(?:International\b.{1,15}\bLottery|lottery\b.{1,15}\binternational)\b/i
body __NIGERIAN_BODY_39		/\bYOUR FULL NAMES?,?(?:and|&)? FULL CONTACT ADDRESS\b/i
body __NIGERIAN_BODY_40		/\bsend .{1,30}\byour telefax Numbers?\b/i
body __NIGERIAN_BODY_41		/(?:government|bank) of nigeria/i
body __NIGERIAN_BODY_42		/nigerian? (?:national|government)/i
body __NIGERIAN_BODY_43         /\blate .{0,15}(?:father|wife|husband|general|president|daughter|son|minister).{0,20}(?:wealthy|treasure|deposit|money|left|property|known|\$|US)/i
body __NIGERIAN_BODY_44         /\b(?:of|the) late president\b/i
body __NIGERIAN_BODY_45         /\bsum of ?(?:million|US|\$)|\b(?:deposit|left|huge|discovered|abandoned).{0,15} sum of/i
body __NIGERIAN_BODY_46         /\bgive\s+you .{0,15}(?:fund|money|total|sum|contact|percent)\b/i

###########################################################################

# Feb 18 2003 jm: try another combo.  I'm not sure __NIGERIAN_HONESTY is req'd.
body __NIGERIAN_CODE_CONDUCT	/\bcode of conduct\b/i
body __NIGERIAN_CIV_SERVICE	/\bcivil service\b/i
body __NIGERIAN_TOP_SECRET	/\btop secret\b/i
body __NIGERIAN_STRICT_CONF	/\b(?:strictest confidence|utmost secrecy)\b/i
body __NIGERIAN_HONESTY		/\btransparent honesty\b/i
body __NIGERIAN_DISBURSE	/\bdisburs/i
meta NIGERIAN_BODY_GOVT_3	((__NIGERIAN_CODE_CONDUCT + __NIGERIAN_CIV_SERVICE + __NIGERIAN_HONESTY + __NIGERIAN_TOP_SECRET + __NIGERIAN_STRICT_CONF + __NIGERIAN_DISBURSE) >= 3)
describe NIGERIAN_BODY_GOVT_3	Message body has many indications of Nigerian scam

###########################################################################

# Updated test rules for fraud, uses existing rules and updated rules
body __T_FRAUD_92	/youre? country/i
body __T_FRAUD_110	/the total sum/i
body __T_FRAUD_2	/\bass?ylum\b/i
body __T_FRAUD_102	/foreign (?:offshore )?(?:bank|account)/i
body __T_FRAUD_144	/\bnext of kin\b/i
body __T_FRAUD_235	/(?:international|luckyday|overseas stake|promo|world) lott(?:o|ery)/i
body __T_FRAUD_258	/computer ballot system/i
body __T_FRAUD_113	/win cash/i
body __T_FRAUD_44	/(?:may i first|to) introduce my ?self/i
body __T_FRAUD_81	/as the beneficiary/i
body __T_FRAUD_58	/\bcongo\b/i
body __T_FRAUD_259	/drawn	?from.{0,10}\d{2,3},?\d{3}/i
body __T_FRAUD_149	/as a minister/i
body __T_FRAUD_236	/lott(?:o|ery) (?:co,?ordinator|international)/i
body __T_FRAUD_249	/bequest/i
body __T_FRAUD_125	/(?:white|black|zimbabwean) farmers?/i
body __T_FRAUD_252	/modalit(?:y|ies)/i
body __T_FRAUD_132	/(?:who was a|as a|an? honest|you being a|to any) foreigner/i
body __T_FRAUD_227	/(?:negotiate|reasonable|acc?or?ding|certain|agg?ree).{1,20}percentage/i
body __T_FRAUD_100	/(?:claim|concerning) (?:the|this) money/i
body __T_FRAUD_26	/charity organization/i
body __T_FRAUD_88	/remains unclaimed/i
body __T_FRAUD_16	/land dispute/i
body __T_FRAUD_240	/award notification/i
body __T_FRAUD_157	/god gives .{1,10}second chance/i
body __T_FRAUD_46	/i am contacting you/i
body __T_FRAUD_133	/foreign (?:business partner|customer)/i
body __T_FRAUD_228	/percentage.{1,10}(?:indicat|previous|involved)/i
body __T_FRAUD_120	/letter of authority/i
body __T_FRAUD_114	/you are.{0,8}winner/i
body __T_FRAUD_142	/my late (?:husband|wife|brother|uncle|aunt|father|mother) (?:is|[hw]a[ds])\b/i
body __T_FRAUD_94	/(?:huge|substantial) amount of m[o0]ney/i
body __T_FRAUD_146	/the (?:wife|heir) (?:to|of)\b/i
body __T_FRAUD_96	/(?:will share the money|your share.{1,10}(?:shall|sum|total|money|funds))/i
body __T_FRAUD_41	/prize award dept/i
body __T_FRAUD_216	/reliable person/i
body __T_FRAUD_137	/fiduciary agent/i
body __T_FRAUD_82	/compliments? of the season/i
body __T_FRAUD_251	/magnanimity/i
body __T_FRAUD_19	/political crisis/i
body __T_FRAUD_254	/\bnumbered time\b/i
body __T_FRAUD_241	/urgent and(?: very)? (?:profitable|confidential) business propos(?:al|ition)/i
body __T_FRAUD_35	/international court of justice/i
body __T_FRAUD_217	/secrecy and confidentiality/i
body __T_FRAUD_221	/(?:the importance of|utmost) secrecy/i
body __T_FRAUD_124	/vital documents/i
body __T_FRAUD_18	/over-invoice/i
body __T_FRAUD_42	/(?:finance|holding|securit(?:ies|y)) (?:company|firm|storage house)/i
body __T_FRAUD_31	/embassy/i
body __T_FRAUD_115	/your share shall be\b/i
body __T_FRAUD_3	/assassinate/i
body __T_FRAUD_220	/\bto assure you\b/i
